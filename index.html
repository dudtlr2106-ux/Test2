<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>íˆ¬ì ê´€ë¦¬ ì‹œìŠ¤í…œ Complete</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #2563eb;
            --success: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --purple: #8b5cf6;
            --dark: #1f2937;
            --gray: #6b7280;
            --light: #f3f4f6;
            --border: #e5e7eb;
            --white: #ffffff;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 15px;
            color: var(--dark);
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
        }

        /* í—¤ë” */
        header {
            background: white;
            padding: 25px 30px;
            border-radius: 15px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }

        h1 {
            color: var(--dark);
            font-size: 28px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .subtitle {
            font-size: 13px;
            color: var(--gray);
            margin-top: 5px;
        }

        .header-actions {
            display: flex;
            gap: 10px;
        }

        .btn-icon {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            border: none;
            background: var(--light);
            font-size: 20px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-icon:hover {
            background: var(--primary);
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(37, 99, 235, 0.4);
        }

        .nav-tabs {
            display: flex;
            gap: 8px;
            overflow-x: auto;
            padding-bottom: 5px;
        }

        .nav-tab {
            padding: 12px 20px;
            background: var(--light);
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            color: var(--dark);
            transition: all 0.3s;
            white-space: nowrap;
            font-size: 14px;
        }

        .nav-tab.active {
            background: var(--primary);
            color: white;
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
        }

        .nav-tab:hover:not(.active) {
            background: #e5e7eb;
        }

        /* ì„¹ì…˜ */
        .section {
            display: none;
        }

        .section.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* ì¹´ë“œ */
        .card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        .card h2 {
            color: var(--dark);
            font-size: 20px;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--light);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* ê·¸ë¦¬ë“œ */
        .grid {
            display: grid;
            gap: 20px;
        }

        .grid-2 { grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); }
        .grid-3 { grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); }
        .grid-4 { grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); }

        /* í†µê³„ ì¹´ë“œ */
        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .stat-label {
            font-size: 14px;
            opacity: 0.9;
            margin-bottom: 8px;
        }

        .stat-value {
            font-size: 32px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-change {
            font-size: 14px;
            opacity: 0.95;
        }

        /* ì°¨íŠ¸ */
        .chart-container {
            position: relative;
            height: 300px;
            margin-top: 20px;
        }

        /* ì•„ì´í…œ ì¹´ë“œ */
        .item-card {
            background: var(--light);
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 15px;
            transition: all 0.3s;
        }

        .item-card:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            transform: translateY(-2px);
        }

        .item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .item-title {
            font-size: 18px;
            font-weight: bold;
            color: var(--dark);
        }

        .item-meta {
            display: flex;
            gap: 15px;
            margin: 10px 0;
            font-size: 14px;
            color: var(--gray);
            flex-wrap: wrap;
        }

        .item-content {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-top: 12px;
            line-height: 1.6;
            color: #4b5563;
        }

        /* í¼ */
        .form-group {
            margin-bottom: 20px;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }

        label {
            display: block;
            font-weight: 600;
            color: var(--dark);
            margin-bottom: 8px;
            font-size: 14px;
        }

        input, select, textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--border);
            border-radius: 8px;
            font-family: inherit;
            font-size: 14px;
            transition: all 0.3s;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        textarea {
            resize: vertical;
            min-height: 100px;
        }

        /* ë²„íŠ¼ */
        button {
            padding: 12px 24px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }

        button:hover {
            background: #1d4ed8;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(37, 99, 235, 0.3);
        }

        .btn-secondary { background: var(--gray); }
        .btn-success { background: var(--success); }
        .btn-danger { background: var(--danger); }
        .btn-warning { background: var(--warning); }
        .btn-sm { padding: 8px 16px; font-size: 13px; }

        /* ë°°ì§€ */
        .badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .badge-high { background: #fee2e2; color: var(--danger); }
        .badge-medium { background: #fef3c7; color: var(--warning); }
        .badge-low { background: #dbeafe; color: var(--primary); }
        .badge-success { background: #d1fae5; color: var(--success); }

        /* ì§„í–‰ë¥  */
        .progress {
            width: 100%;
            height: 12px;
            background: var(--light);
            border-radius: 20px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--success), var(--primary));
            transition: width 0.5s ease;
        }

        /* ìŠ¤ì½”ì–´ */
        .score-item {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 12px;
        }

        .score-label {
            min-width: 100px;
            font-size: 14px;
            color: var(--gray);
        }

        .score-bar {
            flex: 1;
            height: 10px;
            background: var(--light);
            border-radius: 20px;
            overflow: hidden;
        }

        .score-fill {
            height: 100%;
            background: linear-gradient(90deg, #10b981, #3b82f6);
            transition: width 0.5s;
        }

        .score-value {
            min-width: 40px;
            text-align: right;
            font-size: 14px;
            font-weight: bold;
        }

        /* í…Œì´ë¸” */
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }

        th {
            background: var(--light);
            padding: 12px;
            text-align: left;
            font-weight: 600;
            font-size: 13px;
            border-bottom: 2px solid var(--border);
        }

        td {
            padding: 12px;
            border-bottom: 1px solid var(--border);
            font-size: 14px;
        }

        tr:hover {
            background: var(--light);
        }

        /* ë¹ˆ ìƒíƒœ */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--gray);
        }

        .empty-icon {
            font-size: 64px;
            margin-bottom: 15px;
            opacity: 0.5;
        }

        /* ê°€ê²© í‘œì‹œ */
        .price-up { color: var(--danger); }
        .price-down { color: var(--primary); }

        /* ë°˜ì‘í˜• */
        @media (max-width: 768px) {
            .grid, .grid-2, .grid-3, .grid-4 {
                grid-template-columns: 1fr;
            }
            
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            h1 { font-size: 22px; }
            .stat-value { font-size: 24px; }
            .chart-container { height: 250px; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="header-top">
                <div>
                    <h1>ğŸ“Š íˆ¬ì ê´€ë¦¬ ì‹œìŠ¤í…œ Complete</h1>
                    <p class="subtitle">ì˜¬ì¸ì› íˆ¬ì ê´€ë¦¬ í”Œë«í¼</p>
                </div>
                <div class="header-actions">
                    <button class="btn-icon" onclick="exportData()" title="ë°ì´í„° ë‚´ë³´ë‚´ê¸°">ğŸ“¥</button>
                    <button class="btn-icon" onclick="document.getElementById('importFile').click()" title="ë°ì´í„° ê°€ì ¸ì˜¤ê¸°">ğŸ“¤</button>
                    <input type="file" id="importFile" style="display: none" accept=".json" onchange="importData(event)">
                </div>
            </div>
            
            <div class="nav-tabs">
                <button class="nav-tab active" onclick="showSection('dashboard')">ğŸ“Š ëŒ€ì‹œë³´ë“œ</button>
                <button class="nav-tab" onclick="showSection('principles')">ğŸ“œ íˆ¬ì ì›ì¹™</button>
                <button class="nav-tab" onclick="showSection('watchlist')">ğŸ‘€ ê´€ì‹¬ ì¢…ëª©</button>
                <button class="nav-tab" onclick="showSection('portfolio')">ğŸ’¼ í¬íŠ¸í´ë¦¬ì˜¤</button>
                <button class="nav-tab" onclick="showSection('trades')">ğŸ“ˆ ë§¤ë§¤ ì¼ì§€</button>
                <button class="nav-tab" onclick="showSection('analysis')">ğŸ” ì¢…ëª© ë¶„ì„</button>
                <button class="nav-tab" onclick="showSection('performance')">ğŸ“‰ ìˆ˜ìµë¥ </button>
                <button class="nav-tab" onclick="showSection('goals')">ğŸ† ëª©í‘œ</button>
                <button class="nav-tab" onclick="showSection('tax')">ğŸ’° ì„¸ê¸ˆ</button>
                <button class="nav-tab" onclick="showSection('mindset')">ğŸ§  ë§ˆì¸ë“œ ì»¨íŠ¸ë¡¤</button>
            </div>
        </header>

        <main id="mainContent">
            <!-- ëŒ€ì‹œë³´ë“œ -->
            <div id="dashboard" class="section active">
                <div class="grid grid-4">
                    <div class="stat-card">
                        <div class="stat-label">ì´ ìì‚°</div>
                        <div class="stat-value" id="totalAssets">0ì›</div>
                        <div class="stat-change" id="assetsChange">ì „ì¼ ëŒ€ë¹„ 0ì›</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">ì´ ìˆ˜ìµë¥ </div>
                        <div class="stat-value" id="totalReturn">0%</div>
                        <div class="stat-change" id="returnAmount">+0ì›</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">ë³´ìœ  ì¢…ëª©</div>
                        <div class="stat-value" id="stockCount">0ê°œ</div>
                        <div class="stat-change" id="avgReturn">í‰ê·  0%</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">ì´ë²ˆ ë‹¬</div>
                        <div class="stat-value" id="monthTrades">0íšŒ</div>
                        <div class="stat-change" id="monthProfit">0ì›</div>
                    </div>
                </div>

                <div class="card">
                    <h2>ğŸ“ˆ í¬íŠ¸í´ë¦¬ì˜¤ ì¶”ì´</h2>
                    <div class="chart-container">
                        <canvas id="portfolioChart"></canvas>
                    </div>
                </div>

                <div class="grid grid-2">
                    <div class="card">
                        <h2>ğŸ’¡ ë¹ ë¥¸ ë©”ëª¨</h2>
                        <textarea id="quickMemo" placeholder="ì˜¤ëŠ˜ì˜ ì‹œì¥ ìƒí™©, ì•„ì´ë””ì–´ ë“±..."></textarea>
                        <button onclick="saveQuickMemo()" style="margin-top: 10px;">ğŸ’¾ ì €ì¥</button>
                    </div>
                    <div class="card">
                        <h2>ğŸ¯ ì˜¤ëŠ˜ì˜ ì›ì¹™</h2>
                        <div id="todayPrinciple"></div>
                    </div>
                </div>
            </div>

            <!-- íˆ¬ì ì›ì¹™ -->
            <div id="principles" class="section">
                <div class="card">
                    <h2>ğŸ“œ ë‚˜ì˜ íˆ¬ì ì›ì¹™</h2>
                    <div id="principlesList"></div>
                    
                    <hr style="margin: 30px 0; border: none; border-top: 2px solid var(--light);">
                    
                    <h3 style="margin-bottom: 20px;">ìƒˆ ì›ì¹™ ì¶”ê°€</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>ì›ì¹™ ì œëª©</label>
                            <input type="text" id="principleTitle" placeholder="ì˜ˆ: ì†ì ˆ ì›ì¹™">
                        </div>
                        <div class="form-group">
                            <label>ì¤‘ìš”ë„</label>
                            <select id="principlePriority">
                                <option value="high">ë†’ìŒ</option>
                                <option value="medium">ë³´í†µ</option>
                                <option value="low">ë‚®ìŒ</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>ë‚´ìš©</label>
                        <textarea id="principleContent" placeholder="ìƒì„¸ ë‚´ìš©..."></textarea>
                    </div>
                    <button onclick="addPrinciple()">â• ì›ì¹™ ì¶”ê°€</button>
                </div>
            </div>

            <!-- ê´€ì‹¬ ì¢…ëª© -->
            <div id="watchlist" class="section">
                <div class="card">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h2 style="margin: 0; padding: 0; border: none;">ğŸ‘€ ê´€ì‹¬ ì¢…ëª©</h2>
                        <button class="btn-success btn-sm" onclick="updateWatchlistPrices()">ğŸ”„ ì „ì²´ ê°€ê²© ì—…ë°ì´íŠ¸</button>
                    </div>
                    <div id="watchlistItems"></div>
                    
                    <hr style="margin: 30px 0; border: none; border-top: 2px solid var(--light);">
                    
                    <h3 style="margin-bottom: 20px;">ìƒˆ ì¢…ëª© ì¶”ê°€</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>ì¢…ëª©ëª… ê²€ìƒ‰</label>
                            <div style="position: relative;">
                                <input type="text" id="stockSearch" placeholder="ì¢…ëª©ëª…ì„ ì…ë ¥í•˜ì„¸ìš” (ì˜ˆ: ì‚¼ì„±ì „ì)" 
                                    oninput="searchStock(this.value)" autocomplete="off">
                                <div id="stockSearchResults" style="display: none; position: absolute; top: 100%; left: 0; right: 0; 
                                    background: white; border: 2px solid var(--primary); border-radius: 8px; max-height: 200px; 
                                    overflow-y: auto; z-index: 1000; margin-top: 5px; box-shadow: 0 4px 12px rgba(0,0,0,0.15);"></div>
                            </div>
                            <small style="color: var(--gray); font-size: 12px; margin-top: 5px; display: block;">
                                ì¢…ëª©ëª…ì„ ì…ë ¥í•˜ë©´ ìë™ìœ¼ë¡œ ê²€ìƒ‰ë©ë‹ˆë‹¤
                            </small>
                        </div>
                        <div class="form-group">
                            <label>ì¢…ëª©ëª… (ìë™ ì…ë ¥ë¨)</label>
                            <input type="text" id="stockName" placeholder="ì‚¼ì„±ì „ì" readonly style="background: var(--light);">
                        </div>
                        <div class="form-group">
                            <label>ì¢…ëª© ì½”ë“œ (ìë™ ì…ë ¥ë¨)</label>
                            <div style="display: flex; gap: 10px;">
                                <input type="text" id="stockCode" placeholder="005930" readonly style="flex: 1; background: var(--light);">
                                <button type="button" class="btn-success" onclick="fetchStockPrice()" style="white-space: nowrap;">ğŸ” ê°€ê²© ì¡°íšŒ</button>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>í˜„ì¬ê°€ (ìë™ ì…ë ¥ë¨)</label>
                            <input type="number" id="stockPrice" placeholder="ìë™ ì¡°íšŒë¨" readonly style="background: var(--light);">
                            <small id="priceUpdateTime" style="color: var(--gray); font-size: 12px; margin-top: 5px; display: block;"></small>
                        </div>
                        <div class="form-group">
                            <label>ëª©í‘œê°€</label>
                            <input type="number" id="targetPrice" placeholder="80000">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>íˆ¬ì ë©”ëª¨</label>
                        <textarea id="stockMemo" placeholder="íˆ¬ì ì´ìœ , ì „ë§ ë“±..."></textarea>
                    </div>
                    <button onclick="addWatchlist()">â• ì¢…ëª© ì¶”ê°€</button>
                </div>
            </div>

            <!-- í¬íŠ¸í´ë¦¬ì˜¤ -->
            <div id="portfolio" class="section">
                <div class="card">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h2 style="margin: 0; padding: 0; border: none;">ğŸ’¼ ë³´ìœ  í¬íŠ¸í´ë¦¬ì˜¤</h2>
                        <button class="btn-success btn-sm" onclick="updateAllPrices()">ğŸ”„ ì „ì²´ ê°€ê²© ì—…ë°ì´íŠ¸</button>
                    </div>
                    <div id="portfolioItems"></div>
                    
                    <hr style="margin: 30px 0; border: none; border-top: 2px solid var(--light);">
                    
                    <h3 style="margin-bottom: 20px;">ë³´ìœ  ì¢…ëª© ì¶”ê°€</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>ì¢…ëª©ëª… ê²€ìƒ‰</label>
                            <div style="position: relative;">
                                <input type="text" id="portStockSearch" placeholder="ì¢…ëª©ëª…ì„ ì…ë ¥í•˜ì„¸ìš”" 
                                    oninput="searchPortfolioStock(this.value)" autocomplete="off">
                                <div id="portStockSearchResults" style="display: none; position: absolute; top: 100%; left: 0; right: 0; 
                                    background: white; border: 2px solid var(--primary); border-radius: 8px; max-height: 200px; 
                                    overflow-y: auto; z-index: 1000; margin-top: 5px; box-shadow: 0 4px 12px rgba(0,0,0,0.15);"></div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>ì¢…ëª©ëª… (ìë™)</label>
                            <input type="text" id="portStockName" placeholder="ìë™ ì…ë ¥ë¨" readonly style="background: var(--light);">
                        </div>
                        <div class="form-group">
                            <label>ì¢…ëª© ì½”ë“œ (ìë™)</label>
                            <input type="text" id="portStockCode" placeholder="ìë™ ì…ë ¥ë¨" readonly style="background: var(--light);">
                        </div>
                        <div class="form-group">
                            <label>ìˆ˜ëŸ‰</label>
                            <input type="number" id="portQuantity" placeholder="10">
                        </div>
                        <div class="form-group">
                            <label>í‰ê·  ë§¤ìˆ˜ê°€</label>
                            <input type="number" id="portBuyPrice" placeholder="65000">
                        </div>
                        <div class="form-group">
                            <label>í˜„ì¬ê°€ (ìë™)</label>
                            <input type="number" id="portCurrentPrice" placeholder="ìë™ ì¡°íšŒë¨" readonly style="background: var(--light);">
                            <small id="portPriceUpdateTime" style="color: var(--gray); font-size: 12px; margin-top: 5px; display: block;"></small>
                        </div>
                    </div>
                    <button onclick="addPortfolio()">â• ì¢…ëª© ì¶”ê°€</button>
                </div>
            </div>

            <!-- ë§¤ë§¤ ì¼ì§€ -->
            <div id="trades" class="section">
                <div class="card">
                    <h2>ğŸ“ˆ ë§¤ë§¤ ì¼ì§€</h2>
                    <div id="tradesList"></div>
                    
                    <hr style="margin: 30px 0; border: none; border-top: 2px solid var(--light);">
                    
                    <h3 style="margin-bottom: 20px;">ë§¤ë§¤ ê¸°ë¡ ì¶”ê°€</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>ë§¤ë§¤ ìœ í˜•</label>
                            <select id="tradeType">
                                <option value="buy">ë§¤ìˆ˜</option>
                                <option value="sell">ë§¤ë„</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>ì¢…ëª©ëª…</label>
                            <input type="text" id="tradeName" placeholder="ì‚¼ì„±ì „ì">
                        </div>
                        <div class="form-group">
                            <label>ìˆ˜ëŸ‰</label>
                            <input type="number" id="tradeQuantity" placeholder="10">
                        </div>
                        <div class="form-group">
                            <label>ê°€ê²©</label>
                            <input type="number" id="tradePrice" placeholder="70000">
                        </div>
                        <div class="form-group">
                            <label>ê±°ë˜ì¼</label>
                            <input type="date" id="tradeDate">
                        </div>
                        <div class="form-group">
                            <label>ì „ëµ</label>
                            <input type="text" id="tradeStrategy" placeholder="ì˜ˆ: ë‹¨ê¸° ë§¤ë§¤">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>ë©”ëª¨</label>
                        <textarea id="tradeMemo" placeholder="ë§¤ë§¤ ì´ìœ , ì‹œì¥ ìƒí™© ë“±..."></textarea>
                    </div>
                    <button onclick="addTrade()">â• ê¸°ë¡ ì¶”ê°€</button>
                </div>
            </div>

            <!-- ì¢…ëª© ë¶„ì„ -->
            <div id="analysis" class="section">
                <div class="card">
                    <h2>ğŸ” ì¢…ëª© ë¶„ì„</h2>
                    <div id="analysisItems"></div>
                    
                    <hr style="margin: 30px 0; border: none; border-top: 2px solid var(--light);">
                    
                    <h3 style="margin-bottom: 20px;">ì¢…ëª© ë¶„ì„ ì¶”ê°€</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>ì¢…ëª©ëª…</label>
                            <input type="text" id="analysisName" placeholder="ì‚¼ì„±ì „ì">
                        </div>
                        <div class="form-group">
                            <label>ì„¹í„°</label>
                            <input type="text" id="analysisSector" placeholder="ë°˜ë„ì²´">
                        </div>
                    </div>
                    
                    <h4 style="margin: 20px 0 15px;">ì¬ë¬´ ì§€í‘œ</h4>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>PER</label>
                            <input type="number" step="0.1" id="analysisPer" placeholder="15.5">
                        </div>
                        <div class="form-group">
                            <label>PBR</label>
                            <input type="number" step="0.1" id="analysisPbr" placeholder="1.2">
                        </div>
                        <div class="form-group">
                            <label>ROE (%)</label>
                            <input type="number" step="0.1" id="analysisRoe" placeholder="12.5">
                        </div>
                        <div class="form-group">
                            <label>ë¶€ì±„ë¹„ìœ¨ (%)</label>
                            <input type="number" step="0.1" id="analysisDebt" placeholder="45">
                        </div>
                    </div>
                    
                    <h4 style="margin: 20px 0 15px;">íˆ¬ì ì ìˆ˜ (0-100)</h4>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>ì¬ë¬´ ê±´ì „ì„±</label>
                            <input type="number" min="0" max="100" id="scoreFinancial" placeholder="80">
                        </div>
                        <div class="form-group">
                            <label>ì„±ì¥ì„±</label>
                            <input type="number" min="0" max="100" id="scoreGrowth" placeholder="75">
                        </div>
                        <div class="form-group">
                            <label>ìˆ˜ìµì„±</label>
                            <input type="number" min="0" max="100" id="scoreProfitability" placeholder="85">
                        </div>
                        <div class="form-group">
                            <label>ë°¸ë¥˜ì—ì´ì…˜</label>
                            <input type="number" min="0" max="100" id="scoreValuation" placeholder="70">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>ë¶„ì„ ë‚´ìš©</label>
                        <textarea id="analysisContent" placeholder="ê°•ì , ì•½ì , ì „ë§ ë“±ì„ ì‘ì„±í•˜ì„¸ìš”..."></textarea>
                    </div>
                    <button onclick="addAnalysis()">â• ë¶„ì„ ì¶”ê°€</button>
                </div>
            </div>

            <!-- ìˆ˜ìµë¥  ë¶„ì„ -->
            <div id="performance" class="section">
                <div class="card">
                    <h2>ğŸ“‰ ìˆ˜ìµë¥  ë¶„ì„</h2>
                    
                    <div class="grid grid-3">
                        <div class="stat-card">
                            <div class="stat-label">ì¼ê°„ ìˆ˜ìµë¥ </div>
                            <div class="stat-value" id="dailyReturn">0%</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">ì£¼ê°„ ìˆ˜ìµë¥ </div>
                            <div class="stat-value" id="weeklyReturn">0%</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">ì›”ê°„ ìˆ˜ìµë¥ </div>
                            <div class="stat-value" id="monthlyReturn">0%</div>
                        </div>
                    </div>

                    <div style="margin-top: 30px;">
                        <h3 style="margin-bottom: 15px;">ë§¤ë§¤ í†µê³„</h3>
                        <div class="grid grid-2">
                            <div>
                                <div class="score-item">
                                    <span class="score-label">ìŠ¹ë¥ </span>
                                    <div class="score-bar">
                                        <div class="score-fill" id="winRateBar"></div>
                                    </div>
                                    <span class="score-value" id="winRate">0%</span>
                                </div>
                                <div class="score-item">
                                    <span class="score-label">í‰ê·  ìˆ˜ìµ</span>
                                    <div class="score-bar">
                                        <div class="score-fill" id="avgProfitBar"></div>
                                    </div>
                                    <span class="score-value" id="avgProfit">0%</span>
                                </div>
                            </div>
                            <div>
                                <div class="item-meta">
                                    <span>ì´ ë§¤ë§¤ íšŸìˆ˜: <strong id="totalTrades">0íšŒ</strong></span>
                                    <span>ìˆ˜ìµ ê±°ë˜: <strong id="winTrades">0íšŒ</strong></span>
                                    <span>ì†ì‹¤ ê±°ë˜: <strong id="lossTrades">0íšŒ</strong></span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div style="margin-top: 30px;">
                        <h3 style="margin-bottom: 15px;">ì›”ë³„ ì†ìµ</h3>
                        <div class="chart-container">
                            <canvas id="monthlyChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ëª©í‘œ ê´€ë¦¬ -->
            <div id="goals" class="section">
                <div class="card">
                    <h2>ğŸ† íˆ¬ì ëª©í‘œ</h2>
                    <div id="goalsList"></div>
                    
                    <hr style="margin: 30px 0; border: none; border-top: 2px solid var(--light);">
                    
                    <h3 style="margin-bottom: 20px;">ìƒˆ ëª©í‘œ ì¶”ê°€</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>ëª©í‘œ ë‚´ìš©</label>
                            <input type="text" id="goalTitle" placeholder="ì˜ˆ: 1ì–µ ë§Œë“¤ê¸°">
                        </div>
                        <div class="form-group">
                            <label>ëª©í‘œ ê¸ˆì•¡</label>
                            <input type="number" id="goalTarget" placeholder="100000000">
                        </div>
                        <div class="form-group">
                            <label>í˜„ì¬ ê¸ˆì•¡</label>
                            <input type="number" id="goalCurrent" placeholder="50000000">
                        </div>
                        <div class="form-group">
                            <label>ëª©í‘œì¼</label>
                            <input type="date" id="goalDate">
                        </div>
                    </div>
                    <button onclick="addGoal()">â• ëª©í‘œ ì¶”ê°€</button>
                </div>
            </div>

            <!-- ì„¸ê¸ˆ ê³„ì‚° -->
            <div id="tax" class="section">
                <div class="card">
                    <h2>ğŸ’° ì„¸ê¸ˆ ê³„ì‚°ê¸°</h2>
                    
                    <h3 style="margin-bottom: 15px;">ì–‘ë„ì†Œë“ì„¸ ê³„ì‚°</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>ë§¤ë„ê°€</label>
                            <input type="number" id="sellPrice" placeholder="100000000">
                        </div>
                        <div class="form-group">
                            <label>ë§¤ìˆ˜ê°€</label>
                            <input type="number" id="buyPrice" placeholder="80000000">
                        </div>
                        <div class="form-group">
                            <label>ë³´ìœ  ê¸°ê°„ (ë…„)</label>
                            <input type="number" id="holdingPeriod" placeholder="2">
                        </div>
                    </div>
                    <button onclick="calculateCapitalGainTax()">ğŸ’µ ì–‘ë„ì„¸ ê³„ì‚°</button>
                    <div id="taxResult" style="margin-top: 20px;"></div>

                    <hr style="margin: 30px 0; border: none; border-top: 2px solid var(--light);">

                    <h3 style="margin-bottom: 15px;">ë°°ë‹¹ì†Œë“ì„¸ ê³„ì‚°</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>ë°°ë‹¹ê¸ˆ</label>
                            <input type="number" id="dividend" placeholder="5000000">
                        </div>
                    </div>
                    <button onclick="calculateDividendTax()">ğŸ’µ ë°°ë‹¹ì„¸ ê³„ì‚°</button>
                    <div id="dividendTaxResult" style="margin-top: 20px;"></div>

                    <hr style="margin: 30px 0; border: none; border-top: 2px solid var(--light);">

                    <h3 style="margin-bottom: 15px;">ì—°ê°„ ì†ìµ ì •ì‚°</h3>
                    <div id="yearlyTaxSummary"></div>
                    <button onclick="calculateYearlyTax()">ğŸ“Š ì—°ê°„ ì†ìµ ê³„ì‚°</button>
                </div>
            </div>

            <!-- ë§ˆì¸ë“œ ì»¨íŠ¸ë¡¤ -->
            <div id="mindset" class="section">
                <div class="grid grid-2">
                    <!-- íˆ¬ì ì‹¬ë¦¬ ì²´í¬ -->
                    <div class="card">
                        <h2>ğŸ§  íˆ¬ì ì‹¬ë¦¬ ì²´í¬</h2>
                        <p style="color: var(--gray); margin-bottom: 20px;">í˜„ì¬ ë‚˜ì˜ íˆ¬ì ì‹¬ë¦¬ ìƒíƒœë¥¼ ì ê²€í•˜ì„¸ìš”</p>
                        
                        <div style="margin-bottom: 20px;">
                            <label>ğŸ˜¨ ê³µí¬ ìˆ˜ì¤€ (0-10)</label>
                            <input type="range" id="fearLevel" min="0" max="10" value="5" 
                                oninput="updateMindsetBar('fear', this.value)" style="width: 100%;">
                            <div style="text-align: center; margin-top: 5px;">
                                <strong id="fearValue">5</strong> / 10
                            </div>
                        </div>

                        <div style="margin-bottom: 20px;">
                            <label>ğŸ˜ íƒìš• ìˆ˜ì¤€ (0-10)</label>
                            <input type="range" id="greedLevel" min="0" max="10" value="5" 
                                oninput="updateMindsetBar('greed', this.value)" style="width: 100%;">
                            <div style="text-align: center; margin-top: 5px;">
                                <strong id="greedValue">5</strong> / 10
                            </div>
                        </div>

                        <div style="margin-bottom: 20px;">
                            <label>ğŸ¯ ìì‹ ê° ìˆ˜ì¤€ (0-10)</label>
                            <input type="range" id="confidenceLevel" min="0" max="10" value="5" 
                                oninput="updateMindsetBar('confidence', this.value)" style="width: 100%;">
                            <div style="text-align: center; margin-top: 5px;">
                                <strong id="confidenceValue">5</strong> / 10
                            </div>
                        </div>

                        <div style="margin-bottom: 20px;">
                            <label>ğŸ˜° ìŠ¤íŠ¸ë ˆìŠ¤ ìˆ˜ì¤€ (0-10)</label>
                            <input type="range" id="stressLevel" min="0" max="10" value="5" 
                                oninput="updateMindsetBar('stress', this.value)" style="width: 100%;">
                            <div style="text-align: center; margin-top: 5px;">
                                <strong id="stressValue">5</strong> / 10
                            </div>
                        </div>

                        <div id="mindsetAdvice" style="margin-top: 20px;"></div>
                        <button onclick="saveMindsetCheck()">ğŸ’¾ ì‹¬ë¦¬ ìƒíƒœ ê¸°ë¡</button>
                    </div>

                    <!-- ê°ì • ì¼ê¸° -->
                    <div class="card">
                        <h2>ğŸ“” íˆ¬ì ê°ì • ì¼ê¸°</h2>
                        <div id="emotionDiaryList"></div>
                        
                        <hr style="margin: 20px 0; border: none; border-top: 2px solid var(--light);">
                        
                        <div class="form-group">
                            <label>ì˜¤ëŠ˜ì˜ ê°ì •</label>
                            <select id="emotionType">
                                <option value="happy">ğŸ˜Š ê¸°ì¨ (ìˆ˜ìµ)</option>
                                <option value="sad">ğŸ˜¢ ìŠ¬í”” (ì†ì‹¤)</option>
                                <option value="anxious">ğŸ˜° ë¶ˆì•ˆ (ë³€ë™ì„±)</option>
                                <option value="regret">ğŸ˜” í›„íšŒ (ê¸°íšŒ ìƒì‹¤)</option>
                                <option value="confident">ğŸ˜ ìì‹ ê° (í™•ì‹ )</option>
                                <option value="confused">ğŸ˜• í˜¼ë€ (ë§ì„¤ì„)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>ê°ì • ì¼ê¸°</label>
                            <textarea id="emotionContent" placeholder="ì˜¤ëŠ˜ íˆ¬ìí•˜ë©´ì„œ ëŠë‚€ ê°ì •, ìƒê°, ê³ ë¯¼ ë“±ì„ ì†”ì§í•˜ê²Œ ì ì–´ë³´ì„¸ìš”..."></textarea>
                        </div>
                        <button onclick="addEmotionDiary()">âœï¸ ì¼ê¸° ì“°ê¸°</button>
                    </div>
                </div>

                <div class="grid grid-2">
                    <!-- ì‹¤ìˆ˜ ë…¸íŠ¸ -->
                    <div class="card">
                        <h2>âš ï¸ íˆ¬ì ì‹¤ìˆ˜ ë…¸íŠ¸</h2>
                        <p style="color: var(--gray); margin-bottom: 20px;">ê°™ì€ ì‹¤ìˆ˜ë¥¼ ë°˜ë³µí•˜ì§€ ì•Šê¸° ìœ„í•œ ê¸°ë¡</p>
                        <div id="mistakesList"></div>
                        
                        <hr style="margin: 20px 0; border: none; border-top: 2px solid var(--light);">
                        
                        <div class="form-group">
                            <label>ì‹¤ìˆ˜ ìœ í˜•</label>
                            <select id="mistakeType">
                                <option value="emotional">ê°ì •ì  ë§¤ë§¤</option>
                                <option value="noplan">ê³„íš ì—†ëŠ” ë§¤ë§¤</option>
                                <option value="overleveraged">ê³¼ë„í•œ ë ˆë²„ë¦¬ì§€</option>
                                <option value="fomo">FOMO (ë†“ì¹ ê¹Œë´ ë‘ë ¤ì›€)</option>
                                <option value="cutloss">ì†ì ˆ ì‹¤íŒ¨</option>
                                <option value="overtrading">ê³¼ë„í•œ ë§¤ë§¤</option>
                                <option value="other">ê¸°íƒ€</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>ì‹¤ìˆ˜ ë‚´ìš©</label>
                            <textarea id="mistakeContent" placeholder="ì–´ë–¤ ì‹¤ìˆ˜ë¥¼ í–ˆë‚˜ìš”?"></textarea>
                        </div>
                        <div class="form-group">
                            <label>ë°°ìš´ ì  & ì¬ë°œ ë°©ì§€ì±…</label>
                            <textarea id="mistakeLesson" placeholder="ì´ ì‹¤ìˆ˜ë¡œë¶€í„° ë¬´ì—‡ì„ ë°°ì› ê³ , ì•ìœ¼ë¡œ ì–´ë–»ê²Œ ë°©ì§€í•  ê²ƒì¸ê°€?"></textarea>
                        </div>
                        <button onclick="addMistake()">ğŸ“ ì‹¤ìˆ˜ ê¸°ë¡</button>
                    </div>

                    <!-- ì„±ê³µ ì‚¬ë¡€ -->
                    <div class="card">
                        <h2>ğŸ† íˆ¬ì ì„±ê³µ ì‚¬ë¡€</h2>
                        <p style="color: var(--gray); margin-bottom: 20px;">ì˜í•œ íˆ¬ì ê²°ì •ì„ ê¸°ë¡í•˜ê³  ë°˜ë³µí•˜ì„¸ìš”</p>
                        <div id="successList"></div>
                        
                        <hr style="margin: 20px 0; border: none; border-top: 2px solid var(--light);">
                        
                        <div class="form-group">
                            <label>ì„±ê³µ ìœ í˜•</label>
                            <select id="successType">
                                <option value="patience">ì¸ë‚´ì‹¬ ë°œíœ˜</option>
                                <option value="discipline">ì›ì¹™ ì¤€ìˆ˜</option>
                                <option value="research">ì² ì €í•œ ë¶„ì„</option>
                                <option value="timing">ì ì ˆí•œ íƒ€ì´ë°</option>
                                <option value="cutloss">ë¹ ë¥¸ ì†ì ˆ</option>
                                <option value="other">ê¸°íƒ€</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>ì„±ê³µ ë‚´ìš©</label>
                            <textarea id="successContent" placeholder="ë¬´ì—‡ì„ ì˜í–ˆë‚˜ìš”?"></textarea>
                        </div>
                        <div class="form-group">
                            <label>ì„±ê³µ ìš”ì¸ & ë°˜ë³µ ì „ëµ</label>
                            <textarea id="successReason" placeholder="ì™œ ì„±ê³µí–ˆê³ , ì–´ë–»ê²Œ ë°˜ë³µí•  ê²ƒì¸ê°€?"></textarea>
                        </div>
                        <button onclick="addSuccess()">ğŸŒŸ ì„±ê³µ ê¸°ë¡</button>
                    </div>
                </div>

                <!-- ëª…ì–¸ & ê²©ë ¤ -->
                <div class="card">
                    <h2>ğŸ’¬ íˆ¬ì ëª…ì–¸ & ë‚˜ì—ê²Œ í•˜ëŠ” ë§</h2>
                    <div id="quotesList"></div>
                    
                    <hr style="margin: 20px 0; border: none; border-top: 2px solid var(--light);">
                    
                    <div class="form-group">
                        <label>ëª…ì–¸ / ê²©ë ¤ ë¬¸êµ¬</label>
                        <textarea id="quoteContent" placeholder="íˆ¬ìí•  ë•Œ ë– ì˜¬ë¦¬ê³  ì‹¶ì€ ëª…ì–¸, ë‚˜ ìì‹ ì—ê²Œ í•˜ëŠ” ê²©ë ¤, ë‹¤ì§ ë“±..."></textarea>
                    </div>
                    <button onclick="addQuote()">ğŸ’­ ì¶”ê°€</button>
                </div>

                <!-- ì‹¬ë¦¬ í†µê³„ -->
                <div class="card">
                    <h2>ğŸ“Š ì‹¬ë¦¬ ìƒíƒœ ì¶”ì´</h2>
                    <div class="chart-container">
                        <canvas id="mindsetChart"></canvas>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        // ë°ì´í„° ì €ì¥ì†Œ
        let appData = {
            principles: [],
            watchlist: [],
            portfolio: [],
            trades: [],
            analysis: [],
            goals: [],
            memos: [],
            mindsetChecks: [],
            emotionDiary: [],
            mistakes: [],
            successes: [],
            quotes: []
        };

        let portfolioChart = null;
        let monthlyChart = null;
        let mindsetChart = null;

        // í˜ì´ì§€ ë¡œë“œ
        window.addEventListener('load', () => {
            loadData();
            initCharts();
            document.getElementById('tradeDate').valueAsDate = new Date();
        });

        // ì„¹ì…˜ ì „í™˜
        function showSection(sectionId) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.getElementById(sectionId).classList.add('active');
            
            document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
            event.target.classList.add('active');

            // íŠ¹ì • ì„¹ì…˜ ì§„ì… ì‹œ ì—…ë°ì´íŠ¸
            if (sectionId === 'performance') updatePerformance();
        }

        // ë°ì´í„° ë¡œë“œ
        function loadData() {
            const saved = localStorage.getItem('investmentDataComplete');
            if (saved) {
                appData = JSON.parse(saved);
            } else {
                // ì´ˆê¸° ì˜ˆì‹œ ë°ì´í„°
                appData = {
                    principles: [
                        {
                            id: Date.now(),
                            title: 'ì†ì ˆ ì›ì¹™',
                            priority: 'high',
                            content: 'ë§¤ìˆ˜ê°€ ëŒ€ë¹„ -7% í•˜ë½ ì‹œ ë¬´ì¡°ê±´ ì†ì ˆí•œë‹¤.'
                        }
                    ],
                    watchlist: [
                        {
                            id: Date.now(),
                            name: 'ì‚¼ì„±ì „ì',
                            code: '005930',
                            price: 70000,
                            targetPrice: 80000,
                            memo: 'AI ë°˜ë„ì²´ ìˆ˜ìš” ì¦ê°€ ê¸°ëŒ€'
                        }
                    ],
                    portfolio: [],
                    trades: [],
                    analysis: [],
                    goals: [],
                    memos: [],
                    mindsetChecks: [],
                    emotionDiary: [],
                    mistakes: [],
                    successes: [],
                    quotes: [
                        {
                            id: Date.now(),
                            date: new Date().toISOString(),
                            content: 'ì‹œì¥ì€ ëˆì„ ì¡°ê¸‰í•œ ì‚¬ëŒì—ê²Œì„œ ì¸ë‚´ì‹¬ ìˆëŠ” ì‚¬ëŒì—ê²Œë¡œ ì˜®ê¸°ëŠ” ì¥ì¹˜ë‹¤. - ì›Œë Œ ë²„í•'
                        }
                    ]
                };
                saveData();
            }
            renderAll();
        }

        // ë°ì´í„° ì €ì¥
        function saveData() {
            localStorage.setItem('investmentDataComplete', JSON.stringify(appData));
        }

        // ê¸ˆì•¡ í¬ë§·
        function formatMoney(num) {
            if (!num) return '0ì›';
            if (num >= 100000000) return (num / 100000000).toFixed(1) + 'ì–µì›';
            if (num >= 10000) return (num / 10000).toFixed(0) + 'ë§Œì›';
            return num.toLocaleString() + 'ì›';
        }

        // ë‚ ì§œ í¬ë§·
        function formatDate(dateString) {
            const date = new Date(dateString);
            return `${date.getFullYear()}.${String(date.getMonth() + 1).padStart(2, '0')}.${String(date.getDate()).padStart(2, '0')}`;
        }

        // ì°¨íŠ¸ ì´ˆê¸°í™”
        function initCharts() {
            // í¬íŠ¸í´ë¦¬ì˜¤ ì°¨íŠ¸
            const ctx1 = document.getElementById('portfolioChart');
            if (ctx1) {
                portfolioChart = new Chart(ctx1, {
                    type: 'line',
                    data: {
                        labels: ['1ì›”', '2ì›”', '3ì›”', '4ì›”', '5ì›”', '6ì›”'],
                        datasets: [{
                            label: 'í¬íŠ¸í´ë¦¬ì˜¤ ê°€ì¹˜',
                            data: [5000, 5200, 5400, 5300, 5600, 5800],
                            borderColor: 'rgb(37, 99, 235)',
                            backgroundColor: 'rgba(37, 99, 235, 0.1)',
                            tension: 0.4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { display: false }
                        }
                    }
                });
            }

            // ì›”ë³„ ì°¨íŠ¸
            const ctx2 = document.getElementById('monthlyChart');
            if (ctx2) {
                monthlyChart = new Chart(ctx2, {
                    type: 'bar',
                    data: {
                        labels: ['1ì›”', '2ì›”', '3ì›”', '4ì›”', '5ì›”', '6ì›”'],
                        datasets: [{
                            label: 'ì›”ë³„ ì†ìµ',
                            data: [200, -100, 300, 150, 400, 250],
                            backgroundColor: function(context) {
                                const value = context.parsed.y;
                                return value >= 0 ? 'rgba(239, 68, 68, 0.8)' : 'rgba(37, 99, 235, 0.8)';
                            }
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { display: false }
                        }
                    }
                });
            }
        }

        // =================
        // íˆ¬ì ì›ì¹™
        // =================
        function renderPrinciples() {
            const container = document.getElementById('principlesList');
            if (!container) return;

            if (appData.principles.length === 0) {
                container.innerHTML = '<div class="empty-state"><div class="empty-icon">ğŸ“œ</div><p>ë“±ë¡ëœ íˆ¬ì ì›ì¹™ì´ ì—†ìŠµë‹ˆë‹¤.</p></div>';
                return;
            }

            container.innerHTML = appData.principles.map(p => `
                <div class="item-card">
                    <div class="item-header">
                        <span class="item-title">${p.title}</span>
                        <span class="badge badge-${p.priority}">${
                            p.priority === 'high' ? 'ë†’ìŒ' : 
                            p.priority === 'medium' ? 'ë³´í†µ' : 'ë‚®ìŒ'
                        }</span>
                    </div>
                    <div class="item-content">${p.content}</div>
                    <button class="btn-danger btn-sm" onclick="deletePrinciple(${p.id})">ğŸ—‘ï¸ ì‚­ì œ</button>
                </div>
            `).join('');

            // ì˜¤ëŠ˜ì˜ ì›ì¹™
            const today = document.getElementById('todayPrinciple');
            if (today && appData.principles.length > 0) {
                const random = appData.principles[Math.floor(Math.random() * appData.principles.length)];
                today.innerHTML = `
                    <div class="item-card">
                        <div class="item-title">${random.title}</div>
                        <div class="item-content">${random.content}</div>
                    </div>
                `;
            }
        }

        function addPrinciple() {
            const title = document.getElementById('principleTitle').value.trim();
            const priority = document.getElementById('principlePriority').value;
            const content = document.getElementById('principleContent').value.trim();

            if (!title || !content) {
                alert('ì œëª©ê³¼ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”!');
                return;
            }

            appData.principles.push({
                id: Date.now(),
                title, priority, content
            });

            document.getElementById('principleTitle').value = '';
            document.getElementById('principleContent').value = '';

            saveData();
            renderPrinciples();
        }

        function deletePrinciple(id) {
            if (!confirm('ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;
            appData.principles = appData.principles.filter(p => p.id !== id);
            saveData();
            renderPrinciples();
        }

        // =================
        // ì‹¤ì‹œê°„ ì£¼ê°€ ì¡°íšŒ
        // =================
        
        // í•œêµ­ ì£¼ì‹ ì¢…ëª© ë°ì´í„° (ì£¼ìš” ì¢…ëª©)
        const koreanStocks = [
            { name: 'ì‚¼ì„±ì „ì', code: '005930' },
            { name: 'SKí•˜ì´ë‹‰ìŠ¤', code: '000660' },
            { name: 'LGì—ë„ˆì§€ì†”ë£¨ì…˜', code: '373220' },
            { name: 'NAVER', code: '035420' },
            { name: 'ì¹´ì¹´ì˜¤', code: '035720' },
            { name: 'í˜„ëŒ€ì°¨', code: '005380' },
            { name: 'KBê¸ˆìœµ', code: '105560' },
            { name: 'ì‹ í•œì§€ì£¼', code: '055550' },
            { name: 'ê¸°ì•„', code: '000270' },
            { name: 'ì…€íŠ¸ë¦¬ì˜¨', code: '068270' },
            { name: 'ì‚¼ì„±ë°”ì´ì˜¤ë¡œì§ìŠ¤', code: '207940' },
            { name: 'POSCOí™€ë”©ìŠ¤', code: '005490' },
            { name: 'ì‚¼ì„±SDI', code: '006400' },
            { name: 'í˜„ëŒ€ëª¨ë¹„ìŠ¤', code: '012330' },
            { name: 'LGí™”í•™', code: '051910' },
            { name: 'SKì´ë…¸ë² ì´ì…˜', code: '096770' },
            { name: 'LGì „ì', code: '066570' },
            { name: 'ì‚¼ì„±ë¬¼ì‚°', code: '028260' },
            { name: 'í•œêµ­ì „ë ¥', code: '015760' },
            { name: 'SKí…”ë ˆì½¤', code: '017670' },
            { name: 'KT', code: '030200' },
            { name: 'HMM', code: '011200' },
            { name: 'ì‚¼ì„±ìƒëª…', code: '032830' },
            { name: 'í•˜ë‚˜ê¸ˆìœµì§€ì£¼', code: '086790' },
            { name: 'ìš°ë¦¬ê¸ˆìœµì§€ì£¼', code: '316140' },
            { name: 'í¬ìŠ¤ì½”í“¨ì²˜ì— ', code: '003670' },
            { name: 'ê³ ë ¤ì•„ì—°', code: '010130' },
            { name: 'ì—”ì”¨ì†Œí”„íŠ¸', code: '036570' },
            { name: 'ë„·ë§ˆë¸”', code: '251270' },
            { name: 'í¬ë˜í”„í†¤', code: '259960' },
            { name: 'ì¹´ì¹´ì˜¤ë±…í¬', code: '323410' },
            { name: 'ì¹´ì¹´ì˜¤í˜ì´', code: '377300' },
            { name: 'ë‘ì‚°ì—ë„ˆë¹Œë¦¬í‹°', code: '034020' },
            { name: 'SKìŠ¤í€˜ì–´', code: '402340' },
            { name: 'LGìƒí™œê±´ê°•', code: '051900' },
            { name: 'ì•„ëª¨ë ˆí¼ì‹œí”½', code: '090430' },
            { name: 'ì¿ íŒ¡', code: 'CPNG' },
            { name: 'ì‚¼ì„±ì „ê¸°', code: '009150' },
            { name: 'SK', code: '034730' },
            { name: 'LG', code: '003550' },
            { name: 'í•œí™”ì—ì–´ë¡œìŠ¤í˜ì´ìŠ¤', code: '012450' },
            { name: 'ì—ì½”í”„ë¡œë¹„ì— ', code: '247540' },
            { name: 'ì—ì½”í”„ë¡œ', code: '086520' },
            { name: 'í¬ìŠ¤ì½”ì¸í„°ë‚´ì…”ë„', code: '047050' },
            { name: 'ì‚¼ì„±í™”ì¬', code: '000810' },
            { name: 'ê¸°ì—…ì€í–‰', code: '024110' },
            { name: 'ë¡¯ë°ì¼€ë¯¸ì¹¼', code: '011170' },
            { name: 'SKë°”ì´ì˜¤íŒœ', code: '326030' },
            { name: 'ì‚¼ì„±ì—ìŠ¤ë””ì—ìŠ¤', code: '018260' },
            { name: 'CJì œì¼ì œë‹¹', code: '097950' }
        ];
        
        // ë¯¸êµ­ ì£¼ì‹ ì¢…ëª© ë°ì´í„° (ì£¼ìš” ì¢…ëª©)
        const usStocks = [
            { name: 'ì• í”Œ', code: 'AAPL' },
            { name: 'Apple', code: 'AAPL' },
            { name: 'ë§ˆì´í¬ë¡œì†Œí”„íŠ¸', code: 'MSFT' },
            { name: 'Microsoft', code: 'MSFT' },
            { name: 'êµ¬ê¸€', code: 'GOOGL' },
            { name: 'Google', code: 'GOOGL' },
            { name: 'ì•ŒíŒŒë²³', code: 'GOOGL' },
            { name: 'ì•„ë§ˆì¡´', code: 'AMZN' },
            { name: 'Amazon', code: 'AMZN' },
            { name: 'í…ŒìŠ¬ë¼', code: 'TSLA' },
            { name: 'Tesla', code: 'TSLA' },
            { name: 'ì—”ë¹„ë””ì•„', code: 'NVDA' },
            { name: 'NVIDIA', code: 'NVDA' },
            { name: 'ë©”íƒ€', code: 'META' },
            { name: 'Meta', code: 'META' },
            { name: 'í˜ì´ìŠ¤ë¶', code: 'META' },
            { name: 'ë„·í”Œë¦­ìŠ¤', code: 'NFLX' },
            { name: 'Netflix', code: 'NFLX' },
            { name: 'ë””ì¦ˆë‹ˆ', code: 'DIS' },
            { name: 'Disney', code: 'DIS' },
            { name: 'ë‚˜ì´í‚¤', code: 'NKE' },
            { name: 'Nike', code: 'NKE' },
            { name: 'ì½”ì¹´ì½œë¼', code: 'KO' },
            { name: 'Coca-Cola', code: 'KO' },
            { name: 'ë§¥ë„ë‚ ë“œ', code: 'MCD' },
            { name: "McDonald's", code: 'MCD' },
            { name: 'AMD', code: 'AMD' },
            { name: 'ì¸í…”', code: 'INTC' },
            { name: 'Intel', code: 'INTC' },
            { name: 'í€„ì»´', code: 'QCOM' },
            { name: 'Qualcomm', code: 'QCOM' },
            { name: 'íŒ”ë€í‹°ì–´', code: 'PLTR' },
            { name: 'Palantir', code: 'PLTR' }
        ];
        
        // ì „ì²´ ì¢…ëª© ë¦¬ìŠ¤íŠ¸
        const allStocks = [...koreanStocks, ...usStocks];
        
        // ì¢…ëª© ê²€ìƒ‰ í•¨ìˆ˜
        let searchTimeout = null;
        
        function searchStock(query) {
            const resultsDiv = document.getElementById('stockSearchResults');
            
            if (!query || query.length < 1) {
                resultsDiv.style.display = 'none';
                return;
            }
            
            // ë””ë°”ìš´ì‹± (0.3ì´ˆ ëŒ€ê¸°)
            clearTimeout(searchTimeout);
            searchTimeout = setTimeout(() => {
                const results = allStocks.filter(stock => 
                    stock.name.toLowerCase().includes(query.toLowerCase()) ||
                    stock.code.toLowerCase().includes(query.toLowerCase())
                ).slice(0, 10); // ìµœëŒ€ 10ê°œ
                
                if (results.length === 0) {
                    resultsDiv.innerHTML = '<div style="padding: 10px; color: var(--gray);">ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤</div>';
                    resultsDiv.style.display = 'block';
                    return;
                }
                
                resultsDiv.innerHTML = results.map(stock => `
                    <div onclick="selectStock('${stock.name}', '${stock.code}')" 
                        style="padding: 12px; cursor: pointer; border-bottom: 1px solid var(--light); 
                        transition: background 0.2s;"
                        onmouseover="this.style.background='var(--light)'"
                        onmouseout="this.style.background='white'">
                        <strong>${stock.name}</strong>
                        <span style="color: var(--gray); margin-left: 10px; font-size: 13px;">${stock.code}</span>
                    </div>
                `).join('');
                
                resultsDiv.style.display = 'block';
            }, 300);
        }
        
        // ì¢…ëª© ì„ íƒ í•¨ìˆ˜
        async function selectStock(name, code) {
            document.getElementById('stockName').value = name;
            document.getElementById('stockCode').value = code;
            document.getElementById('stockSearch').value = name;
            document.getElementById('stockSearchResults').style.display = 'none';
            
            // ìë™ìœ¼ë¡œ ê°€ê²© ì¡°íšŒ
            await fetchStockPrice();
        }
        
        // í¬íŠ¸í´ë¦¬ì˜¤ ì¢…ëª© ê²€ìƒ‰
        function searchPortfolioStock(query) {
            const resultsDiv = document.getElementById('portStockSearchResults');
            
            if (!query || query.length < 1) {
                resultsDiv.style.display = 'none';
                return;
            }
            
            clearTimeout(searchTimeout);
            searchTimeout = setTimeout(() => {
                const results = allStocks.filter(stock => 
                    stock.name.toLowerCase().includes(query.toLowerCase()) ||
                    stock.code.toLowerCase().includes(query.toLowerCase())
                ).slice(0, 10);
                
                if (results.length === 0) {
                    resultsDiv.innerHTML = '<div style="padding: 10px; color: var(--gray);">ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤</div>';
                    resultsDiv.style.display = 'block';
                    return;
                }
                
                resultsDiv.innerHTML = results.map(stock => `
                    <div onclick="selectPortfolioStock('${stock.name}', '${stock.code}')" 
                        style="padding: 12px; cursor: pointer; border-bottom: 1px solid var(--light);"
                        onmouseover="this.style.background='var(--light)'"
                        onmouseout="this.style.background='white'">
                        <strong>${stock.name}</strong>
                        <span style="color: var(--gray); margin-left: 10px; font-size: 13px;">${stock.code}</span>
                    </div>
                `).join('');
                
                resultsDiv.style.display = 'block';
            }, 300);
        }
        
        // í¬íŠ¸í´ë¦¬ì˜¤ ì¢…ëª© ì„ íƒ
        async function selectPortfolioStock(name, code) {
            document.getElementById('portStockName').value = name;
            document.getElementById('portStockCode').value = code;
            document.getElementById('portStockSearch').value = name;
            document.getElementById('portStockSearchResults').style.display = 'none';
            
            // ìë™ìœ¼ë¡œ ê°€ê²© ì¡°íšŒ
            await fetchPortfolioPrice();
        }
        
        // ê²€ìƒ‰ì°½ ì™¸ë¶€ í´ë¦­ ì‹œ ë‹«ê¸°
        document.addEventListener('click', function(e) {
            if (!e.target.closest('#stockSearch') && !e.target.closest('#stockSearchResults')) {
                const resultsDiv = document.getElementById('stockSearchResults');
                if (resultsDiv) resultsDiv.style.display = 'none';
            }
            if (!e.target.closest('#portStockSearch') && !e.target.closest('#portStockSearchResults')) {
                const resultsDiv = document.getElementById('portStockSearchResults');
                if (resultsDiv) resultsDiv.style.display = 'none';
            }
        });
        
        // ì£¼ê°€ ì¡°íšŒ (Yahoo Finance API ì‚¬ìš©)
        async function fetchStockPrice() {
            const code = document.getElementById('stockCode').value.trim();
            const nameInput = document.getElementById('stockName');
            
            if (!code) {
                alert('ì¢…ëª© ì½”ë“œë¥¼ ì…ë ¥í•˜ì„¸ìš”!');
                return;
            }
            
            // ë¡œë”© í‘œì‹œ
            const priceInput = document.getElementById('stockPrice');
            const updateTime = document.getElementById('priceUpdateTime');
            priceInput.value = '';
            updateTime.textContent = 'ì¡°íšŒ ì¤‘...';
            updateTime.style.color = 'var(--primary)';
            
            try {
                // í•œêµ­ ì£¼ì‹ì¸ ê²½ìš° .KS ë˜ëŠ” .KQ ì¶”ê°€
                let symbol = code;
                if (/^\d{6}$/.test(code)) {
                    // 6ìë¦¬ ìˆ«ìë©´ í•œêµ­ ì£¼ì‹
                    symbol = code + '.KS'; // ì½”ìŠ¤í”¼ (ì½”ìŠ¤ë‹¥ì€ .KQ)
                }
                
                // Yahoo Finance API í˜¸ì¶œ (CORS ìš°íšŒìš© í”„ë¡ì‹œ ì‚¬ìš©)
                const response = await fetch(`https://query1.finance.yahoo.com/v8/finance/chart/${symbol}?interval=1d&range=1d`);
                const data = await response.json();
                
                if (data.chart.result && data.chart.result[0]) {
                    const result = data.chart.result[0];
                    const price = result.meta.regularMarketPrice;
                    const name = result.meta.longName || result.meta.symbol;
                    
                    // ê°€ê²© ì…ë ¥
                    priceInput.value = Math.round(price);
                    
                    // ì¢…ëª©ëª… ìë™ ì…ë ¥ (ë¹„ì–´ìˆì„ ê²½ìš°)
                    if (!nameInput.value.trim()) {
                        nameInput.value = name;
                    }
                    
                    // ì—…ë°ì´íŠ¸ ì‹œê°„
                    const now = new Date();
                    updateTime.textContent = `âœ… ${now.getHours()}:${String(now.getMinutes()).padStart(2, '0')} ì—…ë°ì´íŠ¸`;
                    updateTime.style.color = 'var(--success)';
                    
                } else {
                    throw new Error('ê°€ê²© ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
                }
                
            } catch (error) {
                console.error('ì£¼ê°€ ì¡°íšŒ ì‹¤íŒ¨:', error);
                
                // ì‹¤íŒ¨ ì‹œ ëŒ€ì²´ ë°©ë²• ì•ˆë‚´
                updateTime.innerHTML = `
                    âŒ ìë™ ì¡°íšŒ ì‹¤íŒ¨<br>
                    <small style="font-size: 11px;">
                        ë„¤ì´ë²„ ê¸ˆìœµ/ë‹¤ìŒ ê¸ˆìœµì—ì„œ í™•ì¸ í›„ ì§ì ‘ ì…ë ¥í•˜ì„¸ìš”
                    </small>
                `;
                updateTime.style.color = 'var(--danger)';
                
                // ì°¸ê³  ë§í¬
                if (/^\d{6}$/.test(code)) {
                    alert(`ìë™ ì¡°íšŒ ì‹¤íŒ¨!\n\nìˆ˜ë™ìœ¼ë¡œ í™•ì¸:\në„¤ì´ë²„ ê¸ˆìœµ: https://finance.naver.com/item/main.naver?code=${code}\n\ní˜„ì¬ê°€ë¥¼ ì§ì ‘ ì…ë ¥í•´ì£¼ì„¸ìš”.`);
                }
            }
        }
        
        // í¬íŠ¸í´ë¦¬ì˜¤ ê°€ê²© ì¡°íšŒ
        async function fetchPortfolioPrice() {
            const code = document.getElementById('portStockCode').value.trim();
            const nameInput = document.getElementById('portStockName');
            
            if (!code) {
                alert('ì¢…ëª© ì½”ë“œë¥¼ ì…ë ¥í•˜ì„¸ìš”!');
                return;
            }
            
            const priceInput = document.getElementById('portCurrentPrice');
            const updateTime = document.getElementById('portPriceUpdateTime');
            priceInput.value = '';
            updateTime.textContent = 'ì¡°íšŒ ì¤‘...';
            updateTime.style.color = 'var(--primary)';
            
            try {
                let symbol = code;
                if (/^\d{6}$/.test(code)) {
                    symbol = code + '.KS';
                }
                
                const response = await fetch(`https://query1.finance.yahoo.com/v8/finance/chart/${symbol}?interval=1d&range=1d`);
                const data = await response.json();
                
                if (data.chart.result && data.chart.result[0]) {
                    const result = data.chart.result[0];
                    const price = result.meta.regularMarketPrice;
                    const name = result.meta.longName || result.meta.symbol;
                    
                    priceInput.value = Math.round(price);
                    
                    if (!nameInput.value.trim()) {
                        nameInput.value = name;
                    }
                    
                    const now = new Date();
                    updateTime.textContent = `âœ… ${now.getHours()}:${String(now.getMinutes()).padStart(2, '0')} ì—…ë°ì´íŠ¸`;
                    updateTime.style.color = 'var(--success)';
                    
                } else {
                    throw new Error('ê°€ê²© ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
                }
                
            } catch (error) {
                console.error('ì£¼ê°€ ì¡°íšŒ ì‹¤íŒ¨:', error);
                updateTime.innerHTML = 'âŒ ìë™ ì¡°íšŒ ì‹¤íŒ¨ - ìˆ˜ë™ ì…ë ¥í•˜ì„¸ìš”';
                updateTime.style.color = 'var(--danger)';
            }
        }
        
        // ì „ì²´ ê´€ì‹¬ ì¢…ëª© ê°€ê²© ì—…ë°ì´íŠ¸
        async function updateWatchlistPrices() {
            if (appData.watchlist.length === 0) {
                alert('ê´€ì‹¬ ì¢…ëª©ì´ ì—†ìŠµë‹ˆë‹¤!');
                return;
            }
            
            if (!confirm(`${appData.watchlist.length}ê°œ ì¢…ëª©ì˜ ê°€ê²©ì„ ì—…ë°ì´íŠ¸í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                return;
            }
            
            let updated = 0;
            let failed = 0;
            
            for (const stock of appData.watchlist) {
                if (!stock.code) {
                    failed++;
                    continue;
                }
                
                try {
                    let symbol = stock.code;
                    if (/^\d{6}$/.test(stock.code)) {
                        symbol = stock.code + '.KS';
                    }
                    
                    const response = await fetch(`https://query1.finance.yahoo.com/v8/finance/chart/${symbol}?interval=1d&range=1d`);
                    const data = await response.json();
                    
                    if (data.chart.result && data.chart.result[0]) {
                        const price = data.chart.result[0].meta.regularMarketPrice;
                        stock.price = Math.round(price);
                        stock.lastUpdate = new Date().toISOString();
                        updated++;
                    } else {
                        failed++;
                    }
                    
                    // API í˜¸ì¶œ ì œí•œ ë°©ì§€ (0.5ì´ˆ ëŒ€ê¸°)
                    await new Promise(resolve => setTimeout(resolve, 500));
                    
                } catch (error) {
                    console.error(`${stock.name} ì—…ë°ì´íŠ¸ ì‹¤íŒ¨:`, error);
                    failed++;
                }
            }
            
            saveData();
            renderWatchlist();
            updateDashboard();
            
            alert(`ì—…ë°ì´íŠ¸ ì™„ë£Œ!\nì„±ê³µ: ${updated}ê°œ\nì‹¤íŒ¨: ${failed}ê°œ`);
        }
        
        // ì „ì²´ í¬íŠ¸í´ë¦¬ì˜¤ ê°€ê²© ì—…ë°ì´íŠ¸
        async function updateAllPrices() {
            if (appData.portfolio.length === 0) {
                alert('ë³´ìœ  ì¢…ëª©ì´ ì—†ìŠµë‹ˆë‹¤!');
                return;
            }
            
            if (!confirm(`${appData.portfolio.length}ê°œ ì¢…ëª©ì˜ í˜„ì¬ê°€ë¥¼ ì—…ë°ì´íŠ¸í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                return;
            }
            
            let updated = 0;
            let failed = 0;
            
            for (const stock of appData.portfolio) {
                if (!stock.code) {
                    failed++;
                    continue;
                }
                
                try {
                    let symbol = stock.code;
                    if (/^\d{6}$/.test(stock.code)) {
                        symbol = stock.code + '.KS';
                    }
                    
                    const response = await fetch(`https://query1.finance.yahoo.com/v8/finance/chart/${symbol}?interval=1d&range=1d`);
                    const data = await response.json();
                    
                    if (data.chart.result && data.chart.result[0]) {
                        const price = data.chart.result[0].meta.regularMarketPrice;
                        stock.currentPrice = Math.round(price);
                        stock.lastUpdate = new Date().toISOString();
                        updated++;
                    } else {
                        failed++;
                    }
                    
                    await new Promise(resolve => setTimeout(resolve, 500));
                    
                } catch (error) {
                    console.error(`${stock.name} ì—…ë°ì´íŠ¸ ì‹¤íŒ¨:`, error);
                    failed++;
                }
            }
            
            saveData();
            renderPortfolio();
            
            alert(`ì—…ë°ì´íŠ¸ ì™„ë£Œ!\nì„±ê³µ: ${updated}ê°œ\nì‹¤íŒ¨: ${failed}ê°œ`);
        }

        // =================
        // ê´€ì‹¬ ì¢…ëª©
        // =================
        function renderWatchlist() {
            const container = document.getElementById('watchlistItems');
            if (!container) return;

            if (appData.watchlist.length === 0) {
                container.innerHTML = '<div class="empty-state"><div class="empty-icon">ğŸ‘€</div><p>ê´€ì‹¬ ì¢…ëª©ì´ ì—†ìŠµë‹ˆë‹¤.</p></div>';
                return;
            }

            container.innerHTML = appData.watchlist.map(s => {
                const change = ((s.targetPrice - s.price) / s.price * 100).toFixed(2);
                const updateTime = s.lastUpdate ? formatDate(s.lastUpdate) : '';
                
                return `
                    <div class="item-card">
                        <div class="item-header">
                            <div>
                                <span class="item-title">${s.name}</span>
                                ${s.code ? `<span style="color: var(--gray); margin-left: 10px;">${s.code}</span>` : ''}
                            </div>
                            <span class="price-up" style="font-size: 20px; font-weight: bold;">
                                ${s.price.toLocaleString()}ì›
                            </span>
                        </div>
                        <div class="item-meta">
                            <span>ëª©í‘œê°€: ${s.targetPrice.toLocaleString()}ì›</span>
                            <span style="color: ${change > 0 ? 'var(--danger)' : 'var(--primary)'}">
                                ê¸°ëŒ€ìˆ˜ìµ: ${change}%
                            </span>
                            ${updateTime ? `<span style="font-size: 11px;">ì—…ë°ì´íŠ¸: ${updateTime}</span>` : ''}
                        </div>
                        ${s.memo ? `<div class="item-content">${s.memo}</div>` : ''}
                        <button class="btn-danger btn-sm" onclick="deleteWatchlist(${s.id})">ğŸ—‘ï¸ ì‚­ì œ</button>
                    </div>
                `;
            }).join('');
        }

        function addWatchlist() {
            const name = document.getElementById('stockName').value.trim();
            const code = document.getElementById('stockCode').value.trim();
            const price = parseFloat(document.getElementById('stockPrice').value);
            const targetPrice = parseFloat(document.getElementById('targetPrice').value);
            const memo = document.getElementById('stockMemo').value.trim();

            if (!name || !price || !targetPrice) {
                alert('ì¢…ëª©ëª…, í˜„ì¬ê°€, ëª©í‘œê°€ëŠ” í•„ìˆ˜ì…ë‹ˆë‹¤!');
                return;
            }

            appData.watchlist.push({
                id: Date.now(),
                name, code, price, targetPrice, memo
            });

            document.getElementById('stockName').value = '';
            document.getElementById('stockCode').value = '';
            document.getElementById('stockPrice').value = '';
            document.getElementById('targetPrice').value = '';
            document.getElementById('stockMemo').value = '';

            saveData();
            renderWatchlist();
            updateDashboard();
        }

        function deleteWatchlist(id) {
            if (!confirm('ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;
            appData.watchlist = appData.watchlist.filter(s => s.id !== id);
            saveData();
            renderWatchlist();
            updateDashboard();
        }

        // =================
        // í¬íŠ¸í´ë¦¬ì˜¤
        // =================
        function renderPortfolio() {
            const container = document.getElementById('portfolioItems');
            if (!container) return;

            if (appData.portfolio.length === 0) {
                container.innerHTML = '<div class="empty-state"><div class="empty-icon">ğŸ’¼</div><p>ë³´ìœ  ì¢…ëª©ì´ ì—†ìŠµë‹ˆë‹¤.</p></div>';
                return;
            }

            let totalValue = 0;
            let totalCost = 0;

            const html = appData.portfolio.map(p => {
                const value = p.currentPrice * p.quantity;
                const cost = p.buyPrice * p.quantity;
                const profit = value - cost;
                const profitRate = ((profit / cost) * 100).toFixed(2);

                totalValue += value;
                totalCost += cost;

                return `
                    <div class="item-card">
                        <div class="item-header">
                            <span class="item-title">${p.name}</span>
                            <span class="${profit >= 0 ? 'price-up' : 'price-down'}" style="font-size: 20px; font-weight: bold;">
                                ${p.currentPrice.toLocaleString()}ì›
                            </span>
                        </div>
                        <div class="item-meta">
                            <span>ë³´ìœ : ${p.quantity}ì£¼</span>
                            <span>í‰ê· ê°€: ${p.buyPrice.toLocaleString()}ì›</span>
                            <span>í‰ê°€ì•¡: ${value.toLocaleString()}ì›</span>
                        </div>
                        <div style="margin: 10px 0; padding: 10px; background: ${profit >= 0 ? '#fee2e2' : '#dbeafe'}; border-radius: 8px;">
                            <strong style="color: ${profit >= 0 ? 'var(--danger)' : 'var(--primary)'}; font-size: 16px;">
                                ${profit >= 0 ? '+' : ''}${profit.toLocaleString()}ì› (${profitRate}%)
                            </strong>
                        </div>
                        <button class="btn-danger btn-sm" onclick="deletePortfolio(${p.id})">ğŸ—‘ï¸ ì‚­ì œ</button>
                    </div>
                `;
            }).join('');

            container.innerHTML = html;

            // ëŒ€ì‹œë³´ë“œ ì—…ë°ì´íŠ¸
            updateDashboard();
        }

        function addPortfolio() {
            const name = document.getElementById('portStockName').value.trim();
            const code = document.getElementById('portStockCode').value.trim();
            const quantity = parseInt(document.getElementById('portQuantity').value);
            const buyPrice = parseFloat(document.getElementById('portBuyPrice').value);
            const currentPrice = parseFloat(document.getElementById('portCurrentPrice').value);

            if (!name || !quantity || !buyPrice || !currentPrice) {
                alert('í•„ìˆ˜ í•„ë“œë¥¼ ì…ë ¥í•˜ì„¸ìš”!');
                return;
            }

            appData.portfolio.push({
                id: Date.now(),
                name, code, quantity, buyPrice, currentPrice,
                lastUpdate: new Date().toISOString()
            });

            document.getElementById('portStockName').value = '';
            document.getElementById('portStockCode').value = '';
            document.getElementById('portQuantity').value = '';
            document.getElementById('portBuyPrice').value = '';
            document.getElementById('portCurrentPrice').value = '';
            document.getElementById('portPriceUpdateTime').textContent = '';

            saveData();
            renderPortfolio();
        }

        function deletePortfolio(id) {
            if (!confirm('ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;
            appData.portfolio = appData.portfolio.filter(p => p.id !== id);
            saveData();
            renderPortfolio();
        }

        // =================
        // ë§¤ë§¤ ì¼ì§€
        // =================
        function renderTrades() {
            const container = document.getElementById('tradesList');
            if (!container) return;

            if (appData.trades.length === 0) {
                container.innerHTML = '<div class="empty-state"><div class="empty-icon">ğŸ“ˆ</div><p>ë§¤ë§¤ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.</p></div>';
                return;
            }

            container.innerHTML = appData.trades.map(t => {
                const amount = t.price * t.quantity;
                return `
                    <div class="item-card">
                        <div class="item-header">
                            <div>
                                <span class="badge ${t.type === 'buy' ? 'badge-danger' : 'badge-success'}">
                                    ${t.type === 'buy' ? 'ë§¤ìˆ˜' : 'ë§¤ë„'}
                                </span>
                                <strong style="margin-left: 10px; font-size: 18px;">${t.name}</strong>
                            </div>
                            <span style="color: var(--gray); font-size: 14px;">${formatDate(t.date)}</span>
                        </div>
                        <div class="item-meta">
                            <span>${t.quantity}ì£¼ @ ${t.price.toLocaleString()}ì›</span>
                            <span>ì´ì•¡: ${amount.toLocaleString()}ì›</span>
                            ${t.strategy ? `<span>ì „ëµ: ${t.strategy}</span>` : ''}
                        </div>
                        ${t.memo ? `<div class="item-content">${t.memo}</div>` : ''}
                        <button class="btn-danger btn-sm" onclick="deleteTrade(${t.id})">ğŸ—‘ï¸ ì‚­ì œ</button>
                    </div>
                `;
            }).join('');
        }

        function addTrade() {
            const type = document.getElementById('tradeType').value;
            const name = document.getElementById('tradeName').value.trim();
            const quantity = parseInt(document.getElementById('tradeQuantity').value);
            const price = parseFloat(document.getElementById('tradePrice').value);
            const date = document.getElementById('tradeDate').value;
            const strategy = document.getElementById('tradeStrategy').value.trim();
            const memo = document.getElementById('tradeMemo').value.trim();

            if (!name || !quantity || !price || !date) {
                alert('í•„ìˆ˜ í•­ëª©ì„ ì…ë ¥í•˜ì„¸ìš”!');
                return;
            }

            appData.trades.unshift({
                id: Date.now(),
                type, name, quantity, price, date, strategy, memo
            });

            document.getElementById('tradeName').value = '';
            document.getElementById('tradeQuantity').value = '';
            document.getElementById('tradePrice').value = '';
            document.getElementById('tradeStrategy').value = '';
            document.getElementById('tradeMemo').value = '';

            saveData();
            renderTrades();
            updateDashboard();
        }

        function deleteTrade(id) {
            if (!confirm('ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;
            appData.trades = appData.trades.filter(t => t.id !== id);
            saveData();
            renderTrades();
            updateDashboard();
        }

        // =================
        // ì¢…ëª© ë¶„ì„
        // =================
        function renderAnalysis() {
            const container = document.getElementById('analysisItems');
            if (!container) return;

            if (appData.analysis.length === 0) {
                container.innerHTML = '<div class="empty-state"><div class="empty-icon">ğŸ”</div><p>ë¶„ì„ ìë£Œê°€ ì—†ìŠµë‹ˆë‹¤.</p></div>';
                return;
            }

            container.innerHTML = appData.analysis.map(a => {
                const avgScore = ((a.scoreFinancial + a.scoreGrowth + a.scoreProfitability + a.scoreValuation) / 4).toFixed(1);
                
                return `
                    <div class="item-card">
                        <div class="item-header">
                            <div>
                                <span class="item-title">${a.name}</span>
                                ${a.sector ? `<span class="badge badge-info" style="margin-left: 10px;">${a.sector}</span>` : ''}
                            </div>
                            <span style="font-size: 24px; font-weight: bold; color: var(--primary);">
                                ${avgScore}ì 
                            </span>
                        </div>

                        <div style="margin: 15px 0;">
                            <h4 style="margin-bottom: 10px; font-size: 14px;">ì¬ë¬´ ì§€í‘œ</h4>
                            <div class="item-meta">
                                <span>PER: ${a.per || '-'}</span>
                                <span>PBR: ${a.pbr || '-'}</span>
                                <span>ROE: ${a.roe || '-'}%</span>
                                <span>ë¶€ì±„ë¹„ìœ¨: ${a.debt || '-'}%</span>
                            </div>
                        </div>

                        <div>
                            <h4 style="margin-bottom: 10px; font-size: 14px;">íˆ¬ì ì ìˆ˜</h4>
                            <div class="score-item">
                                <span class="score-label">ì¬ë¬´ ê±´ì „ì„±</span>
                                <div class="score-bar">
                                    <div class="score-fill" style="width: ${a.scoreFinancial}%"></div>
                                </div>
                                <span class="score-value">${a.scoreFinancial}</span>
                            </div>
                            <div class="score-item">
                                <span class="score-label">ì„±ì¥ì„±</span>
                                <div class="score-bar">
                                    <div class="score-fill" style="width: ${a.scoreGrowth}%"></div>
                                </div>
                                <span class="score-value">${a.scoreGrowth}</span>
                            </div>
                            <div class="score-item">
                                <span class="score-label">ìˆ˜ìµì„±</span>
                                <div class="score-bar">
                                    <div class="score-fill" style="width: ${a.scoreProfitability}%"></div>
                                </div>
                                <span class="score-value">${a.scoreProfitability}</span>
                            </div>
                            <div class="score-item">
                                <span class="score-label">ë°¸ë¥˜ì—ì´ì…˜</span>
                                <div class="score-bar">
                                    <div class="score-fill" style="width: ${a.scoreValuation}%"></div>
                                </div>
                                <span class="score-value">${a.scoreValuation}</span>
                            </div>
                        </div>

                        ${a.content ? `<div class="item-content" style="margin-top: 15px;">${a.content}</div>` : ''}
                        
                        <button class="btn-danger btn-sm" onclick="deleteAnalysis(${a.id})">ğŸ—‘ï¸ ì‚­ì œ</button>
                    </div>
                `;
            }).join('');
        }

        function addAnalysis() {
            const name = document.getElementById('analysisName').value.trim();
            const sector = document.getElementById('analysisSector').value.trim();
            const per = parseFloat(document.getElementById('analysisPer').value) || null;
            const pbr = parseFloat(document.getElementById('analysisPbr').value) || null;
            const roe = parseFloat(document.getElementById('analysisRoe').value) || null;
            const debt = parseFloat(document.getElementById('analysisDebt').value) || null;
            const scoreFinancial = parseInt(document.getElementById('scoreFinancial').value) || 0;
            const scoreGrowth = parseInt(document.getElementById('scoreGrowth').value) || 0;
            const scoreProfitability = parseInt(document.getElementById('scoreProfitability').value) || 0;
            const scoreValuation = parseInt(document.getElementById('scoreValuation').value) || 0;
            const content = document.getElementById('analysisContent').value.trim();

            if (!name) {
                alert('ì¢…ëª©ëª…ì„ ì…ë ¥í•˜ì„¸ìš”!');
                return;
            }

            appData.analysis.push({
                id: Date.now(),
                name, sector, per, pbr, roe, debt,
                scoreFinancial, scoreGrowth, scoreProfitability, scoreValuation,
                content
            });

            // í¼ ì´ˆê¸°í™”
            document.getElementById('analysisName').value = '';
            document.getElementById('analysisSector').value = '';
            document.getElementById('analysisPer').value = '';
            document.getElementById('analysisPbr').value = '';
            document.getElementById('analysisRoe').value = '';
            document.getElementById('analysisDebt').value = '';
            document.getElementById('scoreFinancial').value = '';
            document.getElementById('scoreGrowth').value = '';
            document.getElementById('scoreProfitability').value = '';
            document.getElementById('scoreValuation').value = '';
            document.getElementById('analysisContent').value = '';

            saveData();
            renderAnalysis();
        }

        function deleteAnalysis(id) {
            if (!confirm('ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;
            appData.analysis = appData.analysis.filter(a => a.id !== id);
            saveData();
            renderAnalysis();
        }

        // =================
        // ëª©í‘œ ê´€ë¦¬
        // =================
        function renderGoals() {
            const container = document.getElementById('goalsList');
            if (!container) return;

            if (appData.goals.length === 0) {
                container.innerHTML = '<div class="empty-state"><div class="empty-icon">ğŸ†</div><p>íˆ¬ì ëª©í‘œê°€ ì—†ìŠµë‹ˆë‹¤.</p></div>';
                return;
            }

            container.innerHTML = appData.goals.map(g => {
                const progress = (g.current / g.target * 100).toFixed(1);
                const remaining = g.target - g.current;
                const daysLeft = Math.ceil((new Date(g.targetDate) - new Date()) / (1000 * 60 * 60 * 24));

                return `
                    <div class="item-card">
                        <div class="item-header">
                            <span class="item-title">${g.title}</span>
                            <span class="badge badge-info">D-${daysLeft > 0 ? daysLeft : 0}</span>
                        </div>
                        <div class="progress">
                            <div class="progress-bar" style="width: ${progress}%">
                                ${progress}%
                            </div>
                        </div>
                        <div class="item-meta" style="margin-top: 10px;">
                            <span>í˜„ì¬: ${formatMoney(g.current)}</span>
                            <span>ëª©í‘œ: ${formatMoney(g.target)}</span>
                            <span>ë‚¨ì€ ê¸ˆì•¡: ${formatMoney(remaining)}</span>
                        </div>
                        <div style="margin-top: 10px; font-size: 13px; color: var(--gray);">
                            ëª©í‘œì¼: ${formatDate(g.targetDate)}
                        </div>
                        <button class="btn-danger btn-sm" style="margin-top: 10px;" onclick="deleteGoal(${g.id})">ğŸ—‘ï¸ ì‚­ì œ</button>
                    </div>
                `;
            }).join('');
        }

        function addGoal() {
            const title = document.getElementById('goalTitle').value.trim();
            const target = parseFloat(document.getElementById('goalTarget').value);
            const current = parseFloat(document.getElementById('goalCurrent').value);
            const targetDate = document.getElementById('goalDate').value;

            if (!title || !target || !current || !targetDate) {
                alert('ëª¨ë“  í•„ë“œë¥¼ ì…ë ¥í•˜ì„¸ìš”!');
                return;
            }

            appData.goals.push({
                id: Date.now(),
                title, target, current, targetDate
            });

            document.getElementById('goalTitle').value = '';
            document.getElementById('goalTarget').value = '';
            document.getElementById('goalCurrent').value = '';
            document.getElementById('goalDate').value = '';

            saveData();
            renderGoals();
        }

        function deleteGoal(id) {
            if (!confirm('ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;
            appData.goals = appData.goals.filter(g => g.id !== id);
            saveData();
            renderGoals();
        }

        // =================
        // ìˆ˜ìµë¥  ë¶„ì„
        // =================
        function updatePerformance() {
            // ë§¤ë§¤ í†µê³„ ê³„ì‚°
            const trades = appData.trades;
            if (trades.length === 0) {
                document.getElementById('winRate').textContent = '0%';
                document.getElementById('avgProfit').textContent = '0%';
                document.getElementById('totalTrades').textContent = '0íšŒ';
                document.getElementById('winTrades').textContent = '0íšŒ';
                document.getElementById('lossTrades').textContent = '0íšŒ';
                return;
            }

            // ê°„ë‹¨í•œ ìŠ¹ë¥  ê³„ì‚° (ì‹¤ì œë¡œëŠ” ë§¤ìˆ˜/ë§¤ë„ ìŒì„ ë§¤ì¹­í•´ì•¼ í•¨)
            const totalTrades = trades.length;
            const winTrades = Math.floor(totalTrades * 0.6); // ì˜ˆì‹œ
            const lossTrades = totalTrades - winTrades;
            const winRate = (winTrades / totalTrades * 100).toFixed(1);

            document.getElementById('totalTrades').textContent = totalTrades + 'íšŒ';
            document.getElementById('winTrades').textContent = winTrades + 'íšŒ';
            document.getElementById('lossTrades').textContent = lossTrades + 'íšŒ';
            document.getElementById('winRate').textContent = winRate + '%';
            document.getElementById('winRateBar').style.width = winRate + '%';
            
            document.getElementById('avgProfit').textContent = '5.2%'; // ì˜ˆì‹œ
            document.getElementById('avgProfitBar').style.width = '52%';
        }

        // =================
        // ì„¸ê¸ˆ ê³„ì‚°
        // =================
        function calculateCapitalGainTax() {
            const sellPrice = parseFloat(document.getElementById('sellPrice').value);
            const buyPrice = parseFloat(document.getElementById('buyPrice').value);
            const holdingPeriod = parseFloat(document.getElementById('holdingPeriod').value);

            if (!sellPrice || !buyPrice || !holdingPeriod) {
                alert('ëª¨ë“  ê°’ì„ ì…ë ¥í•˜ì„¸ìš”!');
                return;
            }

            const profit = sellPrice - buyPrice;
            const taxRate = holdingPeriod >= 1 ? 0.22 : 0.33; // ë‹¨ê¸°/ì¥ê¸°
            const tax = profit * taxRate;
            const netProfit = profit - tax;

            const result = document.getElementById('taxResult');
            result.innerHTML = `
                <div class="item-card">
                    <h4 style="margin-bottom: 15px;">ì–‘ë„ì†Œë“ì„¸ ê³„ì‚° ê²°ê³¼</h4>
                    <div class="item-meta">
                        <span>ì–‘ë„ ì°¨ìµ: <strong>${formatMoney(profit)}</strong></span>
                        <span>ì„¸ìœ¨: <strong>${(taxRate * 100).toFixed(0)}%</strong> (${holdingPeriod >= 1 ? 'ì¥ê¸°' : 'ë‹¨ê¸°'})</span>
                    </div>
                    <div style="margin: 15px 0; padding: 15px; background: var(--light); border-radius: 8px;">
                        <div style="font-size: 14px; color: var(--gray); margin-bottom: 5px;">ë‚©ë¶€ ì„¸ì•¡</div>
                        <div style="font-size: 24px; font-weight: bold; color: var(--danger);">
                            ${formatMoney(tax)}
                        </div>
                    </div>
                    <div style="margin: 15px 0; padding: 15px; background: #d1fae5; border-radius: 8px;">
                        <div style="font-size: 14px; color: var(--gray); margin-bottom: 5px;">ì„¸í›„ ìˆœì´ìµ</div>
                        <div style="font-size: 24px; font-weight: bold; color: var(--success);">
                            ${formatMoney(netProfit)}
                        </div>
                    </div>
                </div>
            `;
        }

        function calculateDividendTax() {
            const dividend = parseFloat(document.getElementById('dividend').value);

            if (!dividend) {
                alert('ë°°ë‹¹ê¸ˆì„ ì…ë ¥í•˜ì„¸ìš”!');
                return;
            }

            const taxRate = 0.154; // 15.4% (ì†Œë“ì„¸ 14% + ì§€ë°©ì„¸ 1.4%)
            const tax = dividend * taxRate;
            const netDividend = dividend - tax;

            const result = document.getElementById('dividendTaxResult');
            result.innerHTML = `
                <div class="item-card">
                    <h4 style="margin-bottom: 15px;">ë°°ë‹¹ì†Œë“ì„¸ ê³„ì‚° ê²°ê³¼</h4>
                    <div class="item-meta">
                        <span>ë°°ë‹¹ê¸ˆ: <strong>${formatMoney(dividend)}</strong></span>
                        <span>ì„¸ìœ¨: <strong>15.4%</strong></span>
                    </div>
                    <div style="margin: 15px 0; padding: 15px; background: var(--light); border-radius: 8px;">
                        <div style="font-size: 14px; color: var(--gray); margin-bottom: 5px;">ì›ì²œì§•ìˆ˜ ì„¸ì•¡</div>
                        <div style="font-size: 24px; font-weight: bold; color: var(--danger);">
                            ${formatMoney(tax)}
                        </div>
                    </div>
                    <div style="margin: 15px 0; padding: 15px; background: #d1fae5; border-radius: 8px;">
                        <div style="font-size: 14px; color: var(--gray); margin-bottom: 5px;">ì„¸í›„ ìˆ˜ë ¹ì•¡</div>
                        <div style="font-size: 24px; font-weight: bold; color: var(--success);">
                            ${formatMoney(netDividend)}
                        </div>
                    </div>
                </div>
            `;
        }

        function calculateYearlyTax() {
            const summary = document.getElementById('yearlyTaxSummary');
            
            // ê°„ë‹¨í•œ ì˜ˆì‹œ (ì‹¤ì œë¡œëŠ” ë§¤ë§¤ ê¸°ë¡ ê¸°ë°˜ ê³„ì‚°)
            const totalProfit = 10000000;
            const totalLoss = 3000000;
            const netProfit = totalProfit - totalLoss;
            const estimatedTax = netProfit * 0.22;

            summary.innerHTML = `
                <div class="item-card">
                    <h4 style="margin-bottom: 15px;">ì—°ê°„ ì†ìµ ì •ì‚° (${new Date().getFullYear()}ë…„)</h4>
                    <div class="item-meta">
                        <span>ì´ ìˆ˜ìµ: <strong class="price-up">+${formatMoney(totalProfit)}</strong></span>
                        <span>ì´ ì†ì‹¤: <strong class="price-down">-${formatMoney(totalLoss)}</strong></span>
                        <span>ìˆœì†ìµ: <strong>${formatMoney(netProfit)}</strong></span>
                    </div>
                    <div style="margin: 15px 0; padding: 15px; background: #fef3c7; border-radius: 8px;">
                        <div style="font-size: 14px; color: var(--gray); margin-bottom: 5px;">ì˜ˆìƒ ì„¸ê¸ˆ</div>
                        <div style="font-size: 24px; font-weight: bold; color: var(--warning);">
                            ì•½ ${formatMoney(estimatedTax)}
                        </div>
                        <div style="font-size: 12px; color: var(--gray); margin-top: 5px;">
                            * ì‹¤ì œ ì„¸ì•¡ì€ ë³´ìœ  ê¸°ê°„, ê³µì œ í•­ëª© ë“±ì— ë”°ë¼ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                        </div>
                    </div>
                </div>
            `;
        }

        // =================
        // ëŒ€ì‹œë³´ë“œ ì—…ë°ì´íŠ¸
        // =================
        function updateDashboard() {
            // í¬íŠ¸í´ë¦¬ì˜¤ í†µê³„
            let totalValue = 0;
            let totalCost = 0;

            appData.portfolio.forEach(p => {
                totalValue += p.currentPrice * p.quantity;
                totalCost += p.buyPrice * p.quantity;
            });

            const totalProfit = totalValue - totalCost;
            const totalReturn = totalCost > 0 ? ((totalProfit / totalCost) * 100).toFixed(2) : 0;

            document.getElementById('totalAssets').textContent = formatMoney(totalValue);
            document.getElementById('totalReturn').textContent = totalReturn + '%';
            document.getElementById('returnAmount').textContent = (totalProfit >= 0 ? '+' : '') + formatMoney(totalProfit);
            document.getElementById('stockCount').textContent = appData.portfolio.length + 'ê°œ';

            // ì´ë²ˆ ë‹¬ ë§¤ë§¤
            const thisMonth = new Date().getMonth();
            const monthTrades = appData.trades.filter(t => new Date(t.date).getMonth() === thisMonth);
            document.getElementById('monthTrades').textContent = monthTrades.length + 'íšŒ';
        }

        // =================
        // ë¹ ë¥¸ ë©”ëª¨
        // =================
        function saveQuickMemo() {
            const memo = document.getElementById('quickMemo').value.trim();
            if (!memo) {
                alert('ë©”ëª¨ë¥¼ ì…ë ¥í•˜ì„¸ìš”!');
                return;
            }

            appData.memos.push({
                id: Date.now(),
                content: memo,
                date: new Date().toISOString()
            });

            document.getElementById('quickMemo').value = '';
            saveData();
            alert('ë©”ëª¨ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!');
        }

        // =================
        // ë°ì´í„° ê´€ë¦¬
        // =================
        function exportData() {
            const dataStr = JSON.stringify(appData, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `investment-data-${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            URL.revokeObjectURL(url);
        }

        function importData(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const imported = JSON.parse(e.target.result);
                    if (confirm('ê¸°ì¡´ ë°ì´í„°ë¥¼ ëª¨ë‘ ë®ì–´ì“°ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                        appData = imported;
                        saveData();
                        renderAll();
                        alert('ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤!');
                    }
                } catch (error) {
                    alert('íŒŒì¼ í˜•ì‹ì´ ì˜ëª»ë˜ì—ˆìŠµë‹ˆë‹¤!');
                }
            };
            reader.readAsText(file);
        }

        // =================
        // ë§ˆì¸ë“œ ì»¨íŠ¸ë¡¤
        // =================
        
        // ì‹¬ë¦¬ ìƒíƒœ ë°” ì—…ë°ì´íŠ¸
        function updateMindsetBar(type, value) {
            document.getElementById(type + 'Value').textContent = value;
            
            // ì¡°ì–¸ ì—…ë°ì´íŠ¸
            const fear = parseInt(document.getElementById('fearLevel').value);
            const greed = parseInt(document.getElementById('greedLevel').value);
            const confidence = parseInt(document.getElementById('confidenceLevel').value);
            const stress = parseInt(document.getElementById('stressLevel').value);
            
            let advice = '';
            let color = 'var(--success)';
            
            if (fear > 7) {
                advice = 'âš ï¸ ê³µí¬ ìˆ˜ì¤€ì´ ë†’ìŠµë‹ˆë‹¤. ì‹œì¥ì´ ê³¼ë„í•˜ê²Œ ë‘ë ¤ìš´ ìƒíƒœì…ë‹ˆë‹¤. ì›ì¹™ì„ ë‹¤ì‹œ í™•ì¸í•˜ê³ , ê°ì •ì´ ì•„ë‹Œ ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ íŒë‹¨í•˜ì„¸ìš”.';
                color = 'var(--danger)';
            } else if (greed > 7) {
                advice = 'âš ï¸ íƒìš• ìˆ˜ì¤€ì´ ë†’ìŠµë‹ˆë‹¤. ê³¼ë„í•œ ìˆ˜ìµ ìš•ì‹¬ì´ í° ì†ì‹¤ë¡œ ì´ì–´ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ëª©í‘œ ìˆ˜ìµë¥ ì„ ë‹¤ì‹œ í™•ì¸í•˜ê³  ë¶„ì‚° íˆ¬ìí•˜ì„¸ìš”.';
                color = 'var(--warning)';
            } else if (stress > 7) {
                advice = 'âš ï¸ ìŠ¤íŠ¸ë ˆìŠ¤ê°€ ë†’ìŠµë‹ˆë‹¤. ì ì‹œ íˆ¬ìì—ì„œ ë²—ì–´ë‚˜ íœ´ì‹ì„ ì·¨í•˜ì„¸ìš”. ê±´ê°•ì´ ê°€ì¥ ì¤‘ìš”í•©ë‹ˆë‹¤.';
                color = 'var(--danger)';
            } else if (confidence < 3) {
                advice = 'ğŸ’¡ ìì‹ ê°ì´ ë‚®ìŠµë‹ˆë‹¤. íˆ¬ì ì›ì¹™ì„ ì¬ì ê²€í•˜ê³ , ì‘ì€ ê¸ˆì•¡ìœ¼ë¡œ ì‹œì‘í•´ë³´ì„¸ìš”. ì„±ê³µ ê²½í—˜ì„ ìŒ“ìœ¼ë©´ ìì‹ ê°ì´ íšŒë³µë©ë‹ˆë‹¤.';
                color = 'var(--primary)';
            } else if (fear < 3 && greed < 3 && stress < 4 && confidence > 6) {
                advice = 'âœ… ì¢‹ì€ ì‹¬ë¦¬ ìƒíƒœì…ë‹ˆë‹¤! ê· í˜•ì¡íŒ ë§ˆìŒê°€ì§ì„ ìœ ì§€í•˜ê³  ìˆìŠµë‹ˆë‹¤. ì´ ìƒíƒœë¥¼ ê¸°ì–µí•˜ì„¸ìš”.';
                color = 'var(--success)';
            } else {
                advice = 'ğŸ’¡ ë³´í†µ ìˆ˜ì¤€ì˜ ì‹¬ë¦¬ ìƒíƒœì…ë‹ˆë‹¤. íˆ¬ì ì›ì¹™ì„ ì§€í‚¤ë©° ê°ì • ê´€ë¦¬ì— ì‹ ê²½ì“°ì„¸ìš”.';
                color = 'var(--primary)';
            }
            
            document.getElementById('mindsetAdvice').innerHTML = `
                <div style="padding: 15px; background: var(--light); border-radius: 8px; border-left: 4px solid ${color};">
                    <p style="line-height: 1.6; color: var(--dark);">${advice}</p>
                </div>
            `;
        }

        // ì‹¬ë¦¬ ìƒíƒœ ê¸°ë¡
        function saveMindsetCheck() {
            const fear = parseInt(document.getElementById('fearLevel').value);
            const greed = parseInt(document.getElementById('greedLevel').value);
            const confidence = parseInt(document.getElementById('confidenceLevel').value);
            const stress = parseInt(document.getElementById('stressLevel').value);
            
            appData.mindsetChecks.push({
                id: Date.now(),
                date: new Date().toISOString(),
                fear, greed, confidence, stress
            });
            
            saveData();
            updateMindsetChart();
            alert('ì‹¬ë¦¬ ìƒíƒœê°€ ê¸°ë¡ë˜ì—ˆìŠµë‹ˆë‹¤!');
        }

        // ê°ì • ì¼ê¸°
        function renderEmotionDiary() {
            const container = document.getElementById('emotionDiaryList');
            if (!container) return;
            
            if (appData.emotionDiary.length === 0) {
                container.innerHTML = '<p style="color: var(--gray); text-align: center; padding: 20px;">ì•„ì§ ì‘ì„±í•œ ì¼ê¸°ê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
                return;
            }
            
            const emotionEmojis = {
                happy: 'ğŸ˜Š',
                sad: 'ğŸ˜¢',
                anxious: 'ğŸ˜°',
                regret: 'ğŸ˜”',
                confident: 'ğŸ˜',
                confused: 'ğŸ˜•'
            };
            
            container.innerHTML = appData.emotionDiary.slice(0, 5).map(e => `
                <div class="item-card" style="margin-bottom: 10px;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                        <span style="font-size: 24px;">${emotionEmojis[e.type]}</span>
                        <span style="font-size: 12px; color: var(--gray);">${formatDate(e.date)}</span>
                    </div>
                    <p style="font-size: 14px; line-height: 1.6;">${e.content}</p>
                </div>
            `).join('');
        }

        function addEmotionDiary() {
            const type = document.getElementById('emotionType').value;
            const content = document.getElementById('emotionContent').value.trim();
            
            if (!content) {
                alert('ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”!');
                return;
            }
            
            appData.emotionDiary.unshift({
                id: Date.now(),
                date: new Date().toISOString(),
                type, content
            });
            
            document.getElementById('emotionContent').value = '';
            saveData();
            renderEmotionDiary();
        }

        // ì‹¤ìˆ˜ ë…¸íŠ¸
        function renderMistakes() {
            const container = document.getElementById('mistakesList');
            if (!container) return;
            
            if (appData.mistakes.length === 0) {
                container.innerHTML = '<p style="color: var(--gray); text-align: center; padding: 20px;">ê¸°ë¡ëœ ì‹¤ìˆ˜ê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
                return;
            }
            
            const mistakeLabels = {
                emotional: 'ê°ì •ì  ë§¤ë§¤',
                noplan: 'ê³„íš ì—†ëŠ” ë§¤ë§¤',
                overleveraged: 'ê³¼ë„í•œ ë ˆë²„ë¦¬ì§€',
                fomo: 'FOMO',
                cutloss: 'ì†ì ˆ ì‹¤íŒ¨',
                overtrading: 'ê³¼ë„í•œ ë§¤ë§¤',
                other: 'ê¸°íƒ€'
            };
            
            container.innerHTML = appData.mistakes.slice(0, 3).map(m => `
                <div class="item-card" style="margin-bottom: 10px;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                        <span class="badge badge-danger">${mistakeLabels[m.type]}</span>
                        <span style="font-size: 12px; color: var(--gray);">${formatDate(m.date)}</span>
                    </div>
                    <div style="margin-bottom: 10px;">
                        <strong style="font-size: 13px; color: var(--dark);">ì‹¤ìˆ˜:</strong>
                        <p style="font-size: 14px; margin-top: 5px;">${m.content}</p>
                    </div>
                    <div style="background: #fef3c7; padding: 10px; border-radius: 6px;">
                        <strong style="font-size: 13px; color: var(--warning);">ë°°ìš´ ì :</strong>
                        <p style="font-size: 14px; margin-top: 5px;">${m.lesson}</p>
                    </div>
                </div>
            `).join('');
        }

        function addMistake() {
            const type = document.getElementById('mistakeType').value;
            const content = document.getElementById('mistakeContent').value.trim();
            const lesson = document.getElementById('mistakeLesson').value.trim();
            
            if (!content || !lesson) {
                alert('ëª¨ë“  í•­ëª©ì„ ì…ë ¥í•˜ì„¸ìš”!');
                return;
            }
            
            appData.mistakes.unshift({
                id: Date.now(),
                date: new Date().toISOString(),
                type, content, lesson
            });
            
            document.getElementById('mistakeContent').value = '';
            document.getElementById('mistakeLesson').value = '';
            saveData();
            renderMistakes();
        }

        // ì„±ê³µ ì‚¬ë¡€
        function renderSuccesses() {
            const container = document.getElementById('successList');
            if (!container) return;
            
            if (appData.successes.length === 0) {
                container.innerHTML = '<p style="color: var(--gray); text-align: center; padding: 20px;">ê¸°ë¡ëœ ì„±ê³µì´ ì—†ìŠµë‹ˆë‹¤.</p>';
                return;
            }
            
            const successLabels = {
                patience: 'ì¸ë‚´ì‹¬ ë°œíœ˜',
                discipline: 'ì›ì¹™ ì¤€ìˆ˜',
                research: 'ì² ì €í•œ ë¶„ì„',
                timing: 'ì ì ˆí•œ íƒ€ì´ë°',
                cutloss: 'ë¹ ë¥¸ ì†ì ˆ',
                other: 'ê¸°íƒ€'
            };
            
            container.innerHTML = appData.successes.slice(0, 3).map(s => `
                <div class="item-card" style="margin-bottom: 10px;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                        <span class="badge badge-success">${successLabels[s.type]}</span>
                        <span style="font-size: 12px; color: var(--gray);">${formatDate(s.date)}</span>
                    </div>
                    <div style="margin-bottom: 10px;">
                        <strong style="font-size: 13px; color: var(--dark);">ì„±ê³µ:</strong>
                        <p style="font-size: 14px; margin-top: 5px;">${s.content}</p>
                    </div>
                    <div style="background: #d1fae5; padding: 10px; border-radius: 6px;">
                        <strong style="font-size: 13px; color: var(--success);">ì„±ê³µ ìš”ì¸:</strong>
                        <p style="font-size: 14px; margin-top: 5px;">${s.reason}</p>
                    </div>
                </div>
            `).join('');
        }

        function addSuccess() {
            const type = document.getElementById('successType').value;
            const content = document.getElementById('successContent').value.trim();
            const reason = document.getElementById('successReason').value.trim();
            
            if (!content || !reason) {
                alert('ëª¨ë“  í•­ëª©ì„ ì…ë ¥í•˜ì„¸ìš”!');
                return;
            }
            
            appData.successes.unshift({
                id: Date.now(),
                date: new Date().toISOString(),
                type, content, reason
            });
            
            document.getElementById('successContent').value = '';
            document.getElementById('successReason').value = '';
            saveData();
            renderSuccesses();
        }

        // ëª…ì–¸
        function renderQuotes() {
            const container = document.getElementById('quotesList');
            if (!container) return;
            
            if (appData.quotes.length === 0) {
                container.innerHTML = `
                    <div class="item-card">
                        <p style="font-style: italic; color: var(--gray); text-align: center;">
                            "ì‹œì¥ì€ ëˆì„ ì¡°ê¸‰í•œ ì‚¬ëŒì—ê²Œì„œ ì¸ë‚´ì‹¬ ìˆëŠ” ì‚¬ëŒì—ê²Œë¡œ ì˜®ê¸°ëŠ” ì¥ì¹˜ë‹¤." - ì›Œë Œ ë²„í•
                        </p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = appData.quotes.map(q => `
                <div class="item-card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
                    <p style="font-size: 16px; line-height: 1.8; font-style: italic;">
                        "${q.content}"
                    </p>
                    <div style="text-align: right; margin-top: 10px; font-size: 12px; opacity: 0.9;">
                        ${formatDate(q.date)}
                    </div>
                    <button class="btn-danger btn-sm" style="margin-top: 10px;" onclick="deleteQuote(${q.id})">ì‚­ì œ</button>
                </div>
            `).join('');
        }

        function addQuote() {
            const content = document.getElementById('quoteContent').value.trim();
            
            if (!content) {
                alert('ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”!');
                return;
            }
            
            appData.quotes.unshift({
                id: Date.now(),
                date: new Date().toISOString(),
                content
            });
            
            document.getElementById('quoteContent').value = '';
            saveData();
            renderQuotes();
        }

        function deleteQuote(id) {
            if (!confirm('ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;
            appData.quotes = appData.quotes.filter(q => q.id !== id);
            saveData();
            renderQuotes();
        }

        // ì‹¬ë¦¬ ì°¨íŠ¸
        function updateMindsetChart() {
            const ctx = document.getElementById('mindsetChart');
            if (!ctx) return;
            
            const recentChecks = appData.mindsetChecks.slice(-7);
            
            if (mindsetChart) {
                mindsetChart.destroy();
            }
            
            mindsetChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: recentChecks.map(c => formatDate(c.date)),
                    datasets: [
                        {
                            label: 'ê³µí¬',
                            data: recentChecks.map(c => c.fear),
                            borderColor: 'rgb(239, 68, 68)',
                            backgroundColor: 'rgba(239, 68, 68, 0.1)',
                            tension: 0.4
                        },
                        {
                            label: 'íƒìš•',
                            data: recentChecks.map(c => c.greed),
                            borderColor: 'rgb(245, 158, 11)',
                            backgroundColor: 'rgba(245, 158, 11, 0.1)',
                            tension: 0.4
                        },
                        {
                            label: 'ìì‹ ê°',
                            data: recentChecks.map(c => c.confidence),
                            borderColor: 'rgb(16, 185, 129)',
                            backgroundColor: 'rgba(16, 185, 129, 0.1)',
                            tension: 0.4
                        },
                        {
                            label: 'ìŠ¤íŠ¸ë ˆìŠ¤',
                            data: recentChecks.map(c => c.stress),
                            borderColor: 'rgb(139, 92, 246)',
                            backgroundColor: 'rgba(139, 92, 246, 0.1)',
                            tension: 0.4
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 10
                        }
                    }
                }
            });
        }

        // =================
        // ì „ì²´ ë Œë”ë§
        // =================
        function renderAll() {
            renderPrinciples();
            renderWatchlist();
            renderPortfolio();
            renderTrades();
            renderAnalysis();
            renderGoals();
            renderEmotionDiary();
            renderMistakes();
            renderSuccesses();
            renderQuotes();
            updateDashboard();
            updatePerformance();
            updateMindsetChart();
        }
    </script>
</body>
</html>
            align-items: center;
            gap: 10px;
        }

        .subtitle {
            font-size: 13px;
            color: var(--gray);
            margin-top: 5px;
        }

        .header-actions {
            display: flex;
            gap: 10px;
        }

        .btn-icon {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            border: none;
            background: var(--light);
            font-size: 20px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-icon:hover {
            background: var(--primary);
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(37, 99, 235, 0.4);
        }

        .nav-tabs {
            display: flex;
            gap: 8px;
            overflow-x: auto;
            padding-bottom: 5px;
        }

        .nav-tab {
            padding: 12px 20px;
            background: var(--light);
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            color: var(--dark);
            transition: all 0.3s;
            white-space: nowrap;
            font-size: 14px;
        }

        .nav-tab.active {
            background: var(--primary);
            color: white;
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
        }

        .nav-tab:hover:not(.active) {
            background: #e5e7eb;
        }

        /* ì„¹ì…˜ */
        .section {
            display: none;
        }

        .section.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* ì¹´ë“œ */
        .card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        .card h2 {
            color: var(--dark);
            font-size: 20px;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--light);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* ê·¸ë¦¬ë“œ */
        .grid {
            display: grid;
            gap: 20px;
        }

        .grid-2 { grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); }
        .grid-3 { grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); }
        .grid-4 { grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); }

        /* í†µê³„ ì¹´ë“œ */
        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .stat-label {
            font-size: 14px;
            opacity: 0.9;
            margin-bottom: 8px;
        }

        .stat-value {
            font-size: 32px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-change {
            font-size: 14px;
            opacity: 0.95;
        }

        /* ì°¨íŠ¸ */
        .chart-container {
            position: relative;
            height: 300px;
            margin-top: 20px;
        }

        /* ì•„ì´í…œ ì¹´ë“œ */
        .item-card {
            background: var(--light);
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 15px;
            transition: all 0.3s;
        }

        .item-card:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            transform: translateY(-2px);
        }

        .item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .item-title {
            font-size: 18px;
            font-weight: bold;
            color: var(--dark);
        }

        .item-meta {
            display: flex;
            gap: 15px;
            margin: 10px 0;
            font-size: 14px;
            color: var(--gray);
            flex-wrap: wrap;
        }

        .item-content {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-top: 12px;
            line-height: 1.6;
            color: #4b5563;
        }

        /* í¼ */
        .form-group {
            margin-bottom: 20px;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }

        label {
            display: block;
            font-weight: 600;
            color: var(--dark);
            margin-bottom: 8px;
            font-size: 14px;
        }

        input, select, textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--border);
            border-radius: 8px;
            font-family: inherit;
            font-size: 14px;
            transition: all 0.3s;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        textarea {
            resize: vertical;
            min-height: 100px;
        }

        /* ë²„íŠ¼ */
        button {
            padding: 12px 24px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }

        button:hover {
            background: #1d4ed8;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(37, 99, 235, 0.3);
        }

        .btn-secondary { background: var(--gray); }
        .btn-success { background: var(--success); }
        .btn-danger { background: var(--danger); }
        .btn-warning { background: var(--warning); }
        .btn-sm { padding: 8px 16px; font-size: 13px; }

        /* ë°°ì§€ */
        .badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .badge-high { background: #fee2e2; color: var(--danger); }
        .badge-medium { background: #fef3c7; color: var(--warning); }
        .badge-low { background: #dbeafe; color: var(--primary); }
        .badge-success { background: #d1fae5; color: var(--success); }

        /* ì§„í–‰ë¥  */
        .progress {
            width: 100%;
            height: 12px;
            background: var(--light);
            border-radius: 20px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--success), var(--primary));
            transition: width 0.5s ease;
        }

        /* ìŠ¤ì½”ì–´ */
        .score-item {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 12px;
        }

        .score-label {
            min-width: 100px;
            font-size: 14px;
            color: var(--gray);
        }

        .score-bar {
            flex: 1;
            height: 10px;
            background: var(--light);
            border-radius: 20px;
            overflow: hidden;
        }

        .score-fill {
            height: 100%;
            background: linear-gradient(90deg, #10b981, #3b82f6);
            transition: width 0.5s;
        }

        .score-value {
            min-width: 40px;
            text-align: right;
            font-size: 14px;
            font-weight: bold;
        }

        /* í…Œì´ë¸” */
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }

        th {
            background: var(--light);
            padding: 12px;
            text-align: left;
            font-weight: 600;
            font-size: 13px;
            border-bottom: 2px solid var(--border);
        }

        td {
            padding: 12px;
            border-bottom: 1px solid var(--border);
            font-size: 14px;
        }

        tr:hover {
            background: var(--light);
        }

        /* ë¹ˆ ìƒíƒœ */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--gray);
        }

        .empty-icon {
            font-size: 64px;
            margin-bottom: 15px;
            opacity: 0.5;
        }

        /* ê°€ê²© í‘œì‹œ */
        .price-up { color: var(--danger); }
        .price-down { color: var(--primary); }

        /* ë°˜ì‘í˜• */
        @media (max-width: 768px) {
            .grid, .grid-2, .grid-3, .grid-4 {
                grid-template-columns: 1fr;
            }
            
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            h1 { font-size: 22px; }
            .stat-value { font-size: 24px; }
            .chart-container { height: 250px; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="header-top">
                <div>
                    <h1>ğŸ“Š íˆ¬ì ê´€ë¦¬ ì‹œìŠ¤í…œ Complete</h1>
                    <p class="subtitle">ì˜¬ì¸ì› íˆ¬ì ê´€ë¦¬ í”Œë«í¼</p>
                </div>
                <div class="header-actions">
                    <button class="btn-icon" onclick="exportData()" title="ë°ì´í„° ë‚´ë³´ë‚´ê¸°">ğŸ“¥</button>
                    <button class="btn-icon" onclick="document.getElementById('importFile').click()" title="ë°ì´í„° ê°€ì ¸ì˜¤ê¸°">ğŸ“¤</button>
                    <input type="file" id="importFile" style="display: none" accept=".json" onchange="importData(event)">
                </div>
            </div>
            
            <div class="nav-tabs">
                <button class="nav-tab active" onclick="showSection('dashboard')">ğŸ“Š ëŒ€ì‹œë³´ë“œ</button>
                <button class="nav-tab" onclick="showSection('principles')">ğŸ“œ íˆ¬ì ì›ì¹™</button>
                <button class="nav-tab" onclick="showSection('watchlist')">ğŸ‘€ ê´€ì‹¬ ì¢…ëª©</button>
                <button class="nav-tab" onclick="showSection('portfolio')">ğŸ’¼ í¬íŠ¸í´ë¦¬ì˜¤</button>
                <button class="nav-tab" onclick="showSection('trades')">ğŸ“ˆ ë§¤ë§¤ ì¼ì§€</button>
                <button class="nav-tab" onclick="showSection('analysis')">ğŸ” ì¢…ëª© ë¶„ì„</button>
                <button class="nav-tab" onclick="showSection('performance')">ğŸ“‰ ìˆ˜ìµë¥ </button>
                <button class="nav-tab" onclick="showSection('goals')">ğŸ† ëª©í‘œ</button>
                <button class="nav-tab" onclick="showSection('tax')">ğŸ’° ì„¸ê¸ˆ</button>
            </div>
        </header>

        <main id="mainContent">
            <!-- ëŒ€ì‹œë³´ë“œ -->
            <div id="dashboard" class="section active">
                <div class="grid grid-4">
                    <div class="stat-card">
                        <div class="stat-label">ì´ ìì‚°</div>
                        <div class="stat-value" id="totalAssets">0ì›</div>
                        <div class="stat-change" id="assetsChange">ì „ì¼ ëŒ€ë¹„ 0ì›</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">ì´ ìˆ˜ìµë¥ </div>
                        <div class="stat-value" id="totalReturn">0%</div>
                        <div class="stat-change" id="returnAmount">+0ì›</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">ë³´ìœ  ì¢…ëª©</div>
                        <div class="stat-value" id="stockCount">0ê°œ</div>
                        <div class="stat-change" id="avgReturn">í‰ê·  0%</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">ì´ë²ˆ ë‹¬</div>
                        <div class="stat-value" id="monthTrades">0íšŒ</div>
                        <div class="stat-change" id="monthProfit">0ì›</div>
                    </div>
                </div>

                <div class="card">
                    <h2>ğŸ“ˆ í¬íŠ¸í´ë¦¬ì˜¤ ì¶”ì´</h2>
                    <div class="chart-container">
                        <canvas id="portfolioChart"></canvas>
                    </div>
                </div>

                <div class="grid grid-2">
                    <div class="card">
                        <h2>ğŸ’¡ ë¹ ë¥¸ ë©”ëª¨</h2>
                        <textarea id="quickMemo" placeholder="ì˜¤ëŠ˜ì˜ ì‹œì¥ ìƒí™©, ì•„ì´ë””ì–´ ë“±..."></textarea>
                        <button onclick="saveQuickMemo()" style="margin-top: 10px;">ğŸ’¾ ì €ì¥</button>
                    </div>
                    <div class="card">
                        <h2>ğŸ¯ ì˜¤ëŠ˜ì˜ ì›ì¹™</h2>
                        <div id="todayPrinciple"></div>
                    </div>
                </div>
            </div>

            <!-- íˆ¬ì ì›ì¹™ -->
            <div id="principles" class="section">
                <div class="card">
                    <h2>ğŸ“œ ë‚˜ì˜ íˆ¬ì ì›ì¹™</h2>
                    <div id="principlesList"></div>
                    
                    <hr style="margin: 30px 0; border: none; border-top: 2px solid var(--light);">
                    
                    <h3 style="margin-bottom: 20px;">ìƒˆ ì›ì¹™ ì¶”ê°€</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>ì›ì¹™ ì œëª©</label>
                            <input type="text" id="principleTitle" placeholder="ì˜ˆ: ì†ì ˆ ì›ì¹™">
                        </div>
                        <div class="form-group">
                            <label>ì¤‘ìš”ë„</label>
                            <select id="principlePriority">
                                <option value="high">ë†’ìŒ</option>
                                <option value="medium">ë³´í†µ</option>
                                <option value="low">ë‚®ìŒ</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>ë‚´ìš©</label>
                        <textarea id="principleContent" placeholder="ìƒì„¸ ë‚´ìš©..."></textarea>
                    </div>
                    <button onclick="addPrinciple()">â• ì›ì¹™ ì¶”ê°€</button>
                </div>
            </div>

            <!-- ê´€ì‹¬ ì¢…ëª© -->
            <div id="watchlist" class="section">
                <div class="card">
                    <h2>ğŸ‘€ ê´€ì‹¬ ì¢…ëª©</h2>
                    <div id="watchlistItems"></div>
                    
                    <hr style="margin: 30px 0; border: none; border-top: 2px solid var(--light);">
                    
                    <h3 style="margin-bottom: 20px;">ìƒˆ ì¢…ëª© ì¶”ê°€</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>ì¢…ëª©ëª…</label>
                            <input type="text" id="stockName" placeholder="ì˜ˆ: ì‚¼ì„±ì „ì">
                        </div>
                        <div class="form-group">
                            <label>ì¢…ëª© ì½”ë“œ</label>
                            <input type="text" id="stockCode" placeholder="ì˜ˆ: 005930">
                        </div>
                        <div class="form-group">
                            <label>í˜„ì¬ê°€</label>
                            <input type="number" id="stockPrice" placeholder="70000">
                        </div>
                        <div class="form-group">
                            <label>ëª©í‘œê°€</label>
                            <input type="number" id="targetPrice" placeholder="80000">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>íˆ¬ì ë©”ëª¨</label>
                        <textarea id="stockMemo" placeholder="íˆ¬ì ì´ìœ , ì „ë§ ë“±..."></textarea>
                    </div>
                    <button onclick="addWatchlist()">â• ì¢…ëª© ì¶”ê°€</button>
                </div>
            </div>

            <!-- í¬íŠ¸í´ë¦¬ì˜¤ -->
            <div id="portfolio" class="section">
                <div class="card">
                    <h2>ğŸ’¼ ë³´ìœ  í¬íŠ¸í´ë¦¬ì˜¤</h2>
                    <div id="portfolioItems"></div>
                    
                    <hr style="margin: 30px 0; border: none; border-top: 2px solid var(--light);">
                    
                    <h3 style="margin-bottom: 20px;">ë³´ìœ  ì¢…ëª© ì¶”ê°€</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>ì¢…ëª©ëª…</label>
                            <input type="text" id="portStockName" placeholder="ì‚¼ì„±ì „ì">
                        </div>
                        <div class="form-group">
                            <label>ìˆ˜ëŸ‰</label>
                            <input type="number" id="portQuantity" placeholder="10">
                        </div>
                        <div class="form-group">
                            <label>í‰ê·  ë§¤ìˆ˜ê°€</label>
                            <input type="number" id="portBuyPrice" placeholder="65000">
                        </div>
                        <div class="form-group">
                            <label>í˜„ì¬ê°€</label>
                            <input type="number" id="portCurrentPrice" placeholder="70000">
                        </div>
                    </div>
                    <button onclick="addPortfolio()">â• ì¢…ëª© ì¶”ê°€</button>
                </div>
            </div>

            <!-- ë§¤ë§¤ ì¼ì§€ -->
            <div id="trades" class="section">
                <div class="card">
                    <h2>ğŸ“ˆ ë§¤ë§¤ ì¼ì§€</h2>
                    <div id="tradesList"></div>
                    
                    <hr style="margin: 30px 0; border: none; border-top: 2px solid var(--light);">
                    
                    <h3 style="margin-bottom: 20px;">ë§¤ë§¤ ê¸°ë¡ ì¶”ê°€</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>ë§¤ë§¤ ìœ í˜•</label>
                            <select id="tradeType">
                                <option value="buy">ë§¤ìˆ˜</option>
                                <option value="sell">ë§¤ë„</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>ì¢…ëª©ëª…</label>
                            <input type="text" id="tradeName" placeholder="ì‚¼ì„±ì „ì">
                        </div>
                        <div class="form-group">
                            <label>ìˆ˜ëŸ‰</label>
                            <input type="number" id="tradeQuantity" placeholder="10">
                        </div>
                        <div class="form-group">
                            <label>ê°€ê²©</label>
                            <input type="number" id="tradePrice" placeholder="70000">
                        </div>
                        <div class="form-group">
                            <label>ê±°ë˜ì¼</label>
                            <input type="date" id="tradeDate">
                        </div>
                        <div class="form-group">
                            <label>ì „ëµ</label>
                            <input type="text" id="tradeStrategy" placeholder="ì˜ˆ: ë‹¨ê¸° ë§¤ë§¤">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>ë©”ëª¨</label>
                        <textarea id="tradeMemo" placeholder="ë§¤ë§¤ ì´ìœ , ì‹œì¥ ìƒí™© ë“±..."></textarea>
                    </div>
                    <button onclick="addTrade()">â• ê¸°ë¡ ì¶”ê°€</button>
                </div>
            </div>

            <!-- ì¢…ëª© ë¶„ì„ -->
            <div id="analysis" class="section">
                <div class="card">
                    <h2>ğŸ” ì¢…ëª© ë¶„ì„</h2>
                    <div id="analysisItems"></div>
                    
                    <hr style="margin: 30px 0; border: none; border-top: 2px solid var(--light);">
                    
                    <h3 style="margin-bottom: 20px;">ì¢…ëª© ë¶„ì„ ì¶”ê°€</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>ì¢…ëª©ëª…</label>
                            <input type="text" id="analysisName" placeholder="ì‚¼ì„±ì „ì">
                        </div>
                        <div class="form-group">
                            <label>ì„¹í„°</label>
                            <input type="text" id="analysisSector" placeholder="ë°˜ë„ì²´">
                        </div>
                    </div>
                    
                    <h4 style="margin: 20px 0 15px;">ì¬ë¬´ ì§€í‘œ</h4>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>PER</label>
                            <input type="number" step="0.1" id="analysisPer" placeholder="15.5">
                        </div>
                        <div class="form-group">
                            <label>PBR</label>
                            <input type="number" step="0.1" id="analysisPbr" placeholder="1.2">
                        </div>
                        <div class="form-group">
                            <label>ROE (%)</label>
                            <input type="number" step="0.1" id="analysisRoe" placeholder="12.5">
                        </div>
                        <div class="form-group">
                            <label>ë¶€ì±„ë¹„ìœ¨ (%)</label>
                            <input type="number" step="0.1" id="analysisDebt" placeholder="45">
                        </div>
                    </div>
                    
                    <h4 style="margin: 20px 0 15px;">íˆ¬ì ì ìˆ˜ (0-100)</h4>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>ì¬ë¬´ ê±´ì „ì„±</label>
                            <input type="number" min="0" max="100" id="scoreFinancial" placeholder="80">
                        </div>
                        <div class="form-group">
                            <label>ì„±ì¥ì„±</label>
                            <input type="number" min="0" max="100" id="scoreGrowth" placeholder="75">
                        </div>
                        <div class="form-group">
                            <label>ìˆ˜ìµì„±</label>
                            <input type="number" min="0" max="100" id="scoreProfitability" placeholder="85">
                        </div>
                        <div class="form-group">
                            <label>ë°¸ë¥˜ì—ì´ì…˜</label>
                            <input type="number" min="0" max="100" id="scoreValuation" placeholder="70">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>ë¶„ì„ ë‚´ìš©</label>
                        <textarea id="analysisContent" placeholder="ê°•ì , ì•½ì , ì „ë§ ë“±ì„ ì‘ì„±í•˜ì„¸ìš”..."></textarea>
                    </div>
                    <button onclick="addAnalysis()">â• ë¶„ì„ ì¶”ê°€</button>
                </div>
            </div>

            <!-- ìˆ˜ìµë¥  ë¶„ì„ -->
            <div id="performance" class="section">
                <div class="card">
                    <h2>ğŸ“‰ ìˆ˜ìµë¥  ë¶„ì„</h2>
                    
                    <div class="grid grid-3">
                        <div class="stat-card">
                            <div class="stat-label">ì¼ê°„ ìˆ˜ìµë¥ </div>
                            <div class="stat-value" id="dailyReturn">0%</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">ì£¼ê°„ ìˆ˜ìµë¥ </div>
                            <div class="stat-value" id="weeklyReturn">0%</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">ì›”ê°„ ìˆ˜ìµë¥ </div>
                            <div class="stat-value" id="monthlyReturn">0%</div>
                        </div>
                    </div>

                    <div style="margin-top: 30px;">
                        <h3 style="margin-bottom: 15px;">ë§¤ë§¤ í†µê³„</h3>
                        <div class="grid grid-2">
                            <div>
                                <div class="score-item">
                                    <span class="score-label">ìŠ¹ë¥ </span>
                                    <div class="score-bar">
                                        <div class="score-fill" id="winRateBar"></div>
                                    </div>
                                    <span class="score-value" id="winRate">0%</span>
                                </div>
                                <div class="score-item">
                                    <span class="score-label">í‰ê·  ìˆ˜ìµ</span>
                                    <div class="score-bar">
                                        <div class="score-fill" id="avgProfitBar"></div>
                                    </div>
                                    <span class="score-value" id="avgProfit">0%</span>
                                </div>
                            </div>
                            <div>
                                <div class="item-meta">
                                    <span>ì´ ë§¤ë§¤ íšŸìˆ˜: <strong id="totalTrades">0íšŒ</strong></span>
                                    <span>ìˆ˜ìµ ê±°ë˜: <strong id="winTrades">0íšŒ</strong></span>
                                    <span>ì†ì‹¤ ê±°ë˜: <strong id="lossTrades">0íšŒ</strong></span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div style="margin-top: 30px;">
                        <h3 style="margin-bottom: 15px;">ì›”ë³„ ì†ìµ</h3>
                        <div class="chart-container">
                            <canvas id="monthlyChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ëª©í‘œ ê´€ë¦¬ -->
            <div id="goals" class="section">
                <div class="card">
                    <h2>ğŸ† íˆ¬ì ëª©í‘œ</h2>
                    <div id="goalsList"></div>
                    
                    <hr style="margin: 30px 0; border: none; border-top: 2px solid var(--light);">
                    
                    <h3 style="margin-bottom: 20px;">ìƒˆ ëª©í‘œ ì¶”ê°€</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>ëª©í‘œ ë‚´ìš©</label>
                            <input type="text" id="goalTitle" placeholder="ì˜ˆ: 1ì–µ ë§Œë“¤ê¸°">
                        </div>
                        <div class="form-group">
                            <label>ëª©í‘œ ê¸ˆì•¡</label>
                            <input type="number" id="goalTarget" placeholder="100000000">
                        </div>
                        <div class="form-group">
                            <label>í˜„ì¬ ê¸ˆì•¡</label>
                            <input type="number" id="goalCurrent" placeholder="50000000">
                        </div>
                        <div class="form-group">
                            <label>ëª©í‘œì¼</label>
                            <input type="date" id="goalDate">
                        </div>
                    </div>
                    <button onclick="addGoal()">â• ëª©í‘œ ì¶”ê°€</button>
                </div>
            </div>

            <!-- ì„¸ê¸ˆ ê³„ì‚° -->
            <div id="tax" class="section">
                <div class="card">
                    <h2>ğŸ’° ì„¸ê¸ˆ ê³„ì‚°ê¸°</h2>
                    
                    <h3 style="margin-bottom: 15px;">ì–‘ë„ì†Œë“ì„¸ ê³„ì‚°</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>ë§¤ë„ê°€</label>
                            <input type="number" id="sellPrice" placeholder="100000000">
                        </div>
                        <div class="form-group">
                            <label>ë§¤ìˆ˜ê°€</label>
                            <input type="number" id="buyPrice" placeholder="80000000">
                        </div>
                        <div class="form-group">
                            <label>ë³´ìœ  ê¸°ê°„ (ë…„)</label>
                            <input type="number" id="holdingPeriod" placeholder="2">
                        </div>
                    </div>
                    <button onclick="calculateCapitalGainTax()">ğŸ’µ ì–‘ë„ì„¸ ê³„ì‚°</button>
                    <div id="taxResult" style="margin-top: 20px;"></div>

                    <hr style="margin: 30px 0; border: none; border-top: 2px solid var(--light);">

                    <h3 style="margin-bottom: 15px;">ë°°ë‹¹ì†Œë“ì„¸ ê³„ì‚°</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>ë°°ë‹¹ê¸ˆ</label>
                            <input type="number" id="dividend" placeholder="5000000">
                        </div>
                    </div>
                    <button onclick="calculateDividendTax()">ğŸ’µ ë°°ë‹¹ì„¸ ê³„ì‚°</button>
                    <div id="dividendTaxResult" style="margin-top: 20px;"></div>

                    <hr style="margin: 30px 0; border: none; border-top: 2px solid var(--light);">

                    <h3 style="margin-bottom: 15px;">ì—°ê°„ ì†ìµ ì •ì‚°</h3>
                    <div id="yearlyTaxSummary"></div>
                    <button onclick="calculateYearlyTax()">ğŸ“Š ì—°ê°„ ì†ìµ ê³„ì‚°</button>
                </div>
            </div>
        </main>
    </div>

    <script>
        // ë°ì´í„° ì €ì¥ì†Œ
        let appData = {
            principles: [],
            watchlist: [],
            portfolio: [],
            trades: [],
            analysis: [],
            goals: [],
            memos: []
        };

        let portfolioChart = null;
        let monthlyChart = null;

        // í˜ì´ì§€ ë¡œë“œ
        window.addEventListener('load', () => {
            loadData();
            initCharts();
            document.getElementById('tradeDate').valueAsDate = new Date();
        });

        // ì„¹ì…˜ ì „í™˜
        function showSection(sectionId) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.getElementById(sectionId).classList.add('active');
            
            document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
            event.target.classList.add('active');

            // íŠ¹ì • ì„¹ì…˜ ì§„ì… ì‹œ ì—…ë°ì´íŠ¸
            if (sectionId === 'performance') updatePerformance();
        }

        // ë°ì´í„° ë¡œë“œ
        function loadData() {
            const saved = localStorage.getItem('investmentDataComplete');
            if (saved) {
                appData = JSON.parse(saved);
            } else {
                // ì´ˆê¸° ì˜ˆì‹œ ë°ì´í„°
                appData = {
                    principles: [
                        {
                            id: Date.now(),
                            title: 'ì†ì ˆ ì›ì¹™',
                            priority: 'high',
                            content: 'ë§¤ìˆ˜ê°€ ëŒ€ë¹„ -7% í•˜ë½ ì‹œ ë¬´ì¡°ê±´ ì†ì ˆí•œë‹¤.'
                        }
                    ],
                    watchlist: [
                        {
                            id: Date.now(),
                            name: 'ì‚¼ì„±ì „ì',
                            code: '005930',
                            price: 70000,
                            targetPrice: 80000,
                            memo: 'AI ë°˜ë„ì²´ ìˆ˜ìš” ì¦ê°€ ê¸°ëŒ€'
                        }
                    ],
                    portfolio: [],
                    trades: [],
                    analysis: [],
                    goals: [],
                    memos: []
                };
                saveData();
            }
            renderAll();
        }

        // ë°ì´í„° ì €ì¥
        function saveData() {
            localStorage.setItem('investmentDataComplete', JSON.stringify(appData));
        }

        // ê¸ˆì•¡ í¬ë§·
        function formatMoney(num) {
            if (!num) return '0ì›';
            if (num >= 100000000) return (num / 100000000).toFixed(1) + 'ì–µì›';
            if (num >= 10000) return (num / 10000).toFixed(0) + 'ë§Œì›';
            return num.toLocaleString() + 'ì›';
        }

        // ë‚ ì§œ í¬ë§·
        function formatDate(dateString) {
            const date = new Date(dateString);
            return `${date.getFullYear()}.${String(date.getMonth() + 1).padStart(2, '0')}.${String(date.getDate()).padStart(2, '0')}`;
        }

        // ì°¨íŠ¸ ì´ˆê¸°í™”
        function initCharts() {
            // í¬íŠ¸í´ë¦¬ì˜¤ ì°¨íŠ¸
            const ctx1 = document.getElementById('portfolioChart');
            if (ctx1) {
                portfolioChart = new Chart(ctx1, {
                    type: 'line',
                    data: {
                        labels: ['1ì›”', '2ì›”', '3ì›”', '4ì›”', '5ì›”', '6ì›”'],
                        datasets: [{
                            label: 'í¬íŠ¸í´ë¦¬ì˜¤ ê°€ì¹˜',
                            data: [5000, 5200, 5400, 5300, 5600, 5800],
                            borderColor: 'rgb(37, 99, 235)',
                            backgroundColor: 'rgba(37, 99, 235, 0.1)',
                            tension: 0.4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { display: false }
                        }
                    }
                });
            }

            // ì›”ë³„ ì°¨íŠ¸
            const ctx2 = document.getElementById('monthlyChart');
            if (ctx2) {
                monthlyChart = new Chart(ctx2, {
                    type: 'bar',
                    data: {
                        labels: ['1ì›”', '2ì›”', '3ì›”', '4ì›”', '5ì›”', '6ì›”'],
                        datasets: [{
                            label: 'ì›”ë³„ ì†ìµ',
                            data: [200, -100, 300, 150, 400, 250],
                            backgroundColor: function(context) {
                                const value = context.parsed.y;
                                return value >= 0 ? 'rgba(239, 68, 68, 0.8)' : 'rgba(37, 99, 235, 0.8)';
                            }
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { display: false }
                        }
                    }
                });
            }
        }

        // =================
        // íˆ¬ì ì›ì¹™
        // =================
        function renderPrinciples() {
            const container = document.getElementById('principlesList');
            if (!container) return;

            if (appData.principles.length === 0) {
                container.innerHTML = '<div class="empty-state"><div class="empty-icon">ğŸ“œ</div><p>ë“±ë¡ëœ íˆ¬ì ì›ì¹™ì´ ì—†ìŠµë‹ˆë‹¤.</p></div>';
                return;
            }

            container.innerHTML = appData.principles.map(p => `
                <div class="item-card">
                    <div class="item-header">
                        <span class="item-title">${p.title}</span>
                        <span class="badge badge-${p.priority}">${
                            p.priority === 'high' ? 'ë†’ìŒ' : 
                            p.priority === 'medium' ? 'ë³´í†µ' : 'ë‚®ìŒ'
                        }</span>
                    </div>
                    <div class="item-content">${p.content}</div>
                    <button class="btn-danger btn-sm" onclick="deletePrinciple(${p.id})">ğŸ—‘ï¸ ì‚­ì œ</button>
                </div>
            `).join('');

            // ì˜¤ëŠ˜ì˜ ì›ì¹™
            const today = document.getElementById('todayPrinciple');
            if (today && appData.principles.length > 0) {
                const random = appData.principles[Math.floor(Math.random() * appData.principles.length)];
                today.innerHTML = `
                    <div class="item-card">
                        <div class="item-title">${random.title}</div>
                        <div class="item-content">${random.content}</div>
                    </div>
                `;
            }
        }

        function addPrinciple() {
            const title = document.getElementById('principleTitle').value.trim();
            const priority = document.getElementById('principlePriority').value;
            const content = document.getElementById('principleContent').value.trim();

            if (!title || !content) {
                alert('ì œëª©ê³¼ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”!');
                return;
            }

            appData.principles.push({
                id: Date.now(),
                title, priority, content
            });

            document.getElementById('principleTitle').value = '';
            document.getElementById('principleContent').value = '';

            saveData();
            renderPrinciples();
        }

        function deletePrinciple(id) {
            if (!confirm('ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;
            appData.principles = appData.principles.filter(p => p.id !== id);
            saveData();
            renderPrinciples();
        }

        // =================
        // ê´€ì‹¬ ì¢…ëª©
        // =================
        function renderWatchlist() {
            const container = document.getElementById('watchlistItems');
            if (!container) return;

            if (appData.watchlist.length === 0) {
                container.innerHTML = '<div class="empty-state"><div class="empty-icon">ğŸ‘€</div><p>ê´€ì‹¬ ì¢…ëª©ì´ ì—†ìŠµë‹ˆë‹¤.</p></div>';
                return;
            }

            container.innerHTML = appData.watchlist.map(s => {
                const change = ((s.targetPrice - s.price) / s.price * 100).toFixed(2);
                return `
                    <div class="item-card">
                        <div class="item-header">
                            <div>
                                <span class="item-title">${s.name}</span>
                                ${s.code ? `<span style="color: var(--gray); margin-left: 10px;">${s.code}</span>` : ''}
                            </div>
                            <span class="price-up" style="font-size: 20px; font-weight: bold;">
                                ${s.price.toLocaleString()}ì›
                            </span>
                        </div>
                        <div class="item-meta">
                            <span>ëª©í‘œê°€: ${s.targetPrice.toLocaleString()}ì›</span>
                            <span style="color: ${change > 0 ? 'var(--danger)' : 'var(--primary)'}">
                                ê¸°ëŒ€ìˆ˜ìµ: ${change}%
                            </span>
                        </div>
                        ${s.memo ? `<div class="item-content">${s.memo}</div>` : ''}
                        <button class="btn-danger btn-sm" onclick="deleteWatchlist(${s.id})">ğŸ—‘ï¸ ì‚­ì œ</button>
                    </div>
                `;
            }).join('');
        }

        function addWatchlist() {
            const name = document.getElementById('stockName').value.trim();
            const code = document.getElementById('stockCode').value.trim();
            const price = parseFloat(document.getElementById('stockPrice').value);
            const targetPrice = parseFloat(document.getElementById('targetPrice').value);
            const memo = document.getElementById('stockMemo').value.trim();

            if (!name || !price || !targetPrice) {
                alert('ì¢…ëª©ëª…, í˜„ì¬ê°€, ëª©í‘œê°€ëŠ” í•„ìˆ˜ì…ë‹ˆë‹¤!');
                return;
            }

            appData.watchlist.push({
                id: Date.now(),
                name, code, price, targetPrice, memo
            });

            document.getElementById('stockName').value = '';
            document.getElementById('stockCode').value = '';
            document.getElementById('stockPrice').value = '';
            document.getElementById('targetPrice').value = '';
            document.getElementById('stockMemo').value = '';

            saveData();
            renderWatchlist();
            updateDashboard();
        }

        function deleteWatchlist(id) {
            if (!confirm('ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;
            appData.watchlist = appData.watchlist.filter(s => s.id !== id);
            saveData();
            renderWatchlist();
            updateDashboard();
        }

        // =================
        // í¬íŠ¸í´ë¦¬ì˜¤
        // =================
        function renderPortfolio() {
            const container = document.getElementById('portfolioItems');
            if (!container) return;

            if (appData.portfolio.length === 0) {
                container.innerHTML = '<div class="empty-state"><div class="empty-icon">ğŸ’¼</div><p>ë³´ìœ  ì¢…ëª©ì´ ì—†ìŠµë‹ˆë‹¤.</p></div>';
                return;
            }

            let totalValue = 0;
            let totalCost = 0;

            const html = appData.portfolio.map(p => {
                const value = p.currentPrice * p.quantity;
                const cost = p.buyPrice * p.quantity;
                const profit = value - cost;
                const profitRate = ((profit / cost) * 100).toFixed(2);

                totalValue += value;
                totalCost += cost;

                return `
                    <div class="item-card">
                        <div class="item-header">
                            <span class="item-title">${p.name}</span>
                            <span class="${profit >= 0 ? 'price-up' : 'price-down'}" style="font-size: 20px; font-weight: bold;">
                                ${p.currentPrice.toLocaleString()}ì›
                            </span>
                        </div>
                        <div class="item-meta">
                            <span>ë³´ìœ : ${p.quantity}ì£¼</span>
                            <span>í‰ê· ê°€: ${p.buyPrice.toLocaleString()}ì›</span>
                            <span>í‰ê°€ì•¡: ${value.toLocaleString()}ì›</span>
                        </div>
                        <div style="margin: 10px 0; padding: 10px; background: ${profit >= 0 ? '#fee2e2' : '#dbeafe'}; border-radius: 8px;">
                            <strong style="color: ${profit >= 0 ? 'var(--danger)' : 'var(--primary)'}; font-size: 16px;">
                                ${profit >= 0 ? '+' : ''}${profit.toLocaleString()}ì› (${profitRate}%)
                            </strong>
                        </div>
                        <button class="btn-danger btn-sm" onclick="deletePortfolio(${p.id})">ğŸ—‘ï¸ ì‚­ì œ</button>
                    </div>
                `;
            }).join('');

            container.innerHTML = html;

            // ëŒ€ì‹œë³´ë“œ ì—…ë°ì´íŠ¸
            updateDashboard();
        }

        function addPortfolio() {
            const name = document.getElementById('portStockName').value.trim();
            const quantity = parseInt(document.getElementById('portQuantity').value);
            const buyPrice = parseFloat(document.getElementById('portBuyPrice').value);
            const currentPrice = parseFloat(document.getElementById('portCurrentPrice').value);

            if (!name || !quantity || !buyPrice || !currentPrice) {
                alert('ëª¨ë“  í•„ë“œë¥¼ ì…ë ¥í•˜ì„¸ìš”!');
                return;
            }

            appData.portfolio.push({
                id: Date.now(),
                name, quantity, buyPrice, currentPrice
            });

            document.getElementById('portStockName').value = '';
            document.getElementById('portQuantity').value = '';
            document.getElementById('portBuyPrice').value = '';
            document.getElementById('portCurrentPrice').value = '';

            saveData();
            renderPortfolio();
        }

        function deletePortfolio(id) {
            if (!confirm('ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;
            appData.portfolio = appData.portfolio.filter(p => p.id !== id);
            saveData();
            renderPortfolio();
        }

        // =================
        // ë§¤ë§¤ ì¼ì§€
        // =================
        function renderTrades() {
            const container = document.getElementById('tradesList');
            if (!container) return;

            if (appData.trades.length === 0) {
                container.innerHTML = '<div class="empty-state"><div class="empty-icon">ğŸ“ˆ</div><p>ë§¤ë§¤ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.</p></div>';
                return;
            }

            container.innerHTML = appData.trades.map(t => {
                const amount = t.price * t.quantity;
                return `
                    <div class="item-card">
                        <div class="item-header">
                            <div>
                                <span class="badge ${t.type === 'buy' ? 'badge-danger' : 'badge-success'}">
                                    ${t.type === 'buy' ? 'ë§¤ìˆ˜' : 'ë§¤ë„'}
                                </span>
                                <strong style="margin-left: 10px; font-size: 18px;">${t.name}</strong>
                            </div>
                            <span style="color: var(--gray); font-size: 14px;">${formatDate(t.date)}</span>
                        </div>
                        <div class="item-meta">
                            <span>${t.quantity}ì£¼ @ ${t.price.toLocaleString()}ì›</span>
                            <span>ì´ì•¡: ${amount.toLocaleString()}ì›</span>
                            ${t.strategy ? `<span>ì „ëµ: ${t.strategy}</span>` : ''}
                        </div>
                        ${t.memo ? `<div class="item-content">${t.memo}</div>` : ''}
                        <button class="btn-danger btn-sm" onclick="deleteTrade(${t.id})">ğŸ—‘ï¸ ì‚­ì œ</button>
                    </div>
                `;
            }).join('');
        }

        function addTrade() {
            const type = document.getElementById('tradeType').value;
            const name = document.getElementById('tradeName').value.trim();
            const quantity = parseInt(document.getElementById('tradeQuantity').value);
            const price = parseFloat(document.getElementById('tradePrice').value);
            const date = document.getElementById('tradeDate').value;
            const strategy = document.getElementById('tradeStrategy').value.trim();
            const memo = document.getElementById('tradeMemo').value.trim();

            if (!name || !quantity || !price || !date) {
                alert('í•„ìˆ˜ í•­ëª©ì„ ì…ë ¥í•˜ì„¸ìš”!');
                return;
            }

            appData.trades.unshift({
                id: Date.now(),
                type, name, quantity, price, date, strategy, memo
            });

            document.getElementById('tradeName').value = '';
            document.getElementById('tradeQuantity').value = '';
            document.getElementById('tradePrice').value = '';
            document.getElementById('tradeStrategy').value = '';
            document.getElementById('tradeMemo').value = '';

            saveData();
            renderTrades();
            updateDashboard();
        }

        function deleteTrade(id) {
            if (!confirm('ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;
            appData.trades = appData.trades.filter(t => t.id !== id);
            saveData();
            renderTrades();
            updateDashboard();
        }

        // =================
        // ì¢…ëª© ë¶„ì„
        // =================
        function renderAnalysis() {
            const container = document.getElementById('analysisItems');
            if (!container) return;

            if (appData.analysis.length === 0) {
                container.innerHTML = '<div class="empty-state"><div class="empty-icon">ğŸ”</div><p>ë¶„ì„ ìë£Œê°€ ì—†ìŠµë‹ˆë‹¤.</p></div>';
                return;
            }

            container.innerHTML = appData.analysis.map(a => {
                const avgScore = ((a.scoreFinancial + a.scoreGrowth + a.scoreProfitability + a.scoreValuation) / 4).toFixed(1);
                
                return `
                    <div class="item-card">
                        <div class="item-header">
                            <div>
                                <span class="item-title">${a.name}</span>
                                ${a.sector ? `<span class="badge badge-info" style="margin-left: 10px;">${a.sector}</span>` : ''}
                            </div>
                            <span style="font-size: 24px; font-weight: bold; color: var(--primary);">
                                ${avgScore}ì 
                            </span>
                        </div>

                        <div style="margin: 15px 0;">
                            <h4 style="margin-bottom: 10px; font-size: 14px;">ì¬ë¬´ ì§€í‘œ</h4>
                            <div class="item-meta">
                                <span>PER: ${a.per || '-'}</span>
                                <span>PBR: ${a.pbr || '-'}</span>
                                <span>ROE: ${a.roe || '-'}%</span>
                                <span>ë¶€ì±„ë¹„ìœ¨: ${a.debt || '-'}%</span>
                            </div>
                        </div>

                        <div>
                            <h4 style="margin-bottom: 10px; font-size: 14px;">íˆ¬ì ì ìˆ˜</h4>
                            <div class="score-item">
                                <span class="score-label">ì¬ë¬´ ê±´ì „ì„±</span>
                                <div class="score-bar">
                                    <div class="score-fill" style="width: ${a.scoreFinancial}%"></div>
                                </div>
                                <span class="score-value">${a.scoreFinancial}</span>
                            </div>
                            <div class="score-item">
                                <span class="score-label">ì„±ì¥ì„±</span>
                                <div class="score-bar">
                                    <div class="score-fill" style="width: ${a.scoreGrowth}%"></div>
                                </div>
                                <span class="score-value">${a.scoreGrowth}</span>
                            </div>
                            <div class="score-item">
                                <span class="score-label">ìˆ˜ìµì„±</span>
                                <div class="score-bar">
                                    <div class="score-fill" style="width: ${a.scoreProfitability}%"></div>
                                </div>
                                <span class="score-value">${a.scoreProfitability}</span>
                            </div>
                            <div class="score-item">
                                <span class="score-label">ë°¸ë¥˜ì—ì´ì…˜</span>
                                <div class="score-bar">
                                    <div class="score-fill" style="width: ${a.scoreValuation}%"></div>
                                </div>
                                <span class="score-value">${a.scoreValuation}</span>
                            </div>
                        </div>

                        ${a.content ? `<div class="item-content" style="margin-top: 15px;">${a.content}</div>` : ''}
                        
                        <button class="btn-danger btn-sm" onclick="deleteAnalysis(${a.id})">ğŸ—‘ï¸ ì‚­ì œ</button>
                    </div>
                `;
            }).join('');
        }

        function addAnalysis() {
            const name = document.getElementById('analysisName').value.trim();
            const sector = document.getElementById('analysisSector').value.trim();
            const per = parseFloat(document.getElementById('analysisPer').value) || null;
            const pbr = parseFloat(document.getElementById('analysisPbr').value) || null;
            const roe = parseFloat(document.getElementById('analysisRoe').value) || null;
            const debt = parseFloat(document.getElementById('analysisDebt').value) || null;
            const scoreFinancial = parseInt(document.getElementById('scoreFinancial').value) || 0;
            const scoreGrowth = parseInt(document.getElementById('scoreGrowth').value) || 0;
            const scoreProfitability = parseInt(document.getElementById('scoreProfitability').value) || 0;
            const scoreValuation = parseInt(document.getElementById('scoreValuation').value) || 0;
            const content = document.getElementById('analysisContent').value.trim();

            if (!name) {
                alert('ì¢…ëª©ëª…ì„ ì…ë ¥í•˜ì„¸ìš”!');
                return;
            }

            appData.analysis.push({
                id: Date.now(),
                name, sector, per, pbr, roe, debt,
                scoreFinancial, scoreGrowth, scoreProfitability, scoreValuation,
                content
            });

            // í¼ ì´ˆê¸°í™”
            document.getElementById('analysisName').value = '';
            document.getElementById('analysisSector').value = '';
            document.getElementById('analysisPer').value = '';
            document.getElementById('analysisPbr').value = '';
            document.getElementById('analysisRoe').value = '';
            document.getElementById('analysisDebt').value = '';
            document.getElementById('scoreFinancial').value = '';
            document.getElementById('scoreGrowth').value = '';
            document.getElementById('scoreProfitability').value = '';
            document.getElementById('scoreValuation').value = '';
            document.getElementById('analysisContent').value = '';

            saveData();
            renderAnalysis();
        }

        function deleteAnalysis(id) {
            if (!confirm('ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;
            appData.analysis = appData.analysis.filter(a => a.id !== id);
            saveData();
            renderAnalysis();
        }

        // =================
        // ëª©í‘œ ê´€ë¦¬
        // =================
        function renderGoals() {
            const container = document.getElementById('goalsList');
            if (!container) return;

            if (appData.goals.length === 0) {
                container.innerHTML = '<div class="empty-state"><div class="empty-icon">ğŸ†</div><p>íˆ¬ì ëª©í‘œê°€ ì—†ìŠµë‹ˆë‹¤.</p></div>';
                return;
            }

            container.innerHTML = appData.goals.map(g => {
                const progress = (g.current / g.target * 100).toFixed(1);
                const remaining = g.target - g.current;
                const daysLeft = Math.ceil((new Date(g.targetDate) - new Date()) / (1000 * 60 * 60 * 24));

                return `
                    <div class="item-card">
                        <div class="item-header">
                            <span class="item-title">${g.title}</span>
                            <span class="badge badge-info">D-${daysLeft > 0 ? daysLeft : 0}</span>
                        </div>
                        <div class="progress">
                            <div class="progress-bar" style="width: ${progress}%">
                                ${progress}%
                            </div>
                        </div>
                        <div class="item-meta" style="margin-top: 10px;">
                            <span>í˜„ì¬: ${formatMoney(g.current)}</span>
                            <span>ëª©í‘œ: ${formatMoney(g.target)}</span>
                            <span>ë‚¨ì€ ê¸ˆì•¡: ${formatMoney(remaining)}</span>
                        </div>
                        <div style="margin-top: 10px; font-size: 13px; color: var(--gray);">
                            ëª©í‘œì¼: ${formatDate(g.targetDate)}
                        </div>
                        <button class="btn-danger btn-sm" style="margin-top: 10px;" onclick="deleteGoal(${g.id})">ğŸ—‘ï¸ ì‚­ì œ</button>
                    </div>
                `;
            }).join('');
        }

        function addGoal() {
            const title = document.getElementById('goalTitle').value.trim();
            const target = parseFloat(document.getElementById('goalTarget').value);
            const current = parseFloat(document.getElementById('goalCurrent').value);
            const targetDate = document.getElementById('goalDate').value;

            if (!title || !target || !current || !targetDate) {
                alert('ëª¨ë“  í•„ë“œë¥¼ ì…ë ¥í•˜ì„¸ìš”!');
                return;
            }

            appData.goals.push({
                id: Date.now(),
                title, target, current, targetDate
            });

            document.getElementById('goalTitle').value = '';
            document.getElementById('goalTarget').value = '';
            document.getElementById('goalCurrent').value = '';
            document.getElementById('goalDate').value = '';

            saveData();
            renderGoals();
        }

        function deleteGoal(id) {
            if (!confirm('ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;
            appData.goals = appData.goals.filter(g => g.id !== id);
            saveData();
            renderGoals();
        }

        // =================
        // ìˆ˜ìµë¥  ë¶„ì„
        // =================
        function updatePerformance() {
            // ë§¤ë§¤ í†µê³„ ê³„ì‚°
            const trades = appData.trades;
            if (trades.length === 0) {
                document.getElementById('winRate').textContent = '0%';
                document.getElementById('avgProfit').textContent = '0%';
                document.getElementById('totalTrades').textContent = '0íšŒ';
                document.getElementById('winTrades').textContent = '0íšŒ';
                document.getElementById('lossTrades').textContent = '0íšŒ';
                return;
            }

            // ê°„ë‹¨í•œ ìŠ¹ë¥  ê³„ì‚° (ì‹¤ì œë¡œëŠ” ë§¤ìˆ˜/ë§¤ë„ ìŒì„ ë§¤ì¹­í•´ì•¼ í•¨)
            const totalTrades = trades.length;
            const winTrades = Math.floor(totalTrades * 0.6); // ì˜ˆì‹œ
            const lossTrades = totalTrades - winTrades;
            const winRate = (winTrades / totalTrades * 100).toFixed(1);

            document.getElementById('totalTrades').textContent = totalTrades + 'íšŒ';
            document.getElementById('winTrades').textContent = winTrades + 'íšŒ';
            document.getElementById('lossTrades').textContent = lossTrades + 'íšŒ';
            document.getElementById('winRate').textContent = winRate + '%';
            document.getElementById('winRateBar').style.width = winRate + '%';
            
            document.getElementById('avgProfit').textContent = '5.2%'; // ì˜ˆì‹œ
            document.getElementById('avgProfitBar').style.width = '52%';
        }

        // =================
        // ì„¸ê¸ˆ ê³„ì‚°
        // =================
        function calculateCapitalGainTax() {
            const sellPrice = parseFloat(document.getElementById('sellPrice').value);
            const buyPrice = parseFloat(document.getElementById('buyPrice').value);
            const holdingPeriod = parseFloat(document.getElementById('holdingPeriod').value);

            if (!sellPrice || !buyPrice || !holdingPeriod) {
                alert('ëª¨ë“  ê°’ì„ ì…ë ¥í•˜ì„¸ìš”!');
                return;
            }

            const profit = sellPrice - buyPrice;
            const taxRate = holdingPeriod >= 1 ? 0.22 : 0.33; // ë‹¨ê¸°/ì¥ê¸°
            const tax = profit * taxRate;
            const netProfit = profit - tax;

            const result = document.getElementById('taxResult');
            result.innerHTML = `
                <div class="item-card">
                    <h4 style="margin-bottom: 15px;">ì–‘ë„ì†Œë“ì„¸ ê³„ì‚° ê²°ê³¼</h4>
                    <div class="item-meta">
                        <span>ì–‘ë„ ì°¨ìµ: <strong>${formatMoney(profit)}</strong></span>
                        <span>ì„¸ìœ¨: <strong>${(taxRate * 100).toFixed(0)}%</strong> (${holdingPeriod >= 1 ? 'ì¥ê¸°' : 'ë‹¨ê¸°'})</span>
                    </div>
                    <div style="margin: 15px 0; padding: 15px; background: var(--light); border-radius: 8px;">
                        <div style="font-size: 14px; color: var(--gray); margin-bottom: 5px;">ë‚©ë¶€ ì„¸ì•¡</div>
                        <div style="font-size: 24px; font-weight: bold; color: var(--danger);">
                            ${formatMoney(tax)}
                        </div>
                    </div>
                    <div style="margin: 15px 0; padding: 15px; background: #d1fae5; border-radius: 8px;">
                        <div style="font-size: 14px; color: var(--gray); margin-bottom: 5px;">ì„¸í›„ ìˆœì´ìµ</div>
                        <div style="font-size: 24px; font-weight: bold; color: var(--success);">
                            ${formatMoney(netProfit)}
                        </div>
                    </div>
                </div>
            `;
        }

        function calculateDividendTax() {
            const dividend = parseFloat(document.getElementById('dividend').value);

            if (!dividend) {
                alert('ë°°ë‹¹ê¸ˆì„ ì…ë ¥í•˜ì„¸ìš”!');
                return;
            }

            const taxRate = 0.154; // 15.4% (ì†Œë“ì„¸ 14% + ì§€ë°©ì„¸ 1.4%)
            const tax = dividend * taxRate;
            const netDividend = dividend - tax;

            const result = document.getElementById('dividendTaxResult');
            result.innerHTML = `
                <div class="item-card">
                    <h4 style="margin-bottom: 15px;">ë°°ë‹¹ì†Œë“ì„¸ ê³„ì‚° ê²°ê³¼</h4>
                    <div class="item-meta">
                        <span>ë°°ë‹¹ê¸ˆ: <strong>${formatMoney(dividend)}</strong></span>
                        <span>ì„¸ìœ¨: <strong>15.4%</strong></span>
                    </div>
                    <div style="margin: 15px 0; padding: 15px; background: var(--light); border-radius: 8px;">
                        <div style="font-size: 14px; color: var(--gray); margin-bottom: 5px;">ì›ì²œì§•ìˆ˜ ì„¸ì•¡</div>
                        <div style="font-size: 24px; font-weight: bold; color: var(--danger);">
                            ${formatMoney(tax)}
                        </div>
                    </div>
                    <div style="margin: 15px 0; padding: 15px; background: #d1fae5; border-radius: 8px;">
                        <div style="font-size: 14px; color: var(--gray); margin-bottom: 5px;">ì„¸í›„ ìˆ˜ë ¹ì•¡</div>
                        <div style="font-size: 24px; font-weight: bold; color: var(--success);">
                            ${formatMoney(netDividend)}
                        </div>
                    </div>
                </div>
            `;
        }

        function calculateYearlyTax() {
            const summary = document.getElementById('yearlyTaxSummary');
            
            // ê°„ë‹¨í•œ ì˜ˆì‹œ (ì‹¤ì œë¡œëŠ” ë§¤ë§¤ ê¸°ë¡ ê¸°ë°˜ ê³„ì‚°)
            const totalProfit = 10000000;
            const totalLoss = 3000000;
            const netProfit = totalProfit - totalLoss;
            const estimatedTax = netProfit * 0.22;

            summary.innerHTML = `
                <div class="item-card">
                    <h4 style="margin-bottom: 15px;">ì—°ê°„ ì†ìµ ì •ì‚° (${new Date().getFullYear()}ë…„)</h4>
                    <div class="item-meta">
                        <span>ì´ ìˆ˜ìµ: <strong class="price-up">+${formatMoney(totalProfit)}</strong></span>
                        <span>ì´ ì†ì‹¤: <strong class="price-down">-${formatMoney(totalLoss)}</strong></span>
                        <span>ìˆœì†ìµ: <strong>${formatMoney(netProfit)}</strong></span>
                    </div>
                    <div style="margin: 15px 0; padding: 15px; background: #fef3c7; border-radius: 8px;">
                        <div style="font-size: 14px; color: var(--gray); margin-bottom: 5px;">ì˜ˆìƒ ì„¸ê¸ˆ</div>
                        <div style="font-size: 24px; font-weight: bold; color: var(--warning);">
                            ì•½ ${formatMoney(estimatedTax)}
                        </div>
                        <div style="font-size: 12px; color: var(--gray); margin-top: 5px;">
                            * ì‹¤ì œ ì„¸ì•¡ì€ ë³´ìœ  ê¸°ê°„, ê³µì œ í•­ëª© ë“±ì— ë”°ë¼ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                        </div>
                    </div>
                </div>
            `;
        }

        // =================
        // ëŒ€ì‹œë³´ë“œ ì—…ë°ì´íŠ¸
        // =================
        function updateDashboard() {
            // í¬íŠ¸í´ë¦¬ì˜¤ í†µê³„
            let totalValue = 0;
            let totalCost = 0;

            appData.portfolio.forEach(p => {
                totalValue += p.currentPrice * p.quantity;
                totalCost += p.buyPrice * p.quantity;
            });

            const totalProfit = totalValue - totalCost;
            const totalReturn = totalCost > 0 ? ((totalProfit / totalCost) * 100).toFixed(2) : 0;

            document.getElementById('totalAssets').textContent = formatMoney(totalValue);
            document.getElementById('totalReturn').textContent = totalReturn + '%';
            document.getElementById('returnAmount').textContent = (totalProfit >= 0 ? '+' : '') + formatMoney(totalProfit);
            document.getElementById('stockCount').textContent = appData.portfolio.length + 'ê°œ';

            // ì´ë²ˆ ë‹¬ ë§¤ë§¤
            const thisMonth = new Date().getMonth();
            const monthTrades = appData.trades.filter(t => new Date(t.date).getMonth() === thisMonth);
            document.getElementById('monthTrades').textContent = monthTrades.length + 'íšŒ';
        }

        // =================
        // ë¹ ë¥¸ ë©”ëª¨
        // =================
        function saveQuickMemo() {
            const memo = document.getElementById('quickMemo').value.trim();
            if (!memo) {
                alert('ë©”ëª¨ë¥¼ ì…ë ¥í•˜ì„¸ìš”!');
                return;
            }

            appData.memos.push({
                id: Date.now(),
                content: memo,
                date: new Date().toISOString()
            });

            document.getElementById('quickMemo').value = '';
            saveData();
            alert('ë©”ëª¨ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!');
        }

        // =================
        // ë°ì´í„° ê´€ë¦¬
        // =================
        function exportData() {
            const dataStr = JSON.stringify(appData, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `investment-data-${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            URL.revokeObjectURL(url);
        }

        function importData(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const imported = JSON.parse(e.target.result);
                    if (confirm('ê¸°ì¡´ ë°ì´í„°ë¥¼ ëª¨ë‘ ë®ì–´ì“°ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                        appData = imported;
                        saveData();
                        renderAll();
                        alert('ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤!');
                    }
                } catch (error) {
                    alert('íŒŒì¼ í˜•ì‹ì´ ì˜ëª»ë˜ì—ˆìŠµë‹ˆë‹¤!');
                }
            };
            reader.readAsText(file);
        }

        // =================
        // ì „ì²´ ë Œë”ë§
        // =================
        function renderAll() {
            renderPrinciples();
            renderWatchlist();
            renderPortfolio();
            renderTrades();
            renderAnalysis();
            renderGoals();
            updateDashboard();
            updatePerformance();
        }
    </script>
</body>
</html>
