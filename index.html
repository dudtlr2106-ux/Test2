<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>íˆ¬ì ê´€ë¦¬ ì‹œìŠ¤í…œ Complete</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #2563eb;
            --success: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --purple: #8b5cf6;
            --dark: #1f2937;
            --gray: #6b7280;
            --light: #f3f4f6;
            --border: #e5e7eb;
            --white: #ffffff;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 15px;
            color: var(--dark);
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
        }

        /* í—¤ë” */
        header {
            background: white;
            padding: 25px 30px;
            border-radius: 15px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }

        h1 {
            color: var(--dark);
            font-size: 28px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .subtitle {
            font-size: 13px;
            color: var(--gray);
            margin-top: 5px;
        }

        .header-actions {
            display: flex;
            gap: 10px;
        }

        .btn-icon {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            border: none;
            background: var(--light);
            font-size: 20px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-icon:hover {
            background: var(--primary);
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(37, 99, 235, 0.4);
        }

        .nav-tabs {
            display: flex;
            gap: 8px;
            overflow-x: auto;
            padding-bottom: 5px;
        }

        .nav-tab {
            padding: 12px 20px;
            background: var(--light);
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            color: var(--dark);
            transition: all 0.3s;
            white-space: nowrap;
            font-size: 14px;
        }

        .nav-tab.active {
            background: var(--primary);
            color: white;
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
        }

        .nav-tab:hover:not(.active) {
            background: #e5e7eb;
        }

        /* ì„¹ì…˜ */
        .section {
            display: none;
        }

        .section.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* ì¹´ë“œ */
        .card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        .card h2 {
            color: var(--dark);
            font-size: 20px;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--light);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* ê·¸ë¦¬ë“œ */
        .grid {
            display: grid;
            gap: 20px;
        }

        .grid-2 { grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); }
        .grid-3 { grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); }
        .grid-4 { grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); }

        /* í†µê³„ ì¹´ë“œ */
        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .stat-label {
            font-size: 14px;
            opacity: 0.9;
            margin-bottom: 8px;
        }

        .stat-value {
            font-size: 32px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-change {
            font-size: 14px;
            opacity: 0.95;
        }

        /* ì°¨íŠ¸ */
        .chart-container {
            position: relative;
            height: 300px;
            margin-top: 20px;
        }

        /* ì•„ì´í…œ ì¹´ë“œ */
        .item-card {
            background: var(--light);
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 15px;
            transition: all 0.3s;
        }

        .item-card:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            transform: translateY(-2px);
        }

        .item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .item-title {
            font-size: 18px;
            font-weight: bold;
            color: var(--dark);
        }

        .item-meta {
            display: flex;
            gap: 15px;
            margin: 10px 0;
            font-size: 14px;
            color: var(--gray);
            flex-wrap: wrap;
        }

        .item-content {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-top: 12px;
            line-height: 1.6;
            color: #4b5563;
        }

        /* í¼ */
        .form-group {
            margin-bottom: 20px;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }

        label {
            display: block;
            font-weight: 600;
            color: var(--dark);
            margin-bottom: 8px;
            font-size: 14px;
        }

        input, select, textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--border);
            border-radius: 8px;
            font-family: inherit;
            font-size: 14px;
            transition: all 0.3s;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        textarea {
            resize: vertical;
            min-height: 100px;
        }

        /* ë²„íŠ¼ */
        button {
            padding: 12px 24px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }

        button:hover {
            background: #1d4ed8;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(37, 99, 235, 0.3);
        }

        .btn-secondary { background: var(--gray); }
        .btn-success { background: var(--success); }
        .btn-danger { background: var(--danger); }
        .btn-warning { background: var(--warning); }
        .btn-sm { padding: 8px 16px; font-size: 13px; }

        /* ë°°ì§€ */
        .badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .badge-high { background: #fee2e2; color: var(--danger); }
        .badge-medium { background: #fef3c7; color: var(--warning); }
        .badge-low { background: #dbeafe; color: var(--primary); }
        .badge-success { background: #d1fae5; color: var(--success); }

        /* ì§„í–‰ë¥  */
        .progress {
            width: 100%;
            height: 12px;
            background: var(--light);
            border-radius: 20px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--success), var(--primary));
            transition: width 0.5s ease;
        }

        /* ìŠ¤ì½”ì–´ */
        .score-item {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 12px;
        }

        .score-label {
            min-width: 100px;
            font-size: 14px;
            color: var(--gray);
        }

        .score-bar {
            flex: 1;
            height: 10px;
            background: var(--light);
            border-radius: 20px;
            overflow: hidden;
        }

        .score-fill {
            height: 100%;
            background: linear-gradient(90deg, #10b981, #3b82f6);
            transition: width 0.5s;
        }

        .score-value {
            min-width: 40px;
            text-align: right;
            font-size: 14px;
            font-weight: bold;
        }

        /* í…Œì´ë¸” */
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }

        th {
            background: var(--light);
            padding: 12px;
            text-align: left;
            font-weight: 600;
            font-size: 13px;
            border-bottom: 2px solid var(--border);
        }

        td {
            padding: 12px;
            border-bottom: 1px solid var(--border);
            font-size: 14px;
        }

        tr:hover {
            background: var(--light);
        }

        /* ë¹ˆ ìƒíƒœ */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--gray);
        }

        .empty-icon {
            font-size: 64px;
            margin-bottom: 15px;
            opacity: 0.5;
        }

        /* ê°€ê²© í‘œì‹œ */
        .price-up { color: var(--danger); }
        .price-down { color: var(--primary); }

        /* ë°˜ì‘í˜• */
        @media (max-width: 768px) {
            .grid, .grid-2, .grid-3, .grid-4 {
                grid-template-columns: 1fr;
            }
            
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            h1 { font-size: 22px; }
            .stat-value { font-size: 24px; }
            .chart-container { height: 250px; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="header-top">
                <div>
                    <h1>ğŸ“Š íˆ¬ì ê´€ë¦¬ ì‹œìŠ¤í…œ Complete</h1>
                    <p class="subtitle">ì˜¬ì¸ì› íˆ¬ì ê´€ë¦¬ í”Œë«í¼</p>
                </div>
                <div class="header-actions">
                    <button class="btn-icon" onclick="exportData()" title="ë°ì´í„° ë‚´ë³´ë‚´ê¸°">ğŸ“¥</button>
                    <button class="btn-icon" onclick="document.getElementById('importFile').click()" title="ë°ì´í„° ê°€ì ¸ì˜¤ê¸°">ğŸ“¤</button>
                    <input type="file" id="importFile" style="display: none" accept=".json" onchange="importData(event)">
                </div>
            </div>
            
            <div class="nav-tabs">
                <button class="nav-tab active" onclick="showSection('dashboard')">ğŸ“Š ëŒ€ì‹œë³´ë“œ</button>
                <button class="nav-tab" onclick="showSection('principles')">ğŸ“œ íˆ¬ì ì›ì¹™</button>
                <button class="nav-tab" onclick="showSection('watchlist')">ğŸ‘€ ê´€ì‹¬ ì¢…ëª©</button>
                <button class="nav-tab" onclick="showSection('portfolio')">ğŸ’¼ í¬íŠ¸í´ë¦¬ì˜¤</button>
                <button class="nav-tab" onclick="showSection('trades')">ğŸ“ˆ ë§¤ë§¤ ì¼ì§€</button>
                <button class="nav-tab" onclick="showSection('analysis')">ğŸ” ì¢…ëª© ë¶„ì„</button>
                <button class="nav-tab" onclick="showSection('performance')">ğŸ“‰ ìˆ˜ìµë¥ </button>
                <button class="nav-tab" onclick="showSection('goals')">ğŸ† ëª©í‘œ</button>
                <button class="nav-tab" onclick="showSection('tax')">ğŸ’° ì„¸ê¸ˆ</button>
            </div>
        </header>

        <main id="mainContent">
            <!-- ëŒ€ì‹œë³´ë“œ -->
            <div id="dashboard" class="section active">
                <div class="grid grid-4">
                    <div class="stat-card">
                        <div class="stat-label">ì´ ìì‚°</div>
                        <div class="stat-value" id="totalAssets">0ì›</div>
                        <div class="stat-change" id="assetsChange">ì „ì¼ ëŒ€ë¹„ 0ì›</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">ì´ ìˆ˜ìµë¥ </div>
                        <div class="stat-value" id="totalReturn">0%</div>
                        <div class="stat-change" id="returnAmount">+0ì›</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">ë³´ìœ  ì¢…ëª©</div>
                        <div class="stat-value" id="stockCount">0ê°œ</div>
                        <div class="stat-change" id="avgReturn">í‰ê·  0%</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">ì´ë²ˆ ë‹¬</div>
                        <div class="stat-value" id="monthTrades">0íšŒ</div>
                        <div class="stat-change" id="monthProfit">0ì›</div>
                    </div>
                </div>

                <div class="card">
                    <h2>ğŸ“ˆ í¬íŠ¸í´ë¦¬ì˜¤ ì¶”ì´</h2>
                    <div class="chart-container">
                        <canvas id="portfolioChart"></canvas>
                    </div>
                </div>

                <div class="grid grid-2">
                    <div class="card">
                        <h2>ğŸ’¡ ë¹ ë¥¸ ë©”ëª¨</h2>
                        <textarea id="quickMemo" placeholder="ì˜¤ëŠ˜ì˜ ì‹œì¥ ìƒí™©, ì•„ì´ë””ì–´ ë“±..."></textarea>
                        <button onclick="saveQuickMemo()" style="margin-top: 10px;">ğŸ’¾ ì €ì¥</button>
                    </div>
                    <div class="card">
                        <h2>ğŸ¯ ì˜¤ëŠ˜ì˜ ì›ì¹™</h2>
                        <div id="todayPrinciple"></div>
                    </div>
                </div>
            </div>

            <!-- íˆ¬ì ì›ì¹™ -->
            <div id="principles" class="section">
                <div class="card">
                    <h2>ğŸ“œ ë‚˜ì˜ íˆ¬ì ì›ì¹™</h2>
                    <div id="principlesList"></div>
                    
                    <hr style="margin: 30px 0; border: none; border-top: 2px solid var(--light);">
                    
                    <h3 style="margin-bottom: 20px;">ìƒˆ ì›ì¹™ ì¶”ê°€</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>ì›ì¹™ ì œëª©</label>
                            <input type="text" id="principleTitle" placeholder="ì˜ˆ: ì†ì ˆ ì›ì¹™">
                        </div>
                        <div class="form-group">
                            <label>ì¤‘ìš”ë„</label>
                            <select id="principlePriority">
                                <option value="high">ë†’ìŒ</option>
                                <option value="medium">ë³´í†µ</option>
                                <option value="low">ë‚®ìŒ</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>ë‚´ìš©</label>
                        <textarea id="principleContent" placeholder="ìƒì„¸ ë‚´ìš©..."></textarea>
                    </div>
                    <button onclick="addPrinciple()">â• ì›ì¹™ ì¶”ê°€</button>
                </div>
            </div>

            <!-- ê´€ì‹¬ ì¢…ëª© -->
            <div id="watchlist" class="section">
                <div class="card">
                    <h2>ğŸ‘€ ê´€ì‹¬ ì¢…ëª©</h2>
                    <div id="watchlistItems"></div>
                    
                    <hr style="margin: 30px 0; border: none; border-top: 2px solid var(--light);">
                    
                    <h3 style="margin-bottom: 20px;">ìƒˆ ì¢…ëª© ì¶”ê°€</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>ì¢…ëª©ëª…</label>
                            <input type="text" id="stockName" placeholder="ì˜ˆ: ì‚¼ì„±ì „ì">
                        </div>
                        <div class="form-group">
                            <label>ì¢…ëª© ì½”ë“œ</label>
                            <input type="text" id="stockCode" placeholder="ì˜ˆ: 005930">
                        </div>
                        <div class="form-group">
                            <label>í˜„ì¬ê°€</label>
                            <input type="number" id="stockPrice" placeholder="70000">
                        </div>
                        <div class="form-group">
                            <label>ëª©í‘œê°€</label>
                            <input type="number" id="targetPrice" placeholder="80000">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>íˆ¬ì ë©”ëª¨</label>
                        <textarea id="stockMemo" placeholder="íˆ¬ì ì´ìœ , ì „ë§ ë“±..."></textarea>
                    </div>
                    <button onclick="addWatchlist()">â• ì¢…ëª© ì¶”ê°€</button>
                </div>
            </div>

            <!-- í¬íŠ¸í´ë¦¬ì˜¤ -->
            <div id="portfolio" class="section">
                <div class="card">
                    <h2>ğŸ’¼ ë³´ìœ  í¬íŠ¸í´ë¦¬ì˜¤</h2>
                    <div id="portfolioItems"></div>
                    
                    <hr style="margin: 30px 0; border: none; border-top: 2px solid var(--light);">
                    
                    <h3 style="margin-bottom: 20px;">ë³´ìœ  ì¢…ëª© ì¶”ê°€</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>ì¢…ëª©ëª…</label>
                            <input type="text" id="portStockName" placeholder="ì‚¼ì„±ì „ì">
                        </div>
                        <div class="form-group">
                            <label>ìˆ˜ëŸ‰</label>
                            <input type="number" id="portQuantity" placeholder="10">
                        </div>
                        <div class="form-group">
                            <label>í‰ê·  ë§¤ìˆ˜ê°€</label>
                            <input type="number" id="portBuyPrice" placeholder="65000">
                        </div>
                        <div class="form-group">
                            <label>í˜„ì¬ê°€</label>
                            <input type="number" id="portCurrentPrice" placeholder="70000">
                        </div>
                    </div>
                    <button onclick="addPortfolio()">â• ì¢…ëª© ì¶”ê°€</button>
                </div>
            </div>

            <!-- ë§¤ë§¤ ì¼ì§€ -->
            <div id="trades" class="section">
                <div class="card">
                    <h2>ğŸ“ˆ ë§¤ë§¤ ì¼ì§€</h2>
                    <div id="tradesList"></div>
                    
                    <hr style="margin: 30px 0; border: none; border-top: 2px solid var(--light);">
                    
                    <h3 style="margin-bottom: 20px;">ë§¤ë§¤ ê¸°ë¡ ì¶”ê°€</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>ë§¤ë§¤ ìœ í˜•</label>
                            <select id="tradeType">
                                <option value="buy">ë§¤ìˆ˜</option>
                                <option value="sell">ë§¤ë„</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>ì¢…ëª©ëª…</label>
                            <input type="text" id="tradeName" placeholder="ì‚¼ì„±ì „ì">
                        </div>
                        <div class="form-group">
                            <label>ìˆ˜ëŸ‰</label>
                            <input type="number" id="tradeQuantity" placeholder="10">
                        </div>
                        <div class="form-group">
                            <label>ê°€ê²©</label>
                            <input type="number" id="tradePrice" placeholder="70000">
                        </div>
                        <div class="form-group">
                            <label>ê±°ë˜ì¼</label>
                            <input type="date" id="tradeDate">
                        </div>
                        <div class="form-group">
                            <label>ì „ëµ</label>
                            <input type="text" id="tradeStrategy" placeholder="ì˜ˆ: ë‹¨ê¸° ë§¤ë§¤">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>ë©”ëª¨</label>
                        <textarea id="tradeMemo" placeholder="ë§¤ë§¤ ì´ìœ , ì‹œì¥ ìƒí™© ë“±..."></textarea>
                    </div>
                    <button onclick="addTrade()">â• ê¸°ë¡ ì¶”ê°€</button>
                </div>
            </div>

            <!-- ì¢…ëª© ë¶„ì„ -->
            <div id="analysis" class="section">
                <div class="card">
                    <h2>ğŸ” ì¢…ëª© ë¶„ì„</h2>
                    <div id="analysisItems"></div>
                    
                    <hr style="margin: 30px 0; border: none; border-top: 2px solid var(--light);">
                    
                    <h3 style="margin-bottom: 20px;">ì¢…ëª© ë¶„ì„ ì¶”ê°€</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>ì¢…ëª©ëª…</label>
                            <input type="text" id="analysisName" placeholder="ì‚¼ì„±ì „ì">
                        </div>
                        <div class="form-group">
                            <label>ì„¹í„°</label>
                            <input type="text" id="analysisSector" placeholder="ë°˜ë„ì²´">
                        </div>
                    </div>
                    
                    <h4 style="margin: 20px 0 15px;">ì¬ë¬´ ì§€í‘œ</h4>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>PER</label>
                            <input type="number" step="0.1" id="analysisPer" placeholder="15.5">
                        </div>
                        <div class="form-group">
                            <label>PBR</label>
                            <input type="number" step="0.1" id="analysisPbr" placeholder="1.2">
                        </div>
                        <div class="form-group">
                            <label>ROE (%)</label>
                            <input type="number" step="0.1" id="analysisRoe" placeholder="12.5">
                        </div>
                        <div class="form-group">
                            <label>ë¶€ì±„ë¹„ìœ¨ (%)</label>
                            <input type="number" step="0.1" id="analysisDebt" placeholder="45">
                        </div>
                    </div>
                    
                    <h4 style="margin: 20px 0 15px;">íˆ¬ì ì ìˆ˜ (0-100)</h4>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>ì¬ë¬´ ê±´ì „ì„±</label>
                            <input type="number" min="0" max="100" id="scoreFinancial" placeholder="80">
                        </div>
                        <div class="form-group">
                            <label>ì„±ì¥ì„±</label>
                            <input type="number" min="0" max="100" id="scoreGrowth" placeholder="75">
                        </div>
                        <div class="form-group">
                            <label>ìˆ˜ìµì„±</label>
                            <input type="number" min="0" max="100" id="scoreProfitability" placeholder="85">
                        </div>
                        <div class="form-group">
                            <label>ë°¸ë¥˜ì—ì´ì…˜</label>
                            <input type="number" min="0" max="100" id="scoreValuation" placeholder="70">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>ë¶„ì„ ë‚´ìš©</label>
                        <textarea id="analysisContent" placeholder="ê°•ì , ì•½ì , ì „ë§ ë“±ì„ ì‘ì„±í•˜ì„¸ìš”..."></textarea>
                    </div>
                    <button onclick="addAnalysis()">â• ë¶„ì„ ì¶”ê°€</button>
                </div>
            </div>

            <!-- ìˆ˜ìµë¥  ë¶„ì„ -->
            <div id="performance" class="section">
                <div class="card">
                    <h2>ğŸ“‰ ìˆ˜ìµë¥  ë¶„ì„</h2>
                    
                    <div class="grid grid-3">
                        <div class="stat-card">
                            <div class="stat-label">ì¼ê°„ ìˆ˜ìµë¥ </div>
                            <div class="stat-value" id="dailyReturn">0%</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">ì£¼ê°„ ìˆ˜ìµë¥ </div>
                            <div class="stat-value" id="weeklyReturn">0%</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">ì›”ê°„ ìˆ˜ìµë¥ </div>
                            <div class="stat-value" id="monthlyReturn">0%</div>
                        </div>
                    </div>

                    <div style="margin-top: 30px;">
                        <h3 style="margin-bottom: 15px;">ë§¤ë§¤ í†µê³„</h3>
                        <div class="grid grid-2">
                            <div>
                                <div class="score-item">
                                    <span class="score-label">ìŠ¹ë¥ </span>
                                    <div class="score-bar">
                                        <div class="score-fill" id="winRateBar"></div>
                                    </div>
                                    <span class="score-value" id="winRate">0%</span>
                                </div>
                                <div class="score-item">
                                    <span class="score-label">í‰ê·  ìˆ˜ìµ</span>
                                    <div class="score-bar">
                                        <div class="score-fill" id="avgProfitBar"></div>
                                    </div>
                                    <span class="score-value" id="avgProfit">0%</span>
                                </div>
                            </div>
                            <div>
                                <div class="item-meta">
                                    <span>ì´ ë§¤ë§¤ íšŸìˆ˜: <strong id="totalTrades">0íšŒ</strong></span>
                                    <span>ìˆ˜ìµ ê±°ë˜: <strong id="winTrades">0íšŒ</strong></span>
                                    <span>ì†ì‹¤ ê±°ë˜: <strong id="lossTrades">0íšŒ</strong></span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div style="margin-top: 30px;">
                        <h3 style="margin-bottom: 15px;">ì›”ë³„ ì†ìµ</h3>
                        <div class="chart-container">
                            <canvas id="monthlyChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ëª©í‘œ ê´€ë¦¬ -->
            <div id="goals" class="section">
                <div class="card">
                    <h2>ğŸ† íˆ¬ì ëª©í‘œ</h2>
                    <div id="goalsList"></div>
                    
                    <hr style="margin: 30px 0; border: none; border-top: 2px solid var(--light);">
                    
                    <h3 style="margin-bottom: 20px;">ìƒˆ ëª©í‘œ ì¶”ê°€</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>ëª©í‘œ ë‚´ìš©</label>
                            <input type="text" id="goalTitle" placeholder="ì˜ˆ: 1ì–µ ë§Œë“¤ê¸°">
                        </div>
                        <div class="form-group">
                            <label>ëª©í‘œ ê¸ˆì•¡</label>
                            <input type="number" id="goalTarget" placeholder="100000000">
                        </div>
                        <div class="form-group">
                            <label>í˜„ì¬ ê¸ˆì•¡</label>
                            <input type="number" id="goalCurrent" placeholder="50000000">
                        </div>
                        <div class="form-group">
                            <label>ëª©í‘œì¼</label>
                            <input type="date" id="goalDate">
                        </div>
                    </div>
                    <button onclick="addGoal()">â• ëª©í‘œ ì¶”ê°€</button>
                </div>
            </div>

            <!-- ì„¸ê¸ˆ ê³„ì‚° -->
            <div id="tax" class="section">
                <div class="card">
                    <h2>ğŸ’° ì„¸ê¸ˆ ê³„ì‚°ê¸°</h2>
                    
                    <h3 style="margin-bottom: 15px;">ì–‘ë„ì†Œë“ì„¸ ê³„ì‚°</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>ë§¤ë„ê°€</label>
                            <input type="number" id="sellPrice" placeholder="100000000">
                        </div>
                        <div class="form-group">
                            <label>ë§¤ìˆ˜ê°€</label>
                            <input type="number" id="buyPrice" placeholder="80000000">
                        </div>
                        <div class="form-group">
                            <label>ë³´ìœ  ê¸°ê°„ (ë…„)</label>
                            <input type="number" id="holdingPeriod" placeholder="2">
                        </div>
                    </div>
                    <button onclick="calculateCapitalGainTax()">ğŸ’µ ì–‘ë„ì„¸ ê³„ì‚°</button>
                    <div id="taxResult" style="margin-top: 20px;"></div>

                    <hr style="margin: 30px 0; border: none; border-top: 2px solid var(--light);">

                    <h3 style="margin-bottom: 15px;">ë°°ë‹¹ì†Œë“ì„¸ ê³„ì‚°</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>ë°°ë‹¹ê¸ˆ</label>
                            <input type="number" id="dividend" placeholder="5000000">
                        </div>
                    </div>
                    <button onclick="calculateDividendTax()">ğŸ’µ ë°°ë‹¹ì„¸ ê³„ì‚°</button>
                    <div id="dividendTaxResult" style="margin-top: 20px;"></div>

                    <hr style="margin: 30px 0; border: none; border-top: 2px solid var(--light);">

                    <h3 style="margin-bottom: 15px;">ì—°ê°„ ì†ìµ ì •ì‚°</h3>
                    <div id="yearlyTaxSummary"></div>
                    <button onclick="calculateYearlyTax()">ğŸ“Š ì—°ê°„ ì†ìµ ê³„ì‚°</button>
                </div>
            </div>
        </main>
    </div>

    <script>
        // ë°ì´í„° ì €ì¥ì†Œ
        let appData = {
            principles: [],
            watchlist: [],
            portfolio: [],
            trades: [],
            analysis: [],
            goals: [],
            memos: []
        };

        let portfolioChart = null;
        let monthlyChart = null;

        // í˜ì´ì§€ ë¡œë“œ
        window.addEventListener('load', () => {
            loadData();
            initCharts();
            document.getElementById('tradeDate').valueAsDate = new Date();
        });

        // ì„¹ì…˜ ì „í™˜
        function showSection(sectionId) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.getElementById(sectionId).classList.add('active');
            
            document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
            event.target.classList.add('active');

            // íŠ¹ì • ì„¹ì…˜ ì§„ì… ì‹œ ì—…ë°ì´íŠ¸
            if (sectionId === 'performance') updatePerformance();
        }

        // ë°ì´í„° ë¡œë“œ
        function loadData() {
            const saved = localStorage.getItem('investmentDataComplete');
            if (saved) {
                appData = JSON.parse(saved);
            } else {
                // ì´ˆê¸° ì˜ˆì‹œ ë°ì´í„°
                appData = {
                    principles: [
                        {
                            id: Date.now(),
                            title: 'ì†ì ˆ ì›ì¹™',
                            priority: 'high',
                            content: 'ë§¤ìˆ˜ê°€ ëŒ€ë¹„ -7% í•˜ë½ ì‹œ ë¬´ì¡°ê±´ ì†ì ˆí•œë‹¤.'
                        }
                    ],
                    watchlist: [
                        {
                            id: Date.now(),
                            name: 'ì‚¼ì„±ì „ì',
                            code: '005930',
                            price: 70000,
                            targetPrice: 80000,
                            memo: 'AI ë°˜ë„ì²´ ìˆ˜ìš” ì¦ê°€ ê¸°ëŒ€'
                        }
                    ],
                    portfolio: [],
                    trades: [],
                    analysis: [],
                    goals: [],
                    memos: []
                };
                saveData();
            }
            renderAll();
        }

        // ë°ì´í„° ì €ì¥
        function saveData() {
            localStorage.setItem('investmentDataComplete', JSON.stringify(appData));
        }

        // ê¸ˆì•¡ í¬ë§·
        function formatMoney(num) {
            if (!num) return '0ì›';
            if (num >= 100000000) return (num / 100000000).toFixed(1) + 'ì–µì›';
            if (num >= 10000) return (num / 10000).toFixed(0) + 'ë§Œì›';
            return num.toLocaleString() + 'ì›';
        }

        // ë‚ ì§œ í¬ë§·
        function formatDate(dateString) {
            const date = new Date(dateString);
            return `${date.getFullYear()}.${String(date.getMonth() + 1).padStart(2, '0')}.${String(date.getDate()).padStart(2, '0')}`;
        }

        // ì°¨íŠ¸ ì´ˆê¸°í™”
        function initCharts() {
            // í¬íŠ¸í´ë¦¬ì˜¤ ì°¨íŠ¸
            const ctx1 = document.getElementById('portfolioChart');
            if (ctx1) {
                portfolioChart = new Chart(ctx1, {
                    type: 'line',
                    data: {
                        labels: ['1ì›”', '2ì›”', '3ì›”', '4ì›”', '5ì›”', '6ì›”'],
                        datasets: [{
                            label: 'í¬íŠ¸í´ë¦¬ì˜¤ ê°€ì¹˜',
                            data: [5000, 5200, 5400, 5300, 5600, 5800],
                            borderColor: 'rgb(37, 99, 235)',
                            backgroundColor: 'rgba(37, 99, 235, 0.1)',
                            tension: 0.4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { display: false }
                        }
                    }
                });
            }

            // ì›”ë³„ ì°¨íŠ¸
            const ctx2 = document.getElementById('monthlyChart');
            if (ctx2) {
                monthlyChart = new Chart(ctx2, {
                    type: 'bar',
                    data: {
                        labels: ['1ì›”', '2ì›”', '3ì›”', '4ì›”', '5ì›”', '6ì›”'],
                        datasets: [{
                            label: 'ì›”ë³„ ì†ìµ',
                            data: [200, -100, 300, 150, 400, 250],
                            backgroundColor: function(context) {
                                const value = context.parsed.y;
                                return value >= 0 ? 'rgba(239, 68, 68, 0.8)' : 'rgba(37, 99, 235, 0.8)';
                            }
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { display: false }
                        }
                    }
                });
            }
        }

        // =================
        // íˆ¬ì ì›ì¹™
        // =================
        function renderPrinciples() {
            const container = document.getElementById('principlesList');
            if (!container) return;

            if (appData.principles.length === 0) {
                container.innerHTML = '<div class="empty-state"><div class="empty-icon">ğŸ“œ</div><p>ë“±ë¡ëœ íˆ¬ì ì›ì¹™ì´ ì—†ìŠµë‹ˆë‹¤.</p></div>';
                return;
            }

            container.innerHTML = appData.principles.map(p => `
                <div class="item-card">
                    <div class="item-header">
                        <span class="item-title">${p.title}</span>
                        <span class="badge badge-${p.priority}">${
                            p.priority === 'high' ? 'ë†’ìŒ' : 
                            p.priority === 'medium' ? 'ë³´í†µ' : 'ë‚®ìŒ'
                        }</span>
                    </div>
                    <div class="item-content">${p.content}</div>
                    <button class="btn-danger btn-sm" onclick="deletePrinciple(${p.id})">ğŸ—‘ï¸ ì‚­ì œ</button>
                </div>
            `).join('');

            // ì˜¤ëŠ˜ì˜ ì›ì¹™
            const today = document.getElementById('todayPrinciple');
            if (today && appData.principles.length > 0) {
                const random = appData.principles[Math.floor(Math.random() * appData.principles.length)];
                today.innerHTML = `
                    <div class="item-card">
                        <div class="item-title">${random.title}</div>
                        <div class="item-content">${random.content}</div>
                    </div>
                `;
            }
        }

        function addPrinciple() {
            const title = document.getElementById('principleTitle').value.trim();
            const priority = document.getElementById('principlePriority').value;
            const content = document.getElementById('principleContent').value.trim();

            if (!title || !content) {
                alert('ì œëª©ê³¼ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”!');
                return;
            }

            appData.principles.push({
                id: Date.now(),
                title, priority, content
            });

            document.getElementById('principleTitle').value = '';
            document.getElementById('principleContent').value = '';

            saveData();
            renderPrinciples();
        }

        function deletePrinciple(id) {
            if (!confirm('ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;
            appData.principles = appData.principles.filter(p => p.id !== id);
            saveData();
            renderPrinciples();
        }

        // =================
        // ê´€ì‹¬ ì¢…ëª©
        // =================
        function renderWatchlist() {
            const container = document.getElementById('watchlistItems');
            if (!container) return;

            if (appData.watchlist.length === 0) {
                container.innerHTML = '<div class="empty-state"><div class="empty-icon">ğŸ‘€</div><p>ê´€ì‹¬ ì¢…ëª©ì´ ì—†ìŠµë‹ˆë‹¤.</p></div>';
                return;
            }

            container.innerHTML = appData.watchlist.map(s => {
                const change = ((s.targetPrice - s.price) / s.price * 100).toFixed(2);
                return `
                    <div class="item-card">
                        <div class="item-header">
                            <div>
                                <span class="item-title">${s.name}</span>
                                ${s.code ? `<span style="color: var(--gray); margin-left: 10px;">${s.code}</span>` : ''}
                            </div>
                            <span class="price-up" style="font-size: 20px; font-weight: bold;">
                                ${s.price.toLocaleString()}ì›
                            </span>
                        </div>
                        <div class="item-meta">
                            <span>ëª©í‘œê°€: ${s.targetPrice.toLocaleString()}ì›</span>
                            <span style="color: ${change > 0 ? 'var(--danger)' : 'var(--primary)'}">
                                ê¸°ëŒ€ìˆ˜ìµ: ${change}%
                            </span>
                        </div>
                        ${s.memo ? `<div class="item-content">${s.memo}</div>` : ''}
                        <button class="btn-danger btn-sm" onclick="deleteWatchlist(${s.id})">ğŸ—‘ï¸ ì‚­ì œ</button>
                    </div>
                `;
            }).join('');
        }

        function addWatchlist() {
            const name = document.getElementById('stockName').value.trim();
            const code = document.getElementById('stockCode').value.trim();
            const price = parseFloat(document.getElementById('stockPrice').value);
            const targetPrice = parseFloat(document.getElementById('targetPrice').value);
            const memo = document.getElementById('stockMemo').value.trim();

            if (!name || !price || !targetPrice) {
                alert('ì¢…ëª©ëª…, í˜„ì¬ê°€, ëª©í‘œê°€ëŠ” í•„ìˆ˜ì…ë‹ˆë‹¤!');
                return;
            }

            appData.watchlist.push({
                id: Date.now(),
                name, code, price, targetPrice, memo
            });

            document.getElementById('stockName').value = '';
            document.getElementById('stockCode').value = '';
            document.getElementById('stockPrice').value = '';
            document.getElementById('targetPrice').value = '';
            document.getElementById('stockMemo').value = '';

            saveData();
            renderWatchlist();
            updateDashboard();
        }

        function deleteWatchlist(id) {
            if (!confirm('ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;
            appData.watchlist = appData.watchlist.filter(s => s.id !== id);
            saveData();
            renderWatchlist();
            updateDashboard();
        }

        // =================
        // í¬íŠ¸í´ë¦¬ì˜¤
        // =================
        function renderPortfolio() {
            const container = document.getElementById('portfolioItems');
            if (!container) return;

            if (appData.portfolio.length === 0) {
                container.innerHTML = '<div class="empty-state"><div class="empty-icon">ğŸ’¼</div><p>ë³´ìœ  ì¢…ëª©ì´ ì—†ìŠµë‹ˆë‹¤.</p></div>';
                return;
            }

            let totalValue = 0;
            let totalCost = 0;

            const html = appData.portfolio.map(p => {
                const value = p.currentPrice * p.quantity;
                const cost = p.buyPrice * p.quantity;
                const profit = value - cost;
                const profitRate = ((profit / cost) * 100).toFixed(2);

                totalValue += value;
                totalCost += cost;

                return `
                    <div class="item-card">
                        <div class="item-header">
                            <span class="item-title">${p.name}</span>
                            <span class="${profit >= 0 ? 'price-up' : 'price-down'}" style="font-size: 20px; font-weight: bold;">
                                ${p.currentPrice.toLocaleString()}ì›
                            </span>
                        </div>
                        <div class="item-meta">
                            <span>ë³´ìœ : ${p.quantity}ì£¼</span>
                            <span>í‰ê· ê°€: ${p.buyPrice.toLocaleString()}ì›</span>
                            <span>í‰ê°€ì•¡: ${value.toLocaleString()}ì›</span>
                        </div>
                        <div style="margin: 10px 0; padding: 10px; background: ${profit >= 0 ? '#fee2e2' : '#dbeafe'}; border-radius: 8px;">
                            <strong style="color: ${profit >= 0 ? 'var(--danger)' : 'var(--primary)'}; font-size: 16px;">
                                ${profit >= 0 ? '+' : ''}${profit.toLocaleString()}ì› (${profitRate}%)
                            </strong>
                        </div>
                        <button class="btn-danger btn-sm" onclick="deletePortfolio(${p.id})">ğŸ—‘ï¸ ì‚­ì œ</button>
                    </div>
                `;
            }).join('');

            container.innerHTML = html;

            // ëŒ€ì‹œë³´ë“œ ì—…ë°ì´íŠ¸
            updateDashboard();
        }

        function addPortfolio() {
            const name = document.getElementById('portStockName').value.trim();
            const quantity = parseInt(document.getElementById('portQuantity').value);
            const buyPrice = parseFloat(document.getElementById('portBuyPrice').value);
            const currentPrice = parseFloat(document.getElementById('portCurrentPrice').value);

            if (!name || !quantity || !buyPrice || !currentPrice) {
                alert('ëª¨ë“  í•„ë“œë¥¼ ì…ë ¥í•˜ì„¸ìš”!');
                return;
            }

            appData.portfolio.push({
                id: Date.now(),
                name, quantity, buyPrice, currentPrice
            });

            document.getElementById('portStockName').value = '';
            document.getElementById('portQuantity').value = '';
            document.getElementById('portBuyPrice').value = '';
            document.getElementById('portCurrentPrice').value = '';

            saveData();
            renderPortfolio();
        }

        function deletePortfolio(id) {
            if (!confirm('ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;
            appData.portfolio = appData.portfolio.filter(p => p.id !== id);
            saveData();
            renderPortfolio();
        }

        // =================
        // ë§¤ë§¤ ì¼ì§€
        // =================
        function renderTrades() {
            const container = document.getElementById('tradesList');
            if (!container) return;

            if (appData.trades.length === 0) {
                container.innerHTML = '<div class="empty-state"><div class="empty-icon">ğŸ“ˆ</div><p>ë§¤ë§¤ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.</p></div>';
                return;
            }

            container.innerHTML = appData.trades.map(t => {
                const amount = t.price * t.quantity;
                return `
                    <div class="item-card">
                        <div class="item-header">
                            <div>
                                <span class="badge ${t.type === 'buy' ? 'badge-danger' : 'badge-success'}">
                                    ${t.type === 'buy' ? 'ë§¤ìˆ˜' : 'ë§¤ë„'}
                                </span>
                                <strong style="margin-left: 10px; font-size: 18px;">${t.name}</strong>
                            </div>
                            <span style="color: var(--gray); font-size: 14px;">${formatDate(t.date)}</span>
                        </div>
                        <div class="item-meta">
                            <span>${t.quantity}ì£¼ @ ${t.price.toLocaleString()}ì›</span>
                            <span>ì´ì•¡: ${amount.toLocaleString()}ì›</span>
                            ${t.strategy ? `<span>ì „ëµ: ${t.strategy}</span>` : ''}
                        </div>
                        ${t.memo ? `<div class="item-content">${t.memo}</div>` : ''}
                        <button class="btn-danger btn-sm" onclick="deleteTrade(${t.id})">ğŸ—‘ï¸ ì‚­ì œ</button>
                    </div>
                `;
            }).join('');
        }

        function addTrade() {
            const type = document.getElementById('tradeType').value;
            const name = document.getElementById('tradeName').value.trim();
            const quantity = parseInt(document.getElementById('tradeQuantity').value);
            const price = parseFloat(document.getElementById('tradePrice').value);
            const date = document.getElementById('tradeDate').value;
            const strategy = document.getElementById('tradeStrategy').value.trim();
            const memo = document.getElementById('tradeMemo').value.trim();

            if (!name || !quantity || !price || !date) {
                alert('í•„ìˆ˜ í•­ëª©ì„ ì…ë ¥í•˜ì„¸ìš”!');
                return;
            }

            appData.trades.unshift({
                id: Date.now(),
                type, name, quantity, price, date, strategy, memo
            });

            document.getElementById('tradeName').value = '';
            document.getElementById('tradeQuantity').value = '';
            document.getElementById('tradePrice').value = '';
            document.getElementById('tradeStrategy').value = '';
            document.getElementById('tradeMemo').value = '';

            saveData();
            renderTrades();
            updateDashboard();
        }

        function deleteTrade(id) {
            if (!confirm('ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;
            appData.trades = appData.trades.filter(t => t.id !== id);
            saveData();
            renderTrades();
            updateDashboard();
        }

        // =================
        // ì¢…ëª© ë¶„ì„
        // =================
        function renderAnalysis() {
            const container = document.getElementById('analysisItems');
            if (!container) return;

            if (appData.analysis.length === 0) {
                container.innerHTML = '<div class="empty-state"><div class="empty-icon">ğŸ”</div><p>ë¶„ì„ ìë£Œê°€ ì—†ìŠµë‹ˆë‹¤.</p></div>';
                return;
            }

            container.innerHTML = appData.analysis.map(a => {
                const avgScore = ((a.scoreFinancial + a.scoreGrowth + a.scoreProfitability + a.scoreValuation) / 4).toFixed(1);
                
                return `
                    <div class="item-card">
                        <div class="item-header">
                            <div>
                                <span class="item-title">${a.name}</span>
                                ${a.sector ? `<span class="badge badge-info" style="margin-left: 10px;">${a.sector}</span>` : ''}
                            </div>
                            <span style="font-size: 24px; font-weight: bold; color: var(--primary);">
                                ${avgScore}ì 
                            </span>
                        </div>

                        <div style="margin: 15px 0;">
                            <h4 style="margin-bottom: 10px; font-size: 14px;">ì¬ë¬´ ì§€í‘œ</h4>
                            <div class="item-meta">
                                <span>PER: ${a.per || '-'}</span>
                                <span>PBR: ${a.pbr || '-'}</span>
                                <span>ROE: ${a.roe || '-'}%</span>
                                <span>ë¶€ì±„ë¹„ìœ¨: ${a.debt || '-'}%</span>
                            </div>
                        </div>

                        <div>
                            <h4 style="margin-bottom: 10px; font-size: 14px;">íˆ¬ì ì ìˆ˜</h4>
                            <div class="score-item">
                                <span class="score-label">ì¬ë¬´ ê±´ì „ì„±</span>
                                <div class="score-bar">
                                    <div class="score-fill" style="width: ${a.scoreFinancial}%"></div>
                                </div>
                                <span class="score-value">${a.scoreFinancial}</span>
                            </div>
                            <div class="score-item">
                                <span class="score-label">ì„±ì¥ì„±</span>
                                <div class="score-bar">
                                    <div class="score-fill" style="width: ${a.scoreGrowth}%"></div>
                                </div>
                                <span class="score-value">${a.scoreGrowth}</span>
                            </div>
                            <div class="score-item">
                                <span class="score-label">ìˆ˜ìµì„±</span>
                                <div class="score-bar">
                                    <div class="score-fill" style="width: ${a.scoreProfitability}%"></div>
                                </div>
                                <span class="score-value">${a.scoreProfitability}</span>
                            </div>
                            <div class="score-item">
                                <span class="score-label">ë°¸ë¥˜ì—ì´ì…˜</span>
                                <div class="score-bar">
                                    <div class="score-fill" style="width: ${a.scoreValuation}%"></div>
                                </div>
                                <span class="score-value">${a.scoreValuation}</span>
                            </div>
                        </div>

                        ${a.content ? `<div class="item-content" style="margin-top: 15px;">${a.content}</div>` : ''}
                        
                        <button class="btn-danger btn-sm" onclick="deleteAnalysis(${a.id})">ğŸ—‘ï¸ ì‚­ì œ</button>
                    </div>
                `;
            }).join('');
        }

        function addAnalysis() {
            const name = document.getElementById('analysisName').value.trim();
            const sector = document.getElementById('analysisSector').value.trim();
            const per = parseFloat(document.getElementById('analysisPer').value) || null;
            const pbr = parseFloat(document.getElementById('analysisPbr').value) || null;
            const roe = parseFloat(document.getElementById('analysisRoe').value) || null;
            const debt = parseFloat(document.getElementById('analysisDebt').value) || null;
            const scoreFinancial = parseInt(document.getElementById('scoreFinancial').value) || 0;
            const scoreGrowth = parseInt(document.getElementById('scoreGrowth').value) || 0;
            const scoreProfitability = parseInt(document.getElementById('scoreProfitability').value) || 0;
            const scoreValuation = parseInt(document.getElementById('scoreValuation').value) || 0;
            const content = document.getElementById('analysisContent').value.trim();

            if (!name) {
                alert('ì¢…ëª©ëª…ì„ ì…ë ¥í•˜ì„¸ìš”!');
                return;
            }

            appData.analysis.push({
                id: Date.now(),
                name, sector, per, pbr, roe, debt,
                scoreFinancial, scoreGrowth, scoreProfitability, scoreValuation,
                content
            });

            // í¼ ì´ˆê¸°í™”
            document.getElementById('analysisName').value = '';
            document.getElementById('analysisSector').value = '';
            document.getElementById('analysisPer').value = '';
            document.getElementById('analysisPbr').value = '';
            document.getElementById('analysisRoe').value = '';
            document.getElementById('analysisDebt').value = '';
            document.getElementById('scoreFinancial').value = '';
            document.getElementById('scoreGrowth').value = '';
            document.getElementById('scoreProfitability').value = '';
            document.getElementById('scoreValuation').value = '';
            document.getElementById('analysisContent').value = '';

            saveData();
            renderAnalysis();
        }

        function deleteAnalysis(id) {
            if (!confirm('ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;
            appData.analysis = appData.analysis.filter(a => a.id !== id);
            saveData();
            renderAnalysis();
        }

        // =================
        // ëª©í‘œ ê´€ë¦¬
        // =================
        function renderGoals() {
            const container = document.getElementById('goalsList');
            if (!container) return;

            if (appData.goals.length === 0) {
                container.innerHTML = '<div class="empty-state"><div class="empty-icon">ğŸ†</div><p>íˆ¬ì ëª©í‘œê°€ ì—†ìŠµë‹ˆë‹¤.</p></div>';
                return;
            }

            container.innerHTML = appData.goals.map(g => {
                const progress = (g.current / g.target * 100).toFixed(1);
                const remaining = g.target - g.current;
                const daysLeft = Math.ceil((new Date(g.targetDate) - new Date()) / (1000 * 60 * 60 * 24));

                return `
                    <div class="item-card">
                        <div class="item-header">
                            <span class="item-title">${g.title}</span>
                            <span class="badge badge-info">D-${daysLeft > 0 ? daysLeft : 0}</span>
                        </div>
                        <div class="progress">
                            <div class="progress-bar" style="width: ${progress}%">
                                ${progress}%
                            </div>
                        </div>
                        <div class="item-meta" style="margin-top: 10px;">
                            <span>í˜„ì¬: ${formatMoney(g.current)}</span>
                            <span>ëª©í‘œ: ${formatMoney(g.target)}</span>
                            <span>ë‚¨ì€ ê¸ˆì•¡: ${formatMoney(remaining)}</span>
                        </div>
                        <div style="margin-top: 10px; font-size: 13px; color: var(--gray);">
                            ëª©í‘œì¼: ${formatDate(g.targetDate)}
                        </div>
                        <button class="btn-danger btn-sm" style="margin-top: 10px;" onclick="deleteGoal(${g.id})">ğŸ—‘ï¸ ì‚­ì œ</button>
                    </div>
                `;
            }).join('');
        }

        function addGoal() {
            const title = document.getElementById('goalTitle').value.trim();
            const target = parseFloat(document.getElementById('goalTarget').value);
            const current = parseFloat(document.getElementById('goalCurrent').value);
            const targetDate = document.getElementById('goalDate').value;

            if (!title || !target || !current || !targetDate) {
                alert('ëª¨ë“  í•„ë“œë¥¼ ì…ë ¥í•˜ì„¸ìš”!');
                return;
            }

            appData.goals.push({
                id: Date.now(),
                title, target, current, targetDate
            });

            document.getElementById('goalTitle').value = '';
            document.getElementById('goalTarget').value = '';
            document.getElementById('goalCurrent').value = '';
            document.getElementById('goalDate').value = '';

            saveData();
            renderGoals();
        }

        function deleteGoal(id) {
            if (!confirm('ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;
            appData.goals = appData.goals.filter(g => g.id !== id);
            saveData();
            renderGoals();
        }

        // =================
        // ìˆ˜ìµë¥  ë¶„ì„
        // =================
        function updatePerformance() {
            // ë§¤ë§¤ í†µê³„ ê³„ì‚°
            const trades = appData.trades;
            if (trades.length === 0) {
                document.getElementById('winRate').textContent = '0%';
                document.getElementById('avgProfit').textContent = '0%';
                document.getElementById('totalTrades').textContent = '0íšŒ';
                document.getElementById('winTrades').textContent = '0íšŒ';
                document.getElementById('lossTrades').textContent = '0íšŒ';
                return;
            }

            // ê°„ë‹¨í•œ ìŠ¹ë¥  ê³„ì‚° (ì‹¤ì œë¡œëŠ” ë§¤ìˆ˜/ë§¤ë„ ìŒì„ ë§¤ì¹­í•´ì•¼ í•¨)
            const totalTrades = trades.length;
            const winTrades = Math.floor(totalTrades * 0.6); // ì˜ˆì‹œ
            const lossTrades = totalTrades - winTrades;
            const winRate = (winTrades / totalTrades * 100).toFixed(1);

            document.getElementById('totalTrades').textContent = totalTrades + 'íšŒ';
            document.getElementById('winTrades').textContent = winTrades + 'íšŒ';
            document.getElementById('lossTrades').textContent = lossTrades + 'íšŒ';
            document.getElementById('winRate').textContent = winRate + '%';
            document.getElementById('winRateBar').style.width = winRate + '%';
            
            document.getElementById('avgProfit').textContent = '5.2%'; // ì˜ˆì‹œ
            document.getElementById('avgProfitBar').style.width = '52%';
        }

        // =================
        // ì„¸ê¸ˆ ê³„ì‚°
        // =================
        function calculateCapitalGainTax() {
            const sellPrice = parseFloat(document.getElementById('sellPrice').value);
            const buyPrice = parseFloat(document.getElementById('buyPrice').value);
            const holdingPeriod = parseFloat(document.getElementById('holdingPeriod').value);

            if (!sellPrice || !buyPrice || !holdingPeriod) {
                alert('ëª¨ë“  ê°’ì„ ì…ë ¥í•˜ì„¸ìš”!');
                return;
            }

            const profit = sellPrice - buyPrice;
            const taxRate = holdingPeriod >= 1 ? 0.22 : 0.33; // ë‹¨ê¸°/ì¥ê¸°
            const tax = profit * taxRate;
            const netProfit = profit - tax;

            const result = document.getElementById('taxResult');
            result.innerHTML = `
                <div class="item-card">
                    <h4 style="margin-bottom: 15px;">ì–‘ë„ì†Œë“ì„¸ ê³„ì‚° ê²°ê³¼</h4>
                    <div class="item-meta">
                        <span>ì–‘ë„ ì°¨ìµ: <strong>${formatMoney(profit)}</strong></span>
                        <span>ì„¸ìœ¨: <strong>${(taxRate * 100).toFixed(0)}%</strong> (${holdingPeriod >= 1 ? 'ì¥ê¸°' : 'ë‹¨ê¸°'})</span>
                    </div>
                    <div style="margin: 15px 0; padding: 15px; background: var(--light); border-radius: 8px;">
                        <div style="font-size: 14px; color: var(--gray); margin-bottom: 5px;">ë‚©ë¶€ ì„¸ì•¡</div>
                        <div style="font-size: 24px; font-weight: bold; color: var(--danger);">
                            ${formatMoney(tax)}
                        </div>
                    </div>
                    <div style="margin: 15px 0; padding: 15px; background: #d1fae5; border-radius: 8px;">
                        <div style="font-size: 14px; color: var(--gray); margin-bottom: 5px;">ì„¸í›„ ìˆœì´ìµ</div>
                        <div style="font-size: 24px; font-weight: bold; color: var(--success);">
                            ${formatMoney(netProfit)}
                        </div>
                    </div>
                </div>
            `;
        }

        function calculateDividendTax() {
            const dividend = parseFloat(document.getElementById('dividend').value);

            if (!dividend) {
                alert('ë°°ë‹¹ê¸ˆì„ ì…ë ¥í•˜ì„¸ìš”!');
                return;
            }

            const taxRate = 0.154; // 15.4% (ì†Œë“ì„¸ 14% + ì§€ë°©ì„¸ 1.4%)
            const tax = dividend * taxRate;
            const netDividend = dividend - tax;

            const result = document.getElementById('dividendTaxResult');
            result.innerHTML = `
                <div class="item-card">
                    <h4 style="margin-bottom: 15px;">ë°°ë‹¹ì†Œë“ì„¸ ê³„ì‚° ê²°ê³¼</h4>
                    <div class="item-meta">
                        <span>ë°°ë‹¹ê¸ˆ: <strong>${formatMoney(dividend)}</strong></span>
                        <span>ì„¸ìœ¨: <strong>15.4%</strong></span>
                    </div>
                    <div style="margin: 15px 0; padding: 15px; background: var(--light); border-radius: 8px;">
                        <div style="font-size: 14px; color: var(--gray); margin-bottom: 5px;">ì›ì²œì§•ìˆ˜ ì„¸ì•¡</div>
                        <div style="font-size: 24px; font-weight: bold; color: var(--danger);">
                            ${formatMoney(tax)}
                        </div>
                    </div>
                    <div style="margin: 15px 0; padding: 15px; background: #d1fae5; border-radius: 8px;">
                        <div style="font-size: 14px; color: var(--gray); margin-bottom: 5px;">ì„¸í›„ ìˆ˜ë ¹ì•¡</div>
                        <div style="font-size: 24px; font-weight: bold; color: var(--success);">
                            ${formatMoney(netDividend)}
                        </div>
                    </div>
                </div>
            `;
        }

        function calculateYearlyTax() {
            const summary = document.getElementById('yearlyTaxSummary');
            
            // ê°„ë‹¨í•œ ì˜ˆì‹œ (ì‹¤ì œë¡œëŠ” ë§¤ë§¤ ê¸°ë¡ ê¸°ë°˜ ê³„ì‚°)
            const totalProfit = 10000000;
            const totalLoss = 3000000;
            const netProfit = totalProfit - totalLoss;
            const estimatedTax = netProfit * 0.22;

            summary.innerHTML = `
                <div class="item-card">
                    <h4 style="margin-bottom: 15px;">ì—°ê°„ ì†ìµ ì •ì‚° (${new Date().getFullYear()}ë…„)</h4>
                    <div class="item-meta">
                        <span>ì´ ìˆ˜ìµ: <strong class="price-up">+${formatMoney(totalProfit)}</strong></span>
                        <span>ì´ ì†ì‹¤: <strong class="price-down">-${formatMoney(totalLoss)}</strong></span>
                        <span>ìˆœì†ìµ: <strong>${formatMoney(netProfit)}</strong></span>
                    </div>
                    <div style="margin: 15px 0; padding: 15px; background: #fef3c7; border-radius: 8px;">
                        <div style="font-size: 14px; color: var(--gray); margin-bottom: 5px;">ì˜ˆìƒ ì„¸ê¸ˆ</div>
                        <div style="font-size: 24px; font-weight: bold; color: var(--warning);">
                            ì•½ ${formatMoney(estimatedTax)}
                        </div>
                        <div style="font-size: 12px; color: var(--gray); margin-top: 5px;">
                            * ì‹¤ì œ ì„¸ì•¡ì€ ë³´ìœ  ê¸°ê°„, ê³µì œ í•­ëª© ë“±ì— ë”°ë¼ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                        </div>
                    </div>
                </div>
            `;
        }

        // =================
        // ëŒ€ì‹œë³´ë“œ ì—…ë°ì´íŠ¸
        // =================
        function updateDashboard() {
            // í¬íŠ¸í´ë¦¬ì˜¤ í†µê³„
            let totalValue = 0;
            let totalCost = 0;

            appData.portfolio.forEach(p => {
                totalValue += p.currentPrice * p.quantity;
                totalCost += p.buyPrice * p.quantity;
            });

            const totalProfit = totalValue - totalCost;
            const totalReturn = totalCost > 0 ? ((totalProfit / totalCost) * 100).toFixed(2) : 0;

            document.getElementById('totalAssets').textContent = formatMoney(totalValue);
            document.getElementById('totalReturn').textContent = totalReturn + '%';
            document.getElementById('returnAmount').textContent = (totalProfit >= 0 ? '+' : '') + formatMoney(totalProfit);
            document.getElementById('stockCount').textContent = appData.portfolio.length + 'ê°œ';

            // ì´ë²ˆ ë‹¬ ë§¤ë§¤
            const thisMonth = new Date().getMonth();
            const monthTrades = appData.trades.filter(t => new Date(t.date).getMonth() === thisMonth);
            document.getElementById('monthTrades').textContent = monthTrades.length + 'íšŒ';
        }

        // =================
        // ë¹ ë¥¸ ë©”ëª¨
        // =================
        function saveQuickMemo() {
            const memo = document.getElementById('quickMemo').value.trim();
            if (!memo) {
                alert('ë©”ëª¨ë¥¼ ì…ë ¥í•˜ì„¸ìš”!');
                return;
            }

            appData.memos.push({
                id: Date.now(),
                content: memo,
                date: new Date().toISOString()
            });

            document.getElementById('quickMemo').value = '';
            saveData();
            alert('ë©”ëª¨ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!');
        }

        // =================
        // ë°ì´í„° ê´€ë¦¬
        // =================
        function exportData() {
            const dataStr = JSON.stringify(appData, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `investment-data-${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            URL.revokeObjectURL(url);
        }

        function importData(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const imported = JSON.parse(e.target.result);
                    if (confirm('ê¸°ì¡´ ë°ì´í„°ë¥¼ ëª¨ë‘ ë®ì–´ì“°ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                        appData = imported;
                        saveData();
                        renderAll();
                        alert('ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤!');
                    }
                } catch (error) {
                    alert('íŒŒì¼ í˜•ì‹ì´ ì˜ëª»ë˜ì—ˆìŠµë‹ˆë‹¤!');
                }
            };
            reader.readAsText(file);
        }

        // =================
        // ì „ì²´ ë Œë”ë§
        // =================
        function renderAll() {
            renderPrinciples();
            renderWatchlist();
            renderPortfolio();
            renderTrades();
            renderAnalysis();
            renderGoals();
            updateDashboard();
            updatePerformance();
        }
    </script>
</body>
</html>
